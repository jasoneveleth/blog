+++
title = "Asymptotic Analysis of Dijkstras in Haskell"
date = Date("2023/11/05", "yyyy/mm/dd")
rss = "My analysis of whether it is possible to have optimal* Dijkstras in Haskell"
tags = String[]
+++
~~~
<details class="toc">
<summary>Table of Contents</summary>
~~~
\toc
~~~
</details>
~~~

Imagine you have a map of the US. You want to know the distances from Providence to all the other cities. We can turn that map into a network of cities and distances between them. In math and computer science, we call this a graph (and we refer to the cities as vertices or nodes). Our goal in this post is to using functional programming to find the shortest distances from Providence using Dijkstra's algorithm. It's going to get CS-heavy in the rest of the post so buckle up.

@@im-quarter
![](data:image/png;base64,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RGJxcXFfFRBNyJKqqioNDY2goCAhglYJx7Vr1yAISkxM5FEH0YSMSUtLw2KxGzZskEJf2dnZRCIxLCyMdzVEE7LnzJkzEARt3bpVor08ffpUTU1t6tSp/cZURDQhFxw/fhyNRv/222/9/sKE4/r160QicerUqe3t7f1WRjQhL1y9elVRUXHUqFHl5eVibLarq2vjxo0QBC1evJhPwSGakCM+fPhga2urqqp66NAhscSlgA9RiURiQkIC/99CNCFftLW1bdy4EYfDDR069MqVKwwGQ7h2CgoK5s6di0KhPDw8CgsLBfouogl5pLCwcObMmSgUytraeteuXVVVVXx+saOjIzk5ecqUKSgUysbGJjk5WYjekbNy+aWgoODQoUPJycmNjY329vbjx48fPny4lZWVsbGxqqoq7LTNjsv//v37hw8fPnnypLOzc8KECYsXL54+fToKJcwZJ6IJeaezszMjIyMjI+Phw4cFBQVsv0sMBsMZOsLQ0HD06NHjx4+fMmWKjo6OKD0imviR6O7uLisrq6ioaG5ubm9vx+FwKioq6urqVlZWSkpK4uoF0QRCTxCfGoSeIJpA6AmiCYSe/H94sAK3JnIHewAAAABJRU5ErkJggg==
)
@@

TLDR: Even though Haskell's `Map` and `Set` are $O(\log N)$[^1], I was able still get Dijkstra's in $O((V + E)\log V)$. I used the [PSQueue](https://hackage.haskell.org/package/PSQueue-1.2.0/docs/Data-PSQueue.html#t:Binding) library for my priority queue.

Let's first recall the structure of Dijkstra's algorithm. I've included pseudo code below with asymptotic analysis for each line. The idea is we have a frontier (`Q`) that keeps track of what we think the shortest path is, and we update it as we remove the closest city (and add it's neighbors). Dijkstra's overall runtime is $O((V + E) \log V)$ or $O(V \log V + E)$ using Fibonacci heaps.

We need a visited set so we don't re-explore cities that we've already gone to.

```
dijkstras(s,G)
     Q = Heap()                                          O(1)
     visited = set()                                     O(1)
     weights = map()                                     O(1)

     Q.put(s, 0)
     while !Q.empty                                      O(V)
             n,w = Q.pop_min()                           O(V * log V)
             weights[n] = w                              O(V * 1)
             visited.add(n)                              O(V * 1)
             for (w_m, m) in neighbors of n in G         O(E)
                     if m visited: skip                  O(E * 1)
                     Q.insert_or_decrease(m, w + w_m)    O(E * log V) O(E)
```

So now, the question is, can this be done in the same time complexity, and the answer is yes[^1]. I wrote two haskell functions, `dijkstras` which does the outside loop of taking a vertex off the queue, updating the frontier, the map of weights that we'll return, and the visited set. To update the frontier, we need to loop through all the edges connected to the vertex we just popped off. I made a function specifically for that which checks for containment in the visited set, and will either insert or decrease the priority of the node. Here's the code, with asymptotic analysis on the side. Anything with an exclamation point is asymptotically faster in the imperative version, but the overall runtime turns out to be the same.

```haskell
type Node = String
-- adjacency list
type Graph = Map.Map Node [(Float, Node)]

dijkstras :: Graph -> Node -> Map.Map Node Float
dijkstras graph start = dijkstras_helper Set.empty (PSQ.singleton start 0) Map.empty
  where
    dijkstras_helper visited frontier weights = 
      case PSQ.minView frontier of                         -- O(V)
        Nothing -> weights                                 -- O(V * 1 / V)
        Just (binding, frontier') -> let                   -- O(V * 1)
            node = PSQ.key binding                         -- O(V * 1)
            w = PSQ.prio binding                           -- O(V * 1)
            edges = fromJust $ Map.lookup node graph       -- O(V * log V)!
            visited' = Set.insert node visited             -- O(V * log V)!
            weights' = Map.insert node w weights           -- O(V * log V)!
            frontier'' = foldr (update_keys visited' w) frontier' edges -- O(E * log V)
            in
            dijkstras_helper visited' frontier'' weights'   -- O(V * 1)

-- acts as the inner loop of dijkstras, goes through the adjacent nodes and updates the frontier
update_keys :: Set.Set Node -> Float -> (Float, Node) -> PSQ.PSQ Node Float -> PSQ.PSQ Node Float
update_keys visited w_0 (w, node) acc = 
  if Set.member node visited                               -- O(log V)!
  then acc                                                 -- O(1)
  else 
    case PSQ.lookup node acc of                            -- O(log V)!
      Nothing -> PSQ.insert node (w + w_0) acc             -- O(log V)
      Just p -> PSQ.adjust (\_ -> min p (w + w_0)) node acc-- O(log V)

the_us :: Graph
the_us = Map.fromList [
    ("Prov", [(2.0, "NY"), (1.0, "Boston"), (3.0, "Chester")]), 
    ("NY", [(2.7, "Boston"), (2.0, "Prov"), (5.0, "DC")]), 
    ("Boston", [(1.0, "Prov"), (2.5, "Chester")]),
    ("DC", [(5.0, "NY")]),
    ("Chester", [(3.0, "Prov"), (2.5, "Boston")])
    ]

main :: IO ()
main = do 
    putStrLn "Map of the US:"
    putStrLn $ show $ dijkstras the_us "Prov"
```

[^1]: Here are the docs with asymptotic runtimes: [set](https://hackage.haskell.org/package/containers-0.7/docs/Data-Set.html) and [map](https://hackage.haskell.org/package/containers-0.4.0.0/docs/Data-Map.html)



{{ addcomments }}
