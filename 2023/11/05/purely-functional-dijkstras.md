+++
title = "Asymptotic Analysis of Dijkstras in Haskell"
date = Date("2023/11/05", "yyyy/mm/dd")
rss = "My analysis of whether it is possible to have optimal* Dijkstras in Haskell"
tags = String[]
+++
~~~
<details>
<summary>Table of Contents</summary>
~~~
\toc
~~~
</details>
~~~

Imagine you have a map of the US. You want to know the distances from Providence to all the other cities. We can turn that map into a network of cities and distances between them. In math and computer science, we call this a graph (and we refer to the cities as vertices or nodes). Our goal in this post is to using functional programming to find the shortest distances from Providence using Dijkstra's algorithm. It's going to get CS-heavy in the rest of the post so buckle up.

@@im-half
![](data:image/png;base64,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
)
@@

TLDR: Even though Haskell's `Map` and `Set` are $O(\log N)$[^1], I was able still get Dijkstra's in $O((V + E)\log V)$. I used the [PSQueue](https://hackage.haskell.org/package/PSQueue-1.2.0/docs/Data-PSQueue.html#t:Binding) library for my priority queue.

Let's first recall the structure of Dijkstra's algorithm. I've included pseudo code below with asymptotic analysis for each line. The idea is we have a frontier (`Q`) that keeps track of what we think the shortest path is, and we update it as we remove the closest city (and add it's neighbors). Dijkstra's overall runtime is $O((V + E) \log V)$ or $O(V \log V + E)$ using Fibonacci heaps.

We need a visited set so we don't re-explore cities that we've already gone to.

```
dijkstras(s,G)
     Q = Heap()                                          O(1)
     visited = set()                                     O(1)
     weights = map()                                     O(1)

     Q.put(s, 0)
     while !Q.empty                                      O(V)
             n,w = Q.pop_min()                           O(V * log V)
             weights[n] = w                              O(V * 1)
             visited.add(n)                              O(V * 1)
             for (w_m, m) in neighbors of n in G         O(E)
                     if m visited: skip                  O(E * 1)
                     Q.insert_or_decrease(m, w + w_m)    O(E * log V) O(E)
```

So now, the question is, can this be done in the same time complexity, and the answer is yes[^1]. I wrote two haskell functions, `dijkstras` which does the outside loop of taking a vertex off the queue, updating the frontier, the map of weights that we'll return, and the visited set. To update the frontier, we need to loop through all the edges connected to the vertex we just popped off. I made a function specifically for that which checks for containment in the visited set, and will either insert or decrease the priority of the node. Here's the code, with asymptotic analysis on the side. Anything with an exclamation point is asymptotically faster in the imperative version, but the overall runtime turns out to be the same.

```haskell
type Node = String
-- adjacency list
type Graph = Map.Map Node [(Float, Node)]

dijkstras :: Graph -> Node -> Map.Map Node Float
dijkstras graph start = dijkstras_helper Set.empty (PSQ.singleton start 0) Map.empty
  where
    dijkstras_helper visited frontier weights = 
      case PSQ.minView frontier of                         -- O(V)
        Nothing -> weights                                 -- O(V * 1 / V)
        Just (binding, frontier') -> let                   -- O(V * 1)
            node = PSQ.key binding                         -- O(V * 1)
            w = PSQ.prio binding                           -- O(V * 1)
            edges = fromJust $ Map.lookup node graph       -- O(V * log V)!
            visited' = Set.insert node visited             -- O(V * log V)!
            weights' = Map.insert node w weights           -- O(V * log V)!
            frontier'' = foldr (update_keys visited' w) frontier' edges -- O(E * log V)
            in
            dijkstras_helper visited' frontier'' weights'   -- O(V * 1)

-- acts as the inner loop of dijkstras, goes through the adjacent nodes and updates the frontier
update_keys :: Set.Set Node -> Float -> (Float, Node) -> PSQ.PSQ Node Float -> PSQ.PSQ Node Float
update_keys visited w_0 (w, node) acc = 
  if Set.member node visited                               -- O(log V)!
  then acc                                                 -- O(1)
  else 
    case PSQ.lookup node acc of                            -- O(log V)!
      Nothing -> PSQ.insert node (w + w_0) acc             -- O(log V)
      Just p -> PSQ.adjust (\_ -> min p (w + w_0)) node acc-- O(log V)

the_us :: Graph
the_us = Map.fromList [
    ("Prov", [(2.0, "NY"), (1.0, "Boston"), (3.0, "Chester")]), 
    ("NY", [(2.7, "Boston"), (2.0, "Prov"), (5.0, "DC")]), 
    ("Boston", [(1.0, "Prov"), (2.5, "Chester")]),
    ("DC", [(5.0, "NY")]),
    ("Chester", [(3.0, "Prov"), (2.5, "Boston")])
    ]

main :: IO ()
main = do 
    putStrLn "Map of the US:"
    putStrLn $ show $ dijkstras the_us "Prov"
```

[^1]: Here are the docs with asymptotic runtimes: [set](https://hackage.haskell.org/package/containers-0.7/docs/Data-Set.html) and [map](https://hackage.haskell.org/package/containers-0.4.0.0/docs/Data-Map.html)



{{ addcomments }}
