+++
title = "A Rigorous (and Not-So-Rigorous) Look at JAX's Autograd"
date = Date("2024/01/05", "yyyy/mm/dd")
rss = "My attempt to understand how JAX does autograd."
tags = String[]
+++
~~~
<details>
<summary>Table of Contents</summary>
~~~
\toc
~~~
</details>
~~~

# What this post is about

Warning: this is my understanding, I've only just starting learning differential geometry, so if I've made a mistake, please leave a comment.

I've started writing this post from scratch several times as I've tried to get the presentation just right. I settled on this two goals: (1) if you have heard the terms "[vector space](/404)" and "gradient" thrown about before, you should be able to understand and write JAX primitives, and (2) if you're comfortable with vector spaces, dual spaces, and multivariable calculus, I will assuage your fears about rigor.

We'll cover `JAX` flavored reverse-mode autograd, and focus on the 'grad' part of that: you should see [Related work](/2024/01/05/autograd/#related_work) for the 'auto' part, basically you wrap every `ndarray` in a custom class that keeps track of how it was made.
# Related work

There is a lot of prior art in this area. These are the things I found helpful. One of the main contributors behind JAX made [a video](https://videolectures.net/deeplearning2017_johnson_automatic_differentiation/) about their framework, and [here](/404) are my notes on it. I also found another [autodiff blog post](https://thenumb.at/Autodiff/), and my [notes](/404). The most directly relevant stuff is probably the [autodiff cookbook](https://jax.readthedocs.io/en/latest/notebooks/autodiff_cookbook.html#jacobian-vector-products-jvps-aka-forward-mode-autodiff) for JAX, specifically the section I linked to, and [what you need to do](https://jax.readthedocs.io/en/latest/notebooks/How_JAX_primitives_work.html) to implement a primitive. Finally, I also found [a paper from 2008](https://engineering.purdue.edu/~qobi/papers/toplas2008.pdf) and a core JAX contributor's [phd thesis](https://dougalmaclaurin.com/phd-thesis.pdf)  (pages 48-52 and 13-19 are relevant).

# How does it work (examples plz)

First, let's look at a $$
\begin{align*}
&f(\bm{x}) := {\color{red}  \lvert\lvert} {\color{green}\arctan(}{\color{blue} W\bm{x} + \bm{b} }{\color{green})} - {\color{purple}\bm{y} } {\color{red} \rvert\rvert ^{2} }\\
&\text{ {\color{blue}single-layer} neural net with {\color{green}arctan activation} and {\color{red}MSE} loss w.r.t. {\color{purple}labels} }
\end{align*}
$$ 
If all the computation (evaluation and gradient accumulation) happened sequentially, it would look like the following. Note: in `numpy`, the `.T` property takes the transpose of a 2D array. Don't worry about the `Jt_f(x, gt)` functions, they will be explained.

```python
a = W @ x
b = a + bias # I've replaced `b` from f(x) with `bias`
c = np.arctan(b)
d = c - y
e = d**2
loss = np.sum(e)
# begin backward mode
gt = 1.0
e_gt = Jt_sum(loss, g_t)    # gt * np.ones((1, loss.shape[0]))
d_gt = Jt_square(d, e_gt)   # e_gt * (2 * d.reshape(1,-1))
c_gt = Jt_subtract_const(c, d_gt) # d_gt
b_gt = Jt_arctan(b, c_gt)   # c_gt * (1/(1 + b**2)).reshape(1, -1)
a_gt = Jt_add_const(a, b_gt)# b_gt
delta_xt = Jt_matmul(x, a_g)# a_gt @ W
delta_x = delta_xt.T
```

We see that in backward-mode we are using the values from the original computation. I've put comments for the definitions of the `Jt` functions. At the end of the computation, we get a `delta_x`: the gradient of $f$ with respect to the input `x`.  
# What are those `Jt_f(x, gt)` functions?

I'm borrowing the transpose vector Jacobian product (`Jt`) from [JAX documentation](https://jax.readthedocs.io/en/latest/notebooks/autodiff_cookbook.html#jacobian-vector-products-jvps-aka-forward-mode-autodiff). I keep the notation so it's familiar when you interact with JAX documentation. **The next few paragraphs are meant to click later in the post; please don't give up just because it doesn't quite make sense now.**

In `Jt_f(x, gt)`, the $\bm{x}$ tells us where in the input space of some $f$ we are, and, morally[^1] , $\bm{g}^{\intercal}$  is a direction in the output space of that $f$. `Jt_func` turns that direction in the output space, to a direction of the gradient in the input space. Here's a picture:

@@im-800
![](data:image/png;base64,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
)
@@

[1]:  morally in [this](https://eugeniacheng.com/wp-content/uploads/2017/02/cheng-morality.pdf) sense

You can see the direction $\bm{g}^{\intercal}$ in the output being transformed into the input space. This is how we propagate the gradient through `func`. If you have the gradient of $f$ at $\bm{x}$, you can compute $$
\texttt{Jt\_func}(\bm{x}, \bm{g}^{\intercal}) = \bm{g}^{\intercal} \left(\left.\frac{d}{d \bm{y} }f(\bm{y})\right|_{\bm{y}=\bm{x}}\right)
$$ Where $\left.\frac{d}{d\bm{y} }f(\bm{y})\right|_{\bm{y}=\bm{x}}$ is the Jacobian matrix of $f$ at $\bm{x}$. [Leibniz's notation](https://en.wikipedia.org/wiki/Leibniz%27s_notation) is insane, so we're going to adopt the notation from [Spivak](http://www.strangebeautiful.com/other-texts/spivak-calc-manifolds.pdf), and [other](http://ceres-solver.org/spivak_notation.html) [people](http://www.vendian.org/mncharity/dir3/dxdoc/) [agree](https://mitpress.mit.edu/9780262019347/functional-differential-geometry/). Thus, let $Df(\bm{x}) = \left.\frac{d}{d\bm{y} }f(\bm{y})\right|_{\bm{y}=\bm{x}}$ be the Jacobian matrix. Let's rewrite the equation: $$
\texttt{Jt\_func}(\bm{x}, \bm{g}^{\intercal}) = \bm{g}^{\intercal}Df(\bm{x}).
$$
Much better. Now, why does composing `Jt_func` work? We'll hold off on that for a bit, but jump to [the section that covers it](/2024/01/05/autograd/#what_is_going_on). If you're confused right now, that's entirely fair. We'll go through many examples, and then I'll explain the underlying theory. I've just said this stuff so it will click later on.

The way we figure out what these `Jt` functions should be is just evaluate $\bm{g}^{\intercal}Df(\bm{x})$ (which you should think about as taking direction $\bm{g}^{\intercal}$ from output to input) for a given $f$. Let's start with the functions I introduced in the simple neural net at the beginning of this article. 

## `Jt_subtract_const`

We will start with `subtract_const`. $f(\bm{x}) := \bm{x} - \bm{b}$ with $\bm{b}$ a constant. We can calculate the derivative by plucking it out of the taylor series: $$
f(\bm{x}+ \Delta \bm{x}) = f(\bm{x}) + Df(\bm{x})\Delta \bm{x} + O(\Delta \bm{x}^2).
$$ We collect terms, and the coefficient of the first-order term is the derivative. We can do this for our function $f$ : $$
\begin{align*}
f(\bm{x}+\Delta \bm{x}) &= (\bm{x} + \Delta \bm{x}) - \bm{b}\\
&= \bm{x} - \bm{b} + \Delta \bm{x} \\
&= f(\bm{x}) + I\Delta \bm{x} \\
\end{align*}
$$
Thus, $Df(\bm{x}) = I$ the identity matrix. So, If we want to calculate `Jt_subtract_const` we need to figure out what $\bm{g}^{\intercal}I$ is, which is simply $\bm{g}^{\intercal}$. Thus,
```python
def Jt_subtract_const(x, gt):
	"""x: ndarray shape(n,)
	   gt: ndarray shape(1,n)"""
	return gt
```

Let's do a harder one.

## `Jt_square`

Now $f(\bm{x}) := \bm{x}^{2}$ element-wise. Remember, to find the derivative, we take $$
\begin{align*}
f(\bm{x} + \Delta\bm{x})&=(\bm{x} + \Delta\bm{x})^{2}\\
&=\bm{x}^{2}+2\bm{x} \odot \Delta\bm{x} + (\Delta\bm{x})^{2}\\
&=f(\bm{x})+2\bm{x} \odot\Delta\bm{x} + O((\Delta\bm{x})^{2}).\\
\end{align*}
$$ With $\odot$ as element-wise product. Thus, $$
Df(\bm{x}) =
\begin{bmatrix}
2x_{1}& 0 & \dots& 0 \\
0& \ddots & & \\
& & \ddots & 0\\
& & 0& 2x_{n}\\
\end{bmatrix}
$$ 
Multiplying this with $\bm{g}^{\intercal}$ gives $[2x_{1}g_{1} \dots 2x_{n}g_{n}]$.
So,
```python
def Jt_square(x, gt):
	"""x: ndarray shape(n,)
	   gt: ndarray shape(1,n)"""
	return gt * (2 * x.reshape(1, -1))
```

## `Jt_arctan`

Now $f(\bm{x}) := \arctan(\bm{x})$ element-wise. Now we're going to exploit the fact that the Jacobian is a matrix of partials. Since it's element-wise, we're dealing with a diagonal matrix. This gives us $$
Df(\bm{x}) = \begin{bmatrix}
1 /(1 + x_{1}^{2})& 0 & \dots& 0 \\
0& \ddots & & \\
& & \ddots & 0\\
& & 0& 1 / (1 + x_{n}^{2})\\
\end{bmatrix}
$$  So it makes sense that 
```python
def Jt_arctan(x, gt):
	"""x: ndarray shape(n,)
	   gt: ndarray shape(1,n)"""
	return gt * (1/(1 + x**2)).reshape(1, -1)
```
# What is going on

You might be thinking: I'm familiar with multivariable calculus, I love a good dual space, but what is going on here? To answer that, we'll look again at what a derivative really is. Given a function $f:V\to W$ between vector spaces, the derivative is *the* linear map that takes incremental inputs of $f$ and outputs incremental changes in the value of $f$. That is, $Df: V \to (V \to W)$, and $Df(\bm{x}): V\to W$. It has a nice property that $$
f(\bm{x}) + Df(\bm{x})(\bm{h})\approx f(\bm{x}+\bm{h}).
$$We're using slightly different notation since we're treating $Df(\bm{x})$ as a function, it will turn out that it's okay to treat it as multiplication. With our new understanding that the derivative is a linear map (and it just happens to be a matrix). Let's look again at this figure

@@im-800
![](data:image/png;base64,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
)
@@

There are several things to notice. First, I've drawn the dashed axes to represent the domain and codomain of $Df(\bm{x})$. Now, since we're doing reverse mode, we need to go the other direction: take incremental changes in output and turn them into incremental changes to input. Luckily, we can take the transpose of a linear map: $$
\begin{align*}
Df(\bm{x})^{\intercal}:W^*\to V^*\\
Df(\bm{x})^{\intercal}(\bm{g})=\bm{g}\circ Df(\bm{x})
\end{align*}
$$
Where $\bm{g}\in W^*$. We're now dealing with the dual space. Elements are often referred to as covectors. They are a linear map from their "normal" space to the underlying field. Thus, $\bm{g}:W\to \mathbb{R}$. This means the types the expression make sense: $\bm{g}\circ Df(\bm{x}):V\to \mathbb{R}$, or $\bm{g}\circ Df(\bm{x}):V^*$ . Often people think of the dual space as linear functions that are "taking the inner product with a vector". So $$
\bm{g}(\bm{x}) = \langle \bm{g},\bm{x} \rangle.
$$  This is especially useful because we can then represent $\bm{g}$ as a row vector, which, when combined with a column vector from the nondual space, gives the inner product. This is the reason I've been so careful with keeping the `gt` of shape `(1,n)` because these $\bm{g}$s are members of the dual space and are actually row vectors. From now on, I'll use $\bm{g}^{\intercal}$ as a reminder that it's a row vector. 

Just to check that using the covectors as row vectors will work, let's examine our vector-Jacobian product $$
(\bm{g}\circ Df(\bm{x}))(\bm{v})=(\bm{g}^{\intercal} Df(\bm{x}))\bm{v}=\bm{g}^{\intercal} Df(\bm{x})\bm{v}
$$

Thus, with our newfound correspondence, let's evaluate the vector-Jacobian product (and employ chain rule). Let $f = C \circ B \circ A$, then $$
\begin{align*}
Df(\bm{x})^{\intercal}(\bm{g})&=\bm{g}^{\intercal} Df(\bm{x})\\
&=\bm{g}^{\intercal} \,((DC \circ B \circ A)(\bm{x})\,\,(DB \circ A)(\bm{x})\,  DA(\bm{x}))\\
&=\bm{g}^{\intercal}\, DC((B \circ A)(\bm{x}))\,DB (A(\bm{x})) \, DA(\bm{x})\\
\end{align*}
$$
Recall our definition from earlier: $$
\texttt{Jt\_f}(\bm{x}, \bm{g}^{\intercal}) = \bm{g}^{\intercal}Df(\bm{x}).
$$
Then $$
\begin{align*}
&=\bm{g}^{\intercal} DC((B \circ A)(\bm{x}))\,\,DB (A(\bm{x}))\,  DA(\bm{x})\\
&=\texttt{Jt\_C}((B\circ A)(\bm{x}), \bm{g}^{\intercal})\,DB (A(\bm{x}))\,  DA(\bm{x})\\
\end{align*}
$$
What we should notice here is that $\texttt{Jt\_C}((B\circ A)(\bm{x}), \bm{g}^{\intercal}) = \bm{g}^{\intercal}DC((B\circ A)(\bm{x}))$ is an element of the dual space of the output of $B$. Thus, we can apply this strategy again, where we incorporate an element into a call to a `Jt` function: 
$$
\begin{align*}
&=\texttt{Jt\_C}((B\circ A)(\bm{x}), \bm{g}^{\intercal})\,DB (A(\bm{x}))\,  DA(\bm{x})\\
&= \texttt{Jt\_B}(A(\bm{x}),\,\, \texttt{Jt\_C}((B\circ A)(\bm{x}), \bm{g}^{\intercal})) \,\,  DA(\bm{x})\\
&= \texttt{Jt\_A}(\bm{x},\,\, \texttt{Jt\_B}(A(\bm{x}), \texttt{Jt\_C}((B\circ A)(\bm{x}), \bm{g}^{\intercal})))\\
\end{align*}
$$ 
This is very busy notation, so to look at it better, let $\bm{a}=A(\bm{x}), \bm{b}=B(A(\bm{x}))$ then the final expression becomes $$
\texttt{Jt\_A}(\bm{x},\, \texttt{Jt\_B}(\bm{a},\, \texttt{Jt\_C}(\bm{b},\, \bm{g}^{\intercal}))).
$$
This should hopefully justify the program I provided at the beginning of the post. Just by knowing the `Jt` functions of the primitives, we end up with the ability to convert $\bm{g}^{\intercal}$ into a covector of the input space of $f$. Now let's reflect on what this means. If we choose $\bm{g}^{\intercal}=\begin{bmatrix} 1 & 0& \dots&0 \end{bmatrix}$. Then we get back a row of the derivative: $$
\bm{g}^{\intercal}Df(\bm{x})=\begin{bmatrix} 1 & 0& \dots&0 \end{bmatrix}\, Df(\bm{x})=\begin{bmatrix} \partial_{1}f(\bm{x}) & \partial_{2}f(\bm{x})& \dots&\partial_{n}f(\bm{x}) \end{bmatrix}
$$
(borrowing notation from [Sussman](https://mitpress.mit.edu/9780262019347/functional-differential-geometry/), $\partial_{1}f$ is the partial derivative with respect to the first argument).

This is great because almost all loss functions in ML are scalar, so the Jacobian just has one row, and thus, we can efficiently compute the gradient for our descent.

You may be thinking, hold on a minute, the gradient is actually a linear form (in the case of a scalar loss function): we can't add that to $\bm{x}$, and you're right. We should think of the gradient as something that can turn small changes of $\bm{x}$ into small changes in $f(\bm{x})$. When we're doing gradient descent, we want a small change in $\bm{x}$ that will maximally decrease $f(\bm{x})$ for a given step size. The small change in $\bm{x}$ that will cause the most increase is in fact the transpose of the gradient (this makes sense since the dot product is maximal when the vectors are parallel). So, it is okay to use the gradient for gradient descent after all.

It is important to note that the components of the Jacobian really depend on the basis of the vector spaces of the domain and codomain.

# Wrapping up



{{ addcomments }}
