<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Otter emoji icon!!! -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü¶¶</text></svg>">

  <!-- Open Graph https://ogp.me/ -->
  <meta property="og:title" content="A Rigorous (and Not-So-Rigorous) Look at JAX's Autograd" />
  <meta property="og:type" content="article" />
  <meta property="og:image" content="https://www.jasoneveleth.com/blog/assets/otter.png" />
  <meta property="og:image:width" content="160" />
  <meta property="og:image:height" content="160" />
  <meta property="og:article:author" content="Jason Eveleth">
  <meta property="og:article:published_time" content="2024-01-05">

   <link rel="stylesheet" href="/blog/libs/katex/katex.min.css">
   
   <link rel="stylesheet" href="/blog/libs/highlight/styles/github.min.css">
   

  <!-- not used -->
  

  <link href="/blog/css/franklin.css" rel="stylesheet">
  <link href="/blog/css/global.css" rel="stylesheet">

  <title>A Rigorous (and Not-So-Rigorous) Look at JAX's Autograd</title>
</head>
<body>
<nav class="flex-container blog-nav">
  <!-- type-a have a fixed width which never changes -->
  <!-- type-b will grow up to a point -->
  <!-- type-c start at 0 and absorb remaining space-->
  <!-- https://jsfiddle.net/dehsq3jb/ -->
  <div class="type-c"></div>
  <div class="type-b link-spacer"></div>
  <div class="type-a logo"><a href="https://www.jasoneveleth.com">Jason's</a> <a href="https://www.jasoneveleth.com/blog">Blog</a></div>

  <div class="type-b content-spacer"></div>

  <div class="type-a nav-link"><a href="/blog/search">Search</a></div>
  <div class="type-b link-spacer"></div>
  <div class="type-c"></div>
</nav>

<main id="panel">

<h1 class="post-title">A Rigorous (and Not-So-Rigorous) Look at JAX's Autograd</h1>
<!-- <hr> -->
<!-- Content appended here -->
<div class="franklin-content"><p> 
<details class="toc">
<summary>Table of Contents</summary>
 <div class="franklin-toc"><ol><li><a href="#what_this_post_is_about">What this post is about</a></li><li><a href="#resources">Resources</a></li><li><a href="#how_does_autodiff_work_using_an_example">How does autodiff work? &#40;using an example&#41;</a></li><li><a href="#what_are_those_jt_fx_gt_functions">What are those <code>Jt_f&#40;x, gt&#41;</code> functions?</a><ol><li><a href="#implementing_jt_subtract_const">Implementing <code>Jt_subtract_const</code></a></li><li><a href="#implementing_jt_square">Implementing <code>Jt_square</code></a></li><li><a href="#implementing_jt_arctan">Implementing <code>Jt_arctan</code></a></li></ol></li><li><a href="#what_is_going_on_bringing_back_rigor">What is going on &#40;bringing back rigor&#41;</a></li><li><a href="#wrapping_up">Wrapping up</a></li></ol></div> 
</details>
</p>
<h1 id="what_this_post_is_about"><a href="#what_this_post_is_about" class="header-anchor">What this post is about</a></h1>
<p>I&#39;ve started writing this post from scratch several times as I&#39;ve tried to get the presentation just right. I settled on this two goals: &#40;1&#41; if you have heard the terms &quot;<a href="/blog/404">vector space</a>&quot; and &quot;gradient&quot; thrown about before, you should be able to understand and write JAX primitives, and &#40;2&#41; if you&#39;re comfortable with vector spaces, dual spaces, and multivariable calculus, I will assuage any fears about rigor.</p>
<p><a href="https://jax.readthedocs.io/en/latest/">JAX</a> is a high-performance numerical computing framework for Python that can wrap a normal python function to calculate the derivative. We&#39;ll cover JAX-flavored reverse-mode automatic differentiation &#40;autodiff&#41;, and focus on the &#39;differentiation&#39; part. The &#39;automatic&#39; part basically works by wrapping every <code>ndarray</code> in a custom class that keeps track of computation. That is out of the scope of this post, but you should check out the <a href="/blog/2024/01/05/autograd/#resources">Resources</a> section for more information &#40;or my <a href="https://github.com/jasoneveleth/autograd">110-line python implementation</a>&#41;.</p>
<div class="warning"><div class="title">‚ö† Warning&#33;</div>
<div class="content">This post is my understanding; I&#39;ve only just started learning differential geometry, so if I&#39;ve made a mistake, <em>please leave a comment</em>.</div></div>
<h1 id="resources"><a href="#resources" class="header-anchor">Resources</a></h1>
<p>I found plenty high-quality resources on autodiff. The first post I read was <a href="https://thenumb.at/Autodiff/">this one</a>, and I wrote down my takeaways <a href="/blog/404">here</a>. <a href="https://jingnanshi.com/blog/autodiff.html">This post</a> is also excellent. However, they cover mostly how to directly apply the chain rule. In contrast, the JAX-flavored way of doing things involved &quot;Jacobian-vector products&quot;, and other foreign terms. I really liked the JAX approach of only providing a <code>grad</code> function that can wrap any function you like, and it seemed to have a structured approach to applying the chain rule.</p>
<p>In my efforts, I stumbled upon many resources specifically related to JAX. One of the main contributors behind JAX made <a href="https://videolectures.net/deeplearning2017_johnson_automatic_differentiation/">a video</a> about their framework &#40;my notes on it are <a href="/blog/404">here</a>&#41;.  However, the most directly relevant information is the <a href="https://jax.readthedocs.io/en/latest/notebooks/autodiff_cookbook.html#jacobian-vector-products-jvps-aka-forward-mode-autodiff">autodiff cookbook</a> for JAX &#40;specifically the section I linked to&#41; and <a href="https://jax.readthedocs.io/en/latest/notebooks/How_JAX_primitives_work.html">documentation</a> on what you need to do to implement a primitive. Their approach is grounded in the literature, specifically <a href="https://engineering.purdue.edu/~qobi/papers/toplas2008.pdf">this paper from 2008</a>. And finally, I found a core JAX contributor&#39;s <a href="https://dougalmaclaurin.com/phd-thesis.pdf">phd thesis</a> on the implementation of a precursor library &#40;pages 13-19 and 48-52 are relevant&#41;.</p>
<h1 id="how_does_autodiff_work_using_an_example"><a href="#how_does_autodiff_work_using_an_example" class="header-anchor">How does autodiff work? &#40;using an example&#41;</a></h1>
<p>First, let&#39;s look at a simple neural net as a function of its input. I&#39;ve colored each part of the function to correspond to its description. </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><mstyle mathcolor="red"><mo stretchy="false">‚à£</mo><mo stretchy="false">‚à£</mo></mstyle><mstyle mathcolor="green"><mi>arctan</mi><mo>‚Å°</mo><mo stretchy="false">(</mo></mstyle><mstyle mathcolor="blue"><mi>W</mi><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi mathvariant="bold-italic">b</mi></mstyle><mstyle mathcolor="green"><mo stretchy="false">)</mo></mstyle><mo>‚àí</mo><mstyle mathcolor="purple"><mi mathvariant="bold-italic">y</mi></mstyle><mstyle mathcolor="red"><mo stretchy="false">‚à£</mo><msup><mo stretchy="false">‚à£</mo><mn>2</mn></msup></mstyle></mrow><annotation encoding="application/x-tex">
f(\bm{x}) := {\color{red}  \lvert\lvert} {\color{green}\arctan(}{\color{blue} W\bm{x} + \bm{b} }{\color{green})} - {\color{purple}\bm{y} } {\color{red} \rvert\rvert ^{2} }
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mopen" style="color:red;">‚à£‚à£</span></span><span class="mord"><span class="mop" style="color:green;"><span style="color:green;">a</span><span style="color:green;">r</span><span style="color:green;">c</span><span style="color:green;">t</span><span style="color:green;">a</span><span style="color:green;">n</span></span><span class="mopen" style="color:green;">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;color:blue;">W</span><span class="mord" style="color:blue;"><span class="mord" style="color:blue;"><span class="mord boldsymbol" style="color:blue;">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:blue;">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord" style="color:blue;"><span class="mord" style="color:blue;"><span class="mord boldsymbol" style="color:blue;">b</span></span></span></span><span class="mord"><span class="mclose" style="color:green;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord" style="color:purple;"><span class="mord" style="color:purple;"><span class="mord boldsymbol" style="margin-right:0.03704em;color:purple;">y</span></span></span></span><span class="mord"><span class="mclose" style="color:red;">‚à£</span><span class="mclose" style="color:red;"><span class="mclose" style="color:red;">‚à£</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mtight" style="color:red;"><span class="mord mtight" style="color:red;">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span>
<p>This is a 
<span style="color: blue";">single-layer</span>
<span style="">neural net with</span>
<span style="color:green">arctan activation</span>
<span style="color:">and</span>
<span style="color:red">MSE</span>
<span style="">loss w.r.t.</span>
<span style="color:purple">labels</span>
 . This is pretty standard &#40;aside from the maybe uncommon choice of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>arctan</mi><mo>‚Å°</mo></mrow><annotation encoding="application/x-tex">\arctan</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mop">arctan</span></span></span></span>&#41;. Notice that usually, you&#39;d want to take the derivative with respect to the weights &#40;so <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span> or <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>&#41;, but I&#39;m keeping this example simpler. This way, we don&#39;t need to deal with multiple dimensions.</p>
<p>If all the computations for the autodiff of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>  &#40;evaluation and gradient accumulation&#41; happened sequentially, it would look like the following. We will execute each operation of the neural net individually so that we can use these intermediate computations in our backward pass. Note: in <code>numpy</code>, the <code>.T</code> property takes the transpose of a 2D array. Don&#39;t worry about the <code>Jt_f&#40;x, gt&#41;</code> functions, they will be explained.</p>
<pre><code class="python hljs">a = W @ x
b = a + bias <span class="hljs-comment"># I&#x27;ve replaced `b` from f(x) with `bias`</span>
c = np.arctan(b)
d = c - y
e = d**<span class="hljs-number">2</span>
loss = np.<span class="hljs-built_in">sum</span>(e)
<span class="hljs-comment"># begin backward mode</span>
gt = <span class="hljs-number">1.0</span>
e_gt = Jt_sum(loss, g_t)    <span class="hljs-comment"># gt * np.ones((1, loss.shape[0]))</span>
d_gt = Jt_square(d, e_gt)   <span class="hljs-comment"># e_gt * (2 * d.reshape(1,-1))</span>
c_gt = Jt_subtract_const(c, d_gt) <span class="hljs-comment"># d_gt</span>
b_gt = Jt_arctan(b, c_gt)   <span class="hljs-comment"># c_gt * (1/(1 + b**2)).reshape(1, -1)</span>
a_gt = Jt_add_const(a, b_gt)<span class="hljs-comment"># b_gt</span>
delta_xt = Jt_matmul(x, a_g)<span class="hljs-comment"># a_gt @ W</span>
delta_x = delta_xt.T</code></pre>
<p>There are several things to take away from this code snippet. We see that in backward-mode we are using the values from the original computation &#40;<code>a</code>, <code>b</code>, <code>c</code>, etc.&#41;. I&#39;ve put comments to inline the definitions of the <code>Jt</code> functions. And, at the end of the computation, we get a <code>delta_x</code>: the gradient of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> with respect to the input <code>x</code>.  </p>
<h1 id="what_are_those_jt_fx_gt_functions"><a href="#what_are_those_jt_fx_gt_functions" class="header-anchor">What are those <code>Jt_f&#40;x, gt&#41;</code> functions?</a></h1>
<p>I&#39;m borrowing the transpose vector Jacobian product &#40;<code>Jt</code>&#41; from <a href="https://jax.readthedocs.io/en/latest/notebooks/autodiff_cookbook.html#jacobian-vector-products-jvps-aka-forward-mode-autodiff">JAX documentation</a>. I keep the notation the same so if you read the JAX documentation, their notation will be familiar. <strong>The next few paragraphs are meant to click later in the post; please don&#39;t give up just because it doesn&#39;t quite make sense now.</strong></p>
<p>In <code>Jt_f&#40;x, gt&#41;</code>, the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">x</mi></mrow><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span> tells us where in the input space of some <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>:</mo><msup><mi mathvariant="double-struck">R</mi><mi>n</mi></msup><mo>‚Üí</mo><msup><mi mathvariant="double-struck">R</mi><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">f:\mathbb{R}^{n}\to \mathbb{R}^{m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚Üí</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span></span> we are, and, morally<sup id="fnref:1"><a href="#fndef:1" class="fnref">[1]</a></sup> , <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span></span></span></span>  is a direction in the output space of that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>. <code>Jt_func</code> turns that direction in the output space, to a direction of the gradient in the input space. Here&#39;s a picture:</p>
<div class="im-800"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAByYAAALuCAQAAABBK7lWAABKxUlEQVR42u39v29qXfwvdr7XvU81UqTs7y3SjDRXnCmmSXGH8yfgpJ2G8yfgNlWwlHYKXN0aunQju08DdSpzI6XNmMkUIyVFDikjRaOVAox/gc32Lwx&#43;vbb0HH5sNgvsx5s3a63PKjUAAADQzr86dAMAAAA4PsIkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkzCN1eaMi29L3qucRkc&#43;vUCAHAc/jl0A&#43;BjlCbdJMm8Lje3NHVx6HZ9wOuaZlJnX/R0F5mW1MmhXzUAAN&#43;fMPnjlNHWm2dfFlc&#43;4zX1Mkwv8yyT9Mosl3WWZJhuzg7dtne&#43;sibTzO/CXemm/&#43;Lu88zfF5/rsvzJjTgJAMDrhMmfp7v&#43;b7O&#43;vopgR9yDVwYZ5zq/7mJUGWRcrjPJMEcckNfGST1/cL2b1c/u7pX1cvcTXA&#43;ELfNMtkXBMkjn7iuD0kk/TZa5fh4966L8ybTM6/zQLx0AgO&#43;t1EO3gIMoTf4mSS7rxaHb8s5XMsg4k0eBa9Wf10mTWT3qnskyzChnT/uMSy/T/K7zpHRzkz/1ev2aRxnkMk36WeT8cRgsoyyzzDiX9aKM0sl1lumnn7NtobFcpZvfd8OFAQBgG2Hyx1r/6L9ZmCyjpE2LSpPbJL&#43;eBp/S5PbYw2RpcpvrxzF5fU9dRczSy7SWB7dfpalnpZNxug9jYulkXM&#43;SUrPM9d2w2dLJba7rny3H7&#43;T2u/1mAADw3ajmynEbpMn18z60uszxR6Fhmly2esR1eqVTF/Us84wf3D7IdVI6SZosHw2CbbYdpi4yybB0Dv0GAADwnQmTfC/dlvv3kmwdjlknOephmqXJILN25XTqdZJVBDxPtzx8L2dZvVeLB/2NL73XkyTDQ78HAAB8Z8Ik30hp0nY9xZcC0XGX3xmkyfUbHtdJkrrI4r7ya72oi6zeq4e9kt0kO8rs1HkW6ZcmAACwgzDJd9Jv/YjlC4867nqk/eTtYTLb6vP28jhgv/wM12ne8PMAAODHECb5NkqTUesHzZN0ynDHfUc70LV00s38TfVU7x7zZMZjadLJ8kFRnm46WbywAMjdwFgA4KiVpkzLgc7pZVwGh379fCbrTLJROlmVaOlu1iPsp5tk8XTu3tM9Sye9dJK7xz3Ys1kPRO1lcV/4Zf0HrZPO/Qy&#43;0sso7YdVztJPMiqpz0rV1Nl9P9z&#43;Ld48opu7Vz/fVuLnwZEH6aTJMvNt6zaWQTrrAaU7n2uLft46THe&#43;bn3nSa/j037JQdaDXstVLreEynmESYAfZX2uTBbtZuyfis1nls2XuaVJc/zvRWkyzaTFZ5CPdZFpybYVsDkNwiT3xg/Cw6z0M8wss3QzzLg8Xiji9v5iWWScJrMkTaZlkctHfzCuNsec3c3XK6MHpV0ukqR0c7XpSRtu&#43;hn3WdjjOsN0kozKINeZZ77jj/7&#43;LU5SmozT5DrXWaSXUUblsm6pq1qajNPPLKtiP71My/XD96n0M0pymUma9DMts/zZs7dxFWNbKr3Vo0qTceZPAmIvjwf&#43;rge5lk462/on67Is0indetyDhQHYQ&#43;lkkH6azDNPN92SXOfy&#43;GNUi3egl2F66zFNvTLLZZ0lGaabI15kLFlHybtFwbqvTGDZ/Tlq9eX4XWdDJ/00Wd59if70&#43;kN1Wf7kRpw8YdX2Q7f1P6NHtzUZrm7NIOM061s7&#43;ZuawZM9R6mpucpt&#43;ptbu/mbmvHWY04f3drLbWrqljaNWr6O7pMbbjPO4K7tb2lxTa4e3pImN8/32Tz2wfuSTv7etz&#43;D1Nzct&#43;Tp9Rdf1W1qei/87Hrrd/HRO5hppjXp5SZ/091yxAe35e/qsZnuep5Mn/7UbTabzXZ62/r8ePvofNZfnfn2O2cd/5ZBaq7SeXD9NqN08uTTyzFuucrN5nI300zzNzXT9VZTc7O5tLq25dyfUYYZpGZUk1Gu0k8v49WnjYwy3Vzf&#43;pkivdSnn0tsp7IdvAG2A//oR1tvHz2Jflep93&#43;Knhzh0R&#43;HdbQbb9nzyZ/jVbTb9tytX0kvf5/d&#43;Pc&#43;MLZt8fqW6aNnqHkS7tLk9snjOqsLjx7z&#43;Lmm&#43;76&#43;1NTdp/A8CZNp0ssgt6m5yW1qpvcnxAePuX10fZCaUa52x8WM3vLTsNlsNtsxbenuio0Zp&#43;b2J0SADPL8k0uTm1XoOnTr3vnahnn25fR9tEs39e7zUpqMUzPKOH9z8&#43;TzS2f1PqTmb8Z3nxzSSc3Vg&#43;vN7vcrV7n9KV9N/LTt4A2wHfhHP9px&#43;&#43;PgtCX47Yp&#43;GW95fM0nhsn1t6q3z25&#43;FpP2a/E6Bj7u83ve47p61IPQ9vhxq1D35JkGqfn7&#43;h/TVSx98WfXe/iMD7ZpRttP/Ok&#43;fd500nupLRml5urQv6c2m81m&#43;7xtPcZmx9/6jFOfj3Rp/Ryjr/1isu3zpcnfbefmNMcfJtPk7/ORVS&#43;McLrKdBUdH//cM8pg86X5/Qisp9eb1Pzd0ZJOfEF9optqrmyzfMc07dXcwvZ1Wd&#43;hLutF/ZVfOc/kwUzD8Z6Vy562eJFlni4sMs&#43;j&#43;qilySB5MrNgntnd0cognTxfnGQ1T/OltTFXOq/uce8sl0nOc5bfSa7rxfZZjvVZbdi6qLNXZ3BaaRLgZJUmV2myzPmOHS6ySJPpia86PEizrdBeXebiLYf7VoZpctli/&#43;v0Sqcu6lnmGT&#43;6567G&#43;&#43;JBbYjuluu71q9eZJJhafP5hiMhTLLNO4qu1EUWSbpf/wejLuqkntdf&#43;bX5wzne73GPW1wX&#43;ZWz&#43;vvFB60msD&#43;K3HVZz2pZ/1HtPb8/WUfPD62RWmf1IvP06qzOc5nRB57yf1DhBYAfaZxOkotdXyzWZS6zGv74Hq9/hfqx2j5fL9m&#43;lFidHO8SY8n6i&#43;9ZmzJK9Tp3X2ifp1s272S9qIus3tmHZXS6ebxe9dNSf49NkgzDyVHNlY&#43;3SCdJLweq21UXuSjXuUnSKf16vcdDnrS4LlcxsHTTTSfNenGPh147Va3&#43;FPe/aFWn89yUfr3OZfoZ588HHVWYBDhhpZd&#43;kmVeOE/WSRmmk37pvXXEUmnSe89X1F/wfC&#43;d0WdHPUJnkCb7fAp6rJMkdVEW6ed5XfjZC9fXdeK3q/OySL9cvGkNbb4xPZN8vFUI&#43;ZKeybLjO646X/dO7vf95LMWl6aMym1u0s0i1/Xs2YnptVfXXR939mQ7y9nHh&#43;w6z2XGpanLnKdf&#43;u8/YhJDXAFO22op&#43;etXPtyvwsHbe5Q&#43;6pz0ec&#43;3fOFRx7081ovhbqe7TzhPvlIuTTpZ3k&#43;lWa3Kef8lQ&#43;mmk8WLC4pdp/ny3wc&#43;nTDJcds9N3MVJt8UaUs/txlmnn&#43;p5/U9y/zO62zL9hk9fpdZZpzU2SpWfsgxv3pgEgBfpnTWH&#43;tfi0ur&#43;3tvm7xSmq&#43;tofCm55sn6ez4cnp&#43;vANdSyfdzN/QD3j3iKc/8b37JctV2f4J4m7eJSfFMFc&#43;3urPz7u/zSuD7LHEbenuKDizLLP09uxde9Ti0s9Vkkk9f&#43;ER81f&#43;HM7e9eey9Z/&#43;uiznmZZeneUyvVwd&#43;xLLAHyyu7PUa19w3p1j&#43;&#43;sCc3dl5HpZ3J&#43;j15M6Ouk8KMeS0sto13m4dNLJqijdrM6S0kkvnWR17cF&#43;H/R8L5iln2RUUp&#43;Vqqmz&#43;7i0b4sftKeb/qpITea7e4BLJ4N00mSZea63feFcBuvpNvPdz7VFP89qN&#43;xlvm5750mv5tMZkU/L7QySTFYhdkf/5DzC5AkSJvl4qz/77x8ast&#43;3oN0Xn2m/Vjxu8TjJYleULL2kztYn392nrFXYfONQ3zov7R8zK5cZl991Wc5zU4a1TfW23Y57gA8Au6z7jl4LJ3VRHu2fq00cmN1N2yijB8Ng1&#43;GudHO1OQsON/1&#43;s3r3Zeft/XOURcZp1hXPp2WRywdfJX/U8&#43;12nWE6SUZlkOvMn1Rqv7dvi1d7NBmnyXWus0gvo4zK5fMzc2kyTj&#43;zrEr99DIt1/VRDdnSzyjJZSZp0s&#43;0zPJnz97GVYxtpfRWjylNxpnXdjMmsy40ONpVHbguyyKdXZ0AHK1Dr01iO9S2/mf7OpN7rAm5c9XGbmqerFmVmy3HvHp&#43;zMdH3GelqLywAlRus1mKd/8Wp79tr/tXsGrVevWp2y3P2n&#43;wFtN46/3DPX46f/NskeFHr2PL&#43;lBpcrtqd4ap719mOlep&#43;7TVZrPZbMe3Zbq6sMeeq39uNtebDFPz5Pyb3mq9562P3no2T7P6dJGr3N6frdcrX44f7fchz/fCK&#43;w&#43;ueE24wy2rjy5V4tranL15DXcbNln9cgHq2Knk78PW59Bam7uW/L0&#43;ouv6jY7P0lk1zqT00xr0svN8/VF8&#43;RTT56sKZlBakaZPl/l&#43;8lv3WCf1tuOZzt4A2wH/tG/N0w&#43;i0urkPj4T1CmW4759/kxH7co48dRcOer2PpnKZ08C3v7tHh9onj0vqS5f1fuIu56v2ctzM36D/QodesiyLe7Q&#43;KTd2znq8&#43;uk0B/c884f9N552/INHWfttpsNpvt&#43;LZVFNsrTN483zM17/ri&#43;dG9Tz8zrKLd&#43;DOeb2c7eqtPJY&#43;2v9vOw/u1eH3L9NEz1Dw6q6bJ7ZNHdR6/0&#43;vHPP9EtdfrS03dFTvz5HNEmvQyyG1qbnKbmunzzxDpPj5aOk/3SSe9l4NuRm/56di&#43;96YAD&#43;8zeDzJuvTTT3L&#43;ZAjDPE&#43;GhJbhepJ259l&#43;98fbt7j3aOtE71Gydbnh11q8miHweADrcD2UZWWRJPUis&#43;Tpuo5lmOV6yNBl5s/X5irDzPea7/D4nXh8jEfv2cPnr9e5Xj/jRRa5emchnt7rw58AOFL7T8T47Orsl48/M9R5JkkGX7S41uo5Z/mVyyeDQptclcEbW7w6//YePcPTqrGjdJI8HPr69J0eJ5k9&#43;UR1nWTw&#43;vl99VlhnwGxpZaav5muVx1d5jq/69nzob71STGfuni6T13U2R7P&#43;OXrkPO5hMkfp/RKr/TKXbWzXumXXumVTlK6pbf&#43;s9kt/fVtndIrvdWfwzIqvWd/2i/zoGZX6Wec5PxZ2ZxJlg8Xvy2D9O6KjT865mWS3mq/0s9iz7qnk0zL01A3Tj&#43;TrWtMvtLizSlh8we/DNLkPEm3dEuzaXnyJ9fpZHof7sow/btVHusyZ5mnXx7UVi2j9PNSWZ97s2wJk6UpvfXsiZReWZUXGpd&#43;6W2e4zxNGZVeurlMJ7c7ToN7KN28beI&#43;AMdg/3lrX79Q1CpgfWkd2LqsF/VXfuU8kwehcrxnpH3a4kWWefoez/MgSJUmg&#43;TJ/Mx5ZptjrcruPP85rb7cfr3e&#43;v6R7SyXSc5zlt9JruvFJ89ptPDYqTl016jtq7cdN4/u5088um30dM8nRxqlk2muMsoo09SMtw&#43;uTDfT/M04o4xylVGa9eCNp8cc5G/&#43;ZpTxfnMC1q3sZpqaq4wySD&#43;j3GbrMIp9W7w&#43;wqq1N&#43;thrYPU1Px9PKh2PShkdbTbjJ&#43;2OYPcrl/3OLcZ7TfPoWY1DPjZbf2du3d37vPGuZMZxoxJm81mO9ltc85/9by0/mf67LaPGua67Xy9GoTb&#43;ejn2/vd6Ww&#43;/9zud/xnLW6eThR5POVn/anihZauJ&#43;E8m26y3ytcfcp64X1/PMz1ZlU5IqNtE3Q&#43;8LdukBdqXdiOc1PN9cepOwuFbqt4Vi&#43;2DhV9uMciZ6WTXppc7q4wVuc5K5100ss8k7pIymK9fMWjYRN1kknppZdZ3a8H7zqXm6Pflc5OJtuLa&#43;/b4nqRi9JNJ93Mcrnao07KdbpPh33WSSZP99xx/3UuWq32dJ1B6T/uW63XebXM6z777OVtSx0DcBzulrjqvjwKZTOW5zPWSN5tkU6SXl5dIOxz1EUuynVuknSenov3a3Fdrt7X0k03nTSbTyh39u1b7H/JcN/z3JR&#43;vc5l&#43;hnfjbH6BF/7W8SXECb5AHWxz5/7usji/pRVF7v&#43;pDxc1enVY/55cLyLfR&#43;1T4vrPPPHYeruxPD6nu3u32GSwYMhtV&#43;sdNJ9KZADcOTuhjK&#43;EiY3wyW/djmHxaPn/lS7FtOq83KZYZLuXufiZy0uTYbpp5NJ5lnUWZk&#43;WmPx9dfWXR9320DXDz4/13m5zLjM1qtW7xef38IQ1xMkTMK3VOdlln5p15v5cdZLDwNwmup1WabJ6z1kq/uXJzxWZZRdKzOvwuSbIm3pr9eZ/P3O8/h&#43;Zfveb90nuV61ep9COm/xen8sR0cBHviuLtI8WJb5C5Umg8xUcgU4aauvDF8bRLkqR3f9MeGiDPYsDLcKcO/uDd3v&#43;cqOiLMekbRfb9qjFpd&#43;rtJkUndO/9njtb3vLNzy51WXOV8Pqb3MIlfvem5&#43;FGESvqk6z&#43;U&#43;5b8/wTDZs&#43;osAMfqMsskzUtxq/TXy0Vc7nvQV3T27Odbxbv3D63d7/le7i/brxWPWzxOsthV/aH0Sm89UPWlc/x8/QrepH1F1jrLZcalqcucp1c&#43;78vsrx0wzacTJnmjcjdx/2gcX4tzmeXTlSo/X&#43;lkmEvzJQFOW12uaw28FBtW9z0/J2wLBB82w7F00ySPZu5/6vM9Wv3x&#43;XPsEX4et7j0V9ee7HQfHHvp5TrLbO0XLv11vF/1HHe37rFP1FtuPvns6zLJMKnzXOxYw/u9Vl9NcFKESd6g1FIzTZL0Si21fOlaUD&#43;jxUlSl/mT3tvXinyjq0zqR30HDcC3VSeZJOnsOieWYbrJ1nPCtkCwT3BptkSz571z6wj7Sc&#43;35Ujbz7Slk04WW4rRvNbibQHwydqQdbl&#43;7/tbjrVIkrrIZZL&#43;lhFKo71e1TwtC97UZS4yLL2kXmbycB3tD9NEz&#43;TJESZ5i7Mn2/cv1XJ8LU6S1Hn&#43;fNK3gzuUcbLnsiwAHLl6nkmS4bYwVQYZJZlsPSc8CypluOqJexZA5nkYrnpbosTg8Vmu9NNPcv5ooOZHPt8228&#43;0o2RrpfjXWryKn4&#43;D3PDR/MtFUi8ySzIqT1/XclOz4DLzNE9HKJXhnkV5Hr8TD4/w6D17&#43;Pz1Otfr57vIIlcfPtWml6jIcHIOvdClzWZ7eUs3t/fLIH/yc40y/szlim02m8323bYMU1MzevzXP6PVrTse08nf1HQ31weZppeamnF66T3Ys596t2f6TxesXz/z7YMj9fM3NYPPeb6tr2XVhr/P3oFxasY79n6lxRmnpqb/oL3jdFYtS5Ob1TOlyVVqbu7P8Rne3be&#43;3uQm9eGZOaPHe7zwunqpz97vJr30c5WaXnrppZ&#43;aq/TTuztmmvzNaH3f3/x9&#43;pN4129a93mLbMe/lXroNAu8onSy/JolQkq3/ZR9AI5b6WSYQRa5XlcQ7WaQTq5zsXv&#43;fOlmlO565l8ni1ymu55OkqSWB3uuezjTpJuzx2ezUpNcZpJxllkk6aaXybZ5&#43;x/zfFtfSc1lvSjdjNLLdRZZZJlu&#43;unksl5s2XuvFpfReo3J1czIWb1IyiDjJMtc1M34qDLIMJ1cZ5Gkn1meLQlWBhmmyXWWadLLdS73/URQ/qZ5&#43;M6sq8xu97vOd&#43;zz&#43;6M&#43;GZRhRrkwkebUCJMAAD9c6aSX7rqozSKLR&#43;Vvdj&#43;mk17mmdfF&#43;lqSzJ&#43;HndJLL/Pnsw9X0axerJ&#43;/yXzboz/u&#43;bYe9SrnqyOUTgbprIeizra/A21aXLrppJvZ/R6lSff5MM/n&#43;7XfY&#43;ujxhnkz37vwlcoN&#43;nmlwJ/p0aYBADgAO6j2bE4phaXbm52zHk9RGs6uc11/XPodvDRFOABAIATU&#43;eZba0GexiD5FjKH9KGMAkAAKfnIk32WZPy05Umg8xUcj1FwiQAAJycOs9lBt&#43;ib3KY5JsMuOVjCZMAAHy50kuyYy3E7&#43;n4WpzLLJ&#43;uVPn1SifDbTV6OQUK8AAA8KWefQD99kVtjq/F63Z3M324GMlB2nCT&#43;XcpBMRH&#43;&#43;fQDQAA4Ic5e3L9&#43;/daHV&#43;LkyR1Xv7kqswPt450GSei5OnSMwkAACerdHOVs8MMMy2jNLlosz4mx0WYBACAE1Y6WR4m0JXu4fpE&#43;QrCJAAAAK2p5goAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMPmq0pSrclMGh24HAADA91HqoVvw7ZVxVkHyrM4O3RYAAIDvQZh8Rellur44r78P3RoAAIDvwTDXF5VOrjZXumV86PYAAAB8D8LkC0qTqzQPbhiU4aHbBAAA8B0IkzuVJlfpPrlxpBAPAACAOZM7lSbTZ1Fy5bxODt06AACAw9IzuVXpbImS//v633EZHbp9AAAAhyVMblGGudlEyfnm5v93lutLwzIt3daHBQAAOBnC5BNlWGpGm7I7k5xt7vr/5WwTJ3u5KTcCJQDwUGlK59BtAPgqwuQjpcnDIayTel6X91frPGcPeiq7UYwHANgoo/zNrWJ9wE8hTD52/23iIn/q&#43;dO76zxnuS&#43;/0&#43;x3UADg9JVuVkuIjYpPCMCPIEw&#43;Uuc5zyLzXOZ3vd66x7Ke5yzXWeQ6F4duLwDwbYzX/zabSwAnzdIgr9q8RbN69q4DAQAnq4wfTX&#43;5rL5yBk6enkkAgHcqoyeVFIZmTgKnT5gEAHiXMljPlnxoXPqHbhfA5xImAQDeoYx2zJG80jsJnDZhEgDgjUpTxpteyf/t2d3jMmp3PIBjIkwCALxBacogN5u5ksv8vzZ3/fvcrVM9LLelb6kQ4DQJkwAArZVObjPerFA9z1n&#43;582d/03ONnGyk6vciJPAKRImAQDaG&#43;Q&#43;IM5zVucP76zznGWxudqJYjzACRImAQDauwuPy1zU33X59O46z&#43;9cbq4u9j0swPH459ANAAA4PvW6nKeTZSbPg&#43;R6j2UuyiSDJLM6O3R7AT6eMAkA8AZ1ssc&#43;i1wcup0An8UwVwAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESkiRlUEaHbgMAABwPYRJW&#43;hkeugkAAHA8hEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFr759ANgG9ifugGAADAMREmIUlSLw7dAgAAOCaGuQIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCUmS0i29Q7cBAACOhzAJK6NMD90EAAA4HsIkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC09s&#43;hGwDfxEWaQzcBAACOhzAJSZI6P3QLAADgmBjmCgAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkJEnKqEwP3QYAADgewiSsdNM7dBMAAOB4CJMAAAC0JkwCAADQmjAJvKo0ZVqOaBhwGZfBodsAAHDq/jl0A4DvrjSZZlJnh25HCxeZltTJoZsBAHDKhEngRaXJNPPjCmZ1Wf7kRpwEAPhMwiTwsnFSzw/diHulSXfb7Y97Tuui/Mm0zOv80O0FADhVwiTwgjJMP2eHbsUj0&#43;1hslzXPw&#43;v11m5zlX5XZeHbjAAwGkSJmGHMnoWWub14tOerZdBemmSLHJRrw/96tetajL8drMlm733vMhthvm0nxkAwM8mTMIug2exZf8Y01IZ5776aCdX5fc3GZ45TJPLQzfiid&#43;bkD9KN/NNWHz2jtVFmWRYJnVx6CYDAJwiYRJWnoe3P1kthtFkkGSSZZ70F5YmoyQX7x1IWUYZJJlnkkXG6eQTY2urdjUZZPbdolhdZt1TWpZJli/2m04yyDDfaMYnAMDpECYhSfJ8AGudrUJL6WWQ5HpLaOmu7sl7h4H2kyxyVpdJ&#43;ZNR5t9kYOkgTb7JgNu3qfOySL&#43;8O&#43;4DAPDcvzp0A4B0klyvAk&#43;d17PPm5nZUj857jCZ5DpN&#43;oduBADAKRImga1KJ93Mj75Pb5ashysDAPChDHOFE1Q66SRZvDTfsTTpppsmyTyLLQV/&#43;snLA3jLqv5sk2XmWZe5KcP00mSZWX1j4Z7SST&#43;9JJ0sMs9lXZZOOm8e&#43;DuPMAkA8Cn0TEJr5W&#43;ppZaaaZJkurq23m72PEbv/jFJkuGDY6yHZZb72/6WdUmeMnr&#43;TI/265R&#43;ucltppnmttyW7Wsydso4fzPNKMMMc5WbLXt2k&#43;wMo6VbbjJOJ/PM0skwt2VUmnKTURaZJRnt&#43;048OmpTxrldV2m9ziLD3JZxbjMt07f9rOoyizTb3wUAAN5DzyR8rI&#43;ow9rZctTuupfw/r5tAanJ1aPbO5mW30/7J8sgo3U7l5mnSTdJJ1f59Wi3F8Jk6Waa5GzVX1gmuU0yzCBNzuqsNLlK0i3Ddr2TpZtpmiTXOV8Nry2TTNeLpry9d3GRTrr5HkutAACcEGES2vu1Dmzd1dIgj4LKnqGlzsqvTTCcJplsSt0s74ac1ssyS7N&#43;lrvH/Sm9JP0H61I&#43;3q&#43;b5DqXdZ6UYUZpMsijgj6ln3GSZSaboam9TPM8wnZ2vZrSZJpkE1LroqwuNJnUWZLxZlGVFjZRcl7/bF7ZvEwybPO&#43;bjFPb0s8BwDgnYRJaO1upcN1hHrjQh51cdfvV5Id6yXW&#43;eZZ7m&#43;bJaX3wn4Xd/2B9bL0033cp1eadZQ8ezBLcp55unnUi1g661e6zShN/tz3d5b70DhJkk311BYrVJZmHSXzOPpuAun7FksRJgE&#43;XWm2jpnJN1nuCvgEwiSclseFbxbpPjm1D9Mk&#43;fOw4E5d5vez47wUvwZZ1IdLhtzF1bsyPpcZJpnVSYt23w28nT350HF37PcNU/2IwccAvGy6PUyW6/sRJ8BpESbhtDxeF/J532A/b&#43;5L3bh4Eu3uPjysj1ovyux&#43;sO4&#43;SmczbPf6ye2dx8d&#43;gxb9owC8gy/u4McRJiFJUrppTmIgzovRaR3O3vk6n5XVedZ72PqdvJ8BuqNf8h3rXQqTAF/j9&#43;bLxVVV7rtpC0qgwckSJmFllN6z6YmnZ9XP96Gh&#43;cEcmbcfdzPL8knl2deP/HrI9E05wJe4qyiQlGV21AIAToswCT/Px8ar&#43;xmTb&#43;8D3DWY9eUZkxfpPxnWu401JgEAPsW/OnQD4LSUt6&#43;H&#43;BVWcW&#43;feLX/sNJ390s&#43;eM8ehcbXZkzWeb1oMzMTAICPJEzCI6VXhuXNPXflKtNy9QXNfGML18uR9PfY84WQVvrlptyWu3mOW3sPy1WpezfrPrg&#43;7tv8iBmTW9oGAMBHECbhgdLJNKNMH93Ypq&#43;xydfM0Xv70M3rJJ0yfPK6m/K31PI4ZC6397OWTq7STSej1SM3bZk/2qe/f&#43;Gbuqtwz/vnYiarIbTvDaMApHTKsEzLtNyWaRmVJimdbz4eB/hkwiQ81Hnw3zvd7CojsIoomxNp6aSXz6oe&#43;iCilsE7wuRlFklGZfDo1uGWCDzP9mB898jVq98E0Ed9maMk5w9a3C035e&#43;T53zoevMO3j&#43;m2Rz7/WtM6pkEeJfSlHFu11Var7PIMLdlnNtMy/T9RweOlQI88NA6CJZBnSRJ6WSUXpLJtp3rvCzSyaAsM6nL0s&#43;qv&#43;/1kjCr53j8bW5Tdg3qXLVpWFKvk9JL/y7OlV6yWs&#43;x9HLXj9ctD29rHu&#43;X1GX5k2majEs/k8zqsnQzXK8&#43;&#43;bjl8/TSfeHVXCSlyfD5HWWcfi4fxe9huknGZbajSM9lemmS9HO5eW3juyhb93xHd&#43;i9YakSAB4o3UzTJLnO&#43;eocVSaZrs9G&#43;ibhJ6u2V7bNhemhW2L71J/zNLWmJoMtd96k2fGo3rObRg/ubdLbunV3PM9qu3r2LKNn&#43;/x9cLmT4bP7&#43;1tu62yO183t668xvWz9rU8nf1MzrEk3N6kZ5CY1NeM0adbXRk8ec7W&#43;MNz5/vfWr2mUfkaZPrjrXf/npfveI9hsNtu&#43;24O/1r1Dt&#43;VDX1d3/Rf6ZuurvdnyiGn87bXZfsSmZxIeqZOyXPejrSwzqRc7956Vsww338rOnvTHdbN98M8sZ1lkuWN25bO&#43;u3pRkv5m8O08kyxztdl7&#43;ewRyy1DbRf38wbrvPzOIIPNERe5zuXTIjd1Vpbbvm&#43;ui3KWq4zKKMkiZ3VWrjNKP4P1d9SznD3rCbxMN51c755PWmflV4bpZphkmVnO01sPc33fENVePnhdTYCfpTTrXsnk8dnw7i&#43;6v7Hwg7UouPhTbd6iWT07dFv4PGWaXi2ba5100s0yi30GSK6L0DyrOVo62T5LcFEnrx/12bOsFsp4f2XTV9u9uX&#43;cQf5sH2Raumnuhs6ub1kFzxfaV3rp7Q7mz/b&#43;u/6gcvaeQarlJt38escKmAB7K6PN0P93/eX6Xsr47qvCx5&#43;Dyu36K8kt54kyTc/nJvgJ9EzCFnWRxf7ftdbljnUQF9k7Ou3Zpo99lctXXuMkg/S2z5p8vnTIHh&#43;cOq/usVG6mxmT74mSnXRzLUoCvNWDr0Wvn9z&#43;4krAwM&#43;gmiskSerZfb8kK3WeWfpvX3Xzme72jxxlUKblqjyuUHs/dPg9BtlRPAmAvdyPsHn89/jjVgIGjpgwCex2ka31Wt&#43;iNOlu62Us/YzTS//J82z9Jrz1Mw4yO52hZgAHcLdI0&#43;LJKI/XVwIWMuEHECaBneo8lxl8UN/kcMdHjsfrViZJyng9fGr2ltmlD57x0WqXALS2azDrpmdy66Mucnm31BNwyoRJ4CWXWWb8/sOUbro7iu8s1/9dx8bSK3drl13nzzuesZNhLs2XBHi7BysiPwqNr82YrPN6Ud9Xixs4CgrwAC&#43;oy/In0zJ4Vw9hSidXO4PhatmQJuOyTHL3AeU6k3cOUL3KpPpeHOA97seMPP5qzoxJIIkwCbyizsufXJX5e75jrovye9cHjjrPr9LLXfXWeZaZv//jSRkn1RBXgHep87vadE&#43;&#43;3nt9xiTwIwiTwCvqrJzlqpy9Z8joy&#43;Gwzj72A0kZJbG&#43;GcD7Xa9K8JTO/TmgNJuyPIaywg9nziTwqjrP2VHV5buu54ZeAXyAy/Vf/7v4mNLLzWYl4HdU3AZOgZ5JYA/HVchG2QeAj7Ga6pAmo9Jknm66uS/KY5Ar/HjCJAAAO9RZ&#43;ZVhuhkmWWaW8/TW/ZS&#43;uIMfT5gEAGCnusyjpZ3KaH1BzyT8eOZMQpKkTEs9dBsA4Lsr3c2MSWESfjxhEgCALcqgTMtV6T668W7OpCgJGOYKAMBzpZ/x&#43;uKfBzcP1v&#43;q5AromQQAYIu72PhgqaUyTidJMquTQzcPODxhEk5a6ZTOodsAwFFarv&#43;7jo2lV6brgHn9qK8S&#43;LEMc4UTVkYZJuWiXh66JQAcnct000mTcVkm6az7JK8zUXoHWBEm4ZQNkySj0tSLdx4JgB&#43;mzvOr9HJXvXWeZeaZ1&#43;U7DwucEGESTtlsXXVvWLq59E0yAO3UmaqtwG7mTMIpu&#43;&#43;P7GVapqV/6AbBz1K6pWfeMgCnSpiEE1bn&#43;Z3F5movV&#43;VvGYuU8BVKr9zmKsNMy1VpDt0aAPh4wiSctDrP7zws395kkKtSy0250l8Cn6cMMs2i/qpnuUwvo0O3BwA&#43;njAJK9c50YqndVnP8ytP1wPrpu/jLXyW0mSU5CIpo4zTbNbrA4ATogAPJElOe/HluigX&#43;V/zL/l36R66LfAjDNMkdZ6si2DND90gAPh4eibh5JVuGedv/sv82/o7vx7U5TvRvlj4BgbJ&#43;v&#43;1WZJFzg/dIAD4eHom4aSVQQab3she6WS5uXZZ9ZXApyirdfnmSVIvYpVXAE6UMAknqnQyyCCPa0gOkvUti&#43;oDLnyW1dDWxTuPAgDfnDAJJ6h0Msq2BUD&#43;8/xf1pcMcYXPs6qUrO8fgBMnTMJpeh4lZ7lOMk6SLE674BAcWDdZl98BgBOmAA&#43;coLrI9YOry0zyq57VyXrwnX5J&#43;Fzd5EGpKwA4UcIknKa7nsdFzvOrntdFUppNf&#43;X1Ww8LvKaYMQnADyFMwkmqsywyyVn9VSd1ub5xEyU3twAfpvTLTamlZpokGZRaaqnl5tDtgs9WOqVXOoduBXAI5kzCESv9DJJ6tu2&#43;&#43;uvZTXenesPv4DPMM8ssSTe9JJOsvrTRQ8mJK53cpEnKPLPM6uzJfZ0s6sn9X1BqZtvPvfDTCJOQJCmDdI5psYzSZJj&#43;Kh6W7p6FPu5WmDy50zp8B3WxWlGyTJOknh&#43;6PfBF&#43;uslp7rpZliS5aaScZNukmU5U44KTpUwCSv99I5lafHSSz&#43;DBzcM0u5jq5M6fKZufGXDT/L0t73ZFHu7u9513oFTZc4kHJHSlEG5yfRRlEz6pdnr4XczJffbG3iD0kkTX9nwk7w&#43;C9//D3Cy9EzCMbndGgSv0&#43;xxMk8u008yP73ZK/CNrIaT&#43;7&#43;MH6POysOr///86wfXlrnOtUGucLqESTgm10/6JBe5zuW&#43;tVnrvPxLulX5HfhMqzDp/zN&#43;jCdjY/515vV36SVZCpFw&#43;oRJOCaTB2FylkltuV5kXfqIC59sVTXZh2h&#43;ju7T62WsABX8FOZMwhGp88yTLHOZX/WsbZQEvkA3ydJarvxA97/1gzJ4x3GAIyJMwjdUmp0n4suc13&#43;pF&#43;Y9wndUmnSiX5Kf5W4N4//6QZwcl&#43;7bDgYcF8Nc4ZspnQzTT1MW22Y36o2Eb231AVqY5Ce5C5P/U85ys7l1Wn7poYfTp2cSvpEyKNPcZpAmSf/QrQFaW62vJ0zyk9z1Qc7r/NGqx523HAw4LsIkfAulU0blb8YPlnoeFCdiODarupbCJD9Gae7OW3WW1EkmSZJ5fp10LdfLGCcESQxzhW&#43;g9DLY2g/Zz&#43;Wh2wa00k0Sc5r5Qe5m&#43;K8nZtTz0s381Ku51otDtwC&#43;C2ESkiT17IBP3t8SJeeZ1MkB2wS8RTfWmOQHKU2G64ubnrr6&#43;9CtAr6OYa5weI/7H5eZ5Hf9LUrCsSlmTPLTdNdDu5eGfcLPpGcSDq4uymw952SRSSbq38GRWhUiMciVn2OeZZok585c8DMJk/AdXKeX60yq4XFwzFZ9NP4/5seoy/I7vczME4afSpiEL1P66W8PjHVSnIrh&#43;HWTLPy/zE9SFzEpA34wYRK&#43;QGkyyGC95tbWXgsfP&#43;EE9BIzx2Cb0nGeg1OkAA98stIt4/zNaB0l&#43;1aPhNNUVjMmhUl4ojTlKjelOXQ7gI8nTMInKoNyk5vNKlwrgzceDPiGyqhMy2pxhF6SxUkv1A5vULqZpp8m00O3BPh4wiR8ktIvfzNeV3cETlIZZZheRklWMyYv33c8ODWlk&#43;n6TNgt40O3BvhowiR8lnmeDulZ5DK/6sWhGwZ8mM1iIKVJPwvrw8JjdfFg5dVBOZGxOWV0Kq8E3kuYhE9SF4/mTs1yXn/VCwUI4KQsssx1/iQZZpk/h24OfEN/Hqy9Oi69QzfnQwzTP3QT4HsQJiFJUqalfvhBV2FymUl&#43;1TM9FnCCLrLIMv0yziBn5kvCc3WZP1lurl4pQwenRJiEdyvN9lNjvc51zvOrnuuPhNNUl/V3Zknm&#43;SVKwnZ1nvsJHk2u1HWF02GdSXiX0skgg8xztu3eatAbnLx6bTkQeFmdlE6G6yvdjHJ&#43;6BYBH0PPJLxZ6ZdpbjNMk55hOwCwS73IbHNlUMw4hBMhTMIblKaMym2ucl9IYPiOwwHAqbsvxHNZ9ebDiRAmoaXSK&#43;P8zTCP&#43;yL75oAAwC7rQjzL/LFEFpwOcyahldJkuuXmedRqBb6d0su8Lt9/HPgIdV7Os1CqCk6JnklopS6fxcZJzurvOvGBDfheyijT3Bo1wfdRr0VJOC3CJCQpTf4l2bOIzv1Mj0Uu8y/1vM72ehzA1&#43;omaSyuDsBnESb58cqg3ORv/u9JbsttGb32LX6dZZ7kOn/qr3qhPxL4tlZ9QEN9k/DBZtHDCkmESX640pSbjNPd3NDJMLelmySlV0Y7HnaRX/WPWnTAN3eZZZJORu8&#43;EvBAPVNECFaESX6w0uTmQZC80&#43;Sm/D/LbaYZlt62x9VZXbx6cIADq8v10vCDMj50WwA4RcIkP9lVds2S/K/W95hrBByxer0uGTYo1sLlmyrdou8cjpYwyY9Veum9utPAXCPgmNXzdZwc6Z3kOyqD3GToyw44VsIkP9frUXL/vQC&#43;q4t1qZBBudmzZjV8kTLO6kuOUXG2haP0z6EbAAfTfeX&#43;ZSaZmB0J300ZRS/G23RzUyYKh/BdlM6DySRX5bczLhwfPZPfWumVunXb&#43;v1dmW7dd/oBR96&#43;79Y5DmW0fe8dr7DNkT/69b32Lej/p148P7F94utrceSj/80wPwYOo8mwvPZFGnyRusj9VxtNrkwsgeOjZ/J7W2a24/Zt5i1ubXfk7fsudty6fe/t2hz5o1/fMi&#43;ftv77L359bY587L8Zvn2GQ1nG6rh8G3VSOpuRBt2M1vWHgaOxq0OFjc1bNKtnh24LH6lMX&#43;6brOXQLQS22at4Fg/9J/l/5D9OklznwlDCz/NgCPZZbfPF449Wrh4Mdr2ol4duD9CGnkl&#43;rtmLH0ivD908YLs6azU&#43;4Mcr3UzXUfK8Tg7dGnjmPJ1NFYNRWVTnXzgi5kzyc01eHOzlIxdwAkqTqzRJlvkjSvId1WXOH5yPx8cwq7f0jqGV8BWESX6suszuwTTXBigBx680maaTZJkz/T18V3V&#43;dHMlp1FIDpIIk/xo9XJH/&#43;PxndYAthmuhw/&#43;qfN3Hgk&#43;Ub1ef707zy&#43;/q3BMzJnkR6vnZZHhk6qul7msqh0CR6901&#43;Vgzo214LurF6WTZfVVLhwZYZIfrl6WSQbp5d/l32SWeSYqHQInYpAkmZkryTGofw7dAqA9YZIfry5zmcsyTc/iL8BJ6SRJLLUAwCcxZxIATtMky0wMcQXgs&#43;iZBICTVK&#43;tmAvAZ9IzCQAAQGvCJAAA31LpHLoFwEsMc4VWyiC9NGmyvK/8Wobppckys6rQBQB8iNJknF45s/IkfF96JmFvpVtuMk4n88zSyTC3ZVSacpNRFpklGZWbQ7cRAE5B6WaafpqMS/P&#43;owGfQ88k7Kl0M01ytqqMWCa5TTLMIE3O6qw0uUrSLUO9kwDwPqWTaVYhsptxvtsalGdZHroJ8D3omYSVeV4sn1&#43;aTJP8viuyvxrgmqRZF94fp7e&#43;DgC8S108OCv3y&#43;jQ7XnSupmht7CiZxKSJPXilR1GafJnEyHzYNDNJEnSX19bBAB4r/N00l1fHpZ5tdANfEN6JmE/gywench6638X628nV4NbZ3Vy6IYCwPGry5w/GEw6Lt13HAz4JMIk7Oci54&#43;u353U7oa9XuQsv&#43;vZoZsJAKehzh&#43;ceRXigW9JmIS91Mv6eE7lXc/kZtaEGRQA8JHqde4noXQzPnR7gKeESXiD0jztmQQAPlq9zP30kX4ZHLo9wGPCJLzF/YxJBXcA4PNcbMYAXapLAN&#43;NMAlvoV8SAL5AXeZPllnmz6t114EvJ0zCXkq/3JTbzQCbZzMmk6RclXrodgLAaamLnOXM0iDwHVlnEvZQOrlKkowyeTRjcv5on75VJgHgoylwB9&#43;VnknYx12P5GrFq/7dzY9Ob6PkyfIhAMDJKdMyOnQb4HvQMwlJktJNU1&#43;fAXmRlCbDLY8fp5/LPY4AABy33vsPAadBzySsjDJ94d5Jlkku6nXpZppOzlcDXMu4NKUpg3KTQS6VBgAA4OcQJmEPdZGzLDIqNTdpclYnOcskywzyN38zzjJnoiQAAD&#43;JYa6wlzrPr9JNk&#43;VqnmRd5jznZTXQZV6Xh24fAPwkpZtBVakADkyYhL09ryZnjiQAfL0yyDgpS6OC4LAMcwUA4IiUccZJkuFm/WfgIIRJAACORuncL9GVUem&#43;41DAOwmTAAAcjbrIn82VJlelOXSL4OcSJgEAOCJ1lvu5kp1cHbo98HMJkwAAHJV6mcnmSq&#43;MDt0e&#43;KmESQAAjs1F7musf3Uhnlnm7z8InAJLgwAAcGTqsvzJTe7mS47KvH5ZwKtnh3718F3omYSVizg1AMDReFSIBzgIYRKSJHVeZ4duAwCwvzrLeZJknl9f1y8J3DPMFQCAo1QnpZvU80O3A34qYRIAgCMlSMIhGeYKAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQDASSndQ7cAfgZhEgCAk1GacpWbz4yTpSeswoowCQDAiSjdTNNPMi3Npz3JNKNDv074HoRJSJKUUZkeug0AwHuUJtOseg2bOK/DpxMmYaWb3qGbAAC8R13menOlW8aHbg&#43;cOmESAIATUc8z31wZlMGh2wOnTZgEAOB0nGW5uTxWKgc&#43;kzAJAMDJqMucPbj6mYV44McTJgEAOCF1nvPNFYV44BMJkwAAnJQ6yWRzpWvmJHwWYRIAgBPzoBDPZZ2861DATv8cugEAAPDhznKb5Lxev/tIwA7CJAAAJ6cuy1lS5&#43;8/ErCLMAkAwAn6rCBZy6FfGXwXwiSsXMd3lwAAsDdhEpIkJucDAEAbqrkCAADQmjAJAABAa8IkAAA/ROmWq9IcuhVwKsyZBADgRyiDjJMsc37olsBp0DMJAMAPUMYZJ0kGZXjotsBpECYBADh5pUlvc2VUeu84FLAmTAIAcPLqMn&#43;y3Fy9Kp1DtwiOnzAJAMAPUOe52FxpohAPvJswCQDAj1Anudxc6Wb0tqOUWqaHfiXwPQiTkCQpg/LGUwoAcCzqRWabKwrxwDsJk7DSjxMKAJy&#43;P1lsLivEA&#43;8iTAIA8GM8KsSzfFCSB2hNmAQA4AfZFOKZ51edH7o1cMz&#43;OXQDAADgK9VJ6aTJRdUvCe8iTAIA8MPUi/cfAzDMFQAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAJKU7l67Xeb60C2F70GYBADgxytNGeem9F/fs17UyaFbC9&#43;DpUEgSVLPDt0CAOBQSidX6SYZl0WdH7o1cCz0TAIA8KOVJjdZDXFtMi7NodsDx0KYBADgR6vL3A9c7WZ86PbAsRAmAQD44erFg6I6/TI6dHvgOAiTAABwnvu5ksN9CvEAwiQAAD9eXeY8y83V8Z7LhMCPJkwCAEDqPOebKwrxwB6ESQAASFKvc7m50s3g0O2B706YBACAJI8K8VzWy3cdCn4AYRIAAO6cZ55lzuvFrh3KqOizhCTJP4duAAAAfBd1Wc6TOn9hl2FmD9alhB9MzyQkScq01EO3AQA4vDp/MUoCG8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAvKh0y1VpDt0K&#43;G4sDQIAAC8og4zSJPlz6JbA9yJMAgDATmWUYZKkX/59/tt0k/zfyjAzC4iAMAkAALv1Npf&#43;i/wXSZL/c0ZJmeVCoORnM2cSAAB2&#43;5Pl1tt7mZbBoRsHhyRMAgDATnWxc65kk1HpHrp9cDiGucLKdQxUAQDaaTLO70M3Ag5FmIQkSZ0cugUAwDc1euG&#43;bunX60M3EA7DMFcAANipNHl5KGtvzwPBydEzCQBw9Epve6SpF1v33t7TNquzLfsO0tmy72LbmJ7SyfaCNJO6eOeRP&#43;/1vX7k12ZF/mel8&#43;7X1&#43;6d&#43;9jX99Yjf8lvxvZ28m1U2yvb5sL00C2x2Ww2m832fbeMNhd7B332R9uOvbffPNq673Trvls/F6W348i9dx/5817fq0fe&#43;ao&#43;8vW1e&#43;c&#43;9PV979&#43;M195622E3PZMAAMdvklmLvc&#43;23rrYeutFmi23bl8sY77jyNuL3LU58ue9vnZH3uY/fMDra/fOfd7r&#43;86/GXxDpR66Bd/e5i2a1bN3HQgAOGFllOH64ll9bzzhW3nlA/OloZj8VArwAADAS67fcS&#43;cMGESAABecvnCfbNqpWp&#43;LGESAABeUOc74&#43;Qyfw7dOjgcYRIAAF5UL7bGyUXO6rL1weBkCJOQJCmDHSsrAQCkXuTsUV3UZS7z2xBXfjZhElb6mxp8AADP1Fk9y6/8SfI/5Kz&#43;S73QK8lPZ51JAADYS11kUZL/r8VfINEzCQAAwBsIkwAAALQmTAIAANCaMAkAAEBrwiQAAHwLpSnT0nvzo8dlcOhXwM&#43;imisAAHyJ0k2T5a7VKUuTaSbvqBR7kWlJnRz6VfJzCJMAAPDpSjdXWWSebkn&#43;PF&#43;jsjSZZv6eKFiX5U9uxEm&#43;jmGuAACwv7NctH9Q6WSaRT3LZRbpZttw1HFSz9/XtLrIn4xL99BvET&#43;FnklYmb//EADA6XvjMNRxmsySjDJI0nl6dxmmn7OPaF25zlX5/bznEz6enklIktSL&#43;gF/wAEAnivd9JLMkjRJkusn9zcZvmu25EMX6WR46FfMzyBMAgDA5&#43;onSZ0nuchlzp7FxmGaXH7MU9VFJhmWzvuPBK8RJgEA4HN1s&#43;qXTF3Ui6dRsjQZZFYXH/Zsk0TfJF9BmAQAgM/VzUv1GQZpng58fY86zyL90hz6RXP6hEkAAPhEpZMmye6ex37ykWEyyXWa1dBa&#43;EzCJAAAfKbVUh07wmTppJv5B1dfnSXpHfplc/osDQIAAJ&#43;pm7ywpEg/6/mUu5RBemnSZJl5Jqu5lWWYXposM6vbCvfMI0zyBfRMAgDAJyi9UkstdVUMZ3W51Ge7dfPCENjSLTcZp5N5ZulkmNsyKk25ySiL1bqV5eb5o&#43;oyizSle&#43;h3gFMnTAIAwCeos1V&#43;zCLJ9TpLlme7vRAmSzfTdHJWf9eLepHVmtjD3Kabs3q&#43;XkykW7ZVbl3kbngtfBphEgAA9lamZdTyIZ28VH6nkx2VXkuTaZLfdwNkN4uHNJnUWZLxeijrtrqt8/WR4ROZMwlJktJNU2fvPw4AcOJazkUsq/13fMoonSTZUX5nlCZ/7teffLDYxyRJNvVadwVVYZJPpmcSVkaZHroJAMAJWg023bXK5EuBb5BFfbhkyF2MXdTV0VbDXGd1suPxVprkk&#43;mZBACAz9NJsnjT0h8XTyLo3RzIu2GvF2WWZd0eUxeBTydMAgDA53mxWutLni36cdczuYmPL0zRESb5Aoa5AgDA5&#43;lm9yDXFkrztGfyRYa48gWESQAA&#43;CTl5RmTbdzPmNyn19GyIHwBYRIAAD7La2Fy/7mUbfol4UsIkwAA8Fk6SZa7&#43;xLrC32WpV9uym0ZrK8&#43;mzGZJOWq1J0H&#43;Ij&#43;UHiBMAkAAJ/l9RmTy81alI&#43;UTq7STSej5NGMyfmjffo7Su100qbXE95EmAQAgM/Sy2thcp7t5XLueiRXkbB/d/OjvsxRkvOtR21efV54N2ESAAD2N9s/pJVOkteW6Zjn5XI5F0lpMtxy9HH6udyxPEjvxYVD4EMIkwAAsLd6Vi/23nmfWq6zbA&#43;TkyyTXNTr0s00nZyvjlPGpSlNGZSbDHK5vS2lG4V6&#43;ALCJKxc5OzQTQAATkw3ybK&#43;GCbrLMtsmTNZFznLIqNSc5MmZ3WSs0yyzCB/8zfjLLM71vYiTPIF/jl0A&#43;B7qGYVAAAfbb8ewusMSr9eP725zvOrdNPcxdG6zHnO18V65vWl8jr9JNeBTyZMAgDA5&#43;hknzA5ySC97eHv&#43;dfdr8&#43;ELJ10c10Xr&#43;0H72WYKwAAfKDSlCZJSied7NFDWOeZpV&#43;aVw&#43;8r0GSyaHfBX4CYRIAAD5MGeRv/pZeVjMXJ3Wf1R4vsrVe65uev8kgM5Vc&#43;QrCJAAAfJxRktUA126Sy30eUue5zOCD&#43;iaH2bX2JHwwYRIAAD5Ok2Se69LJIJd7z1y8zDLj9z956WTY4lnhXYRJAAD4OJdZ5CLdXGWy/4qUdZk/6ZXBu5/9KpO6V28ovJ9qrgAA8GHqRZmllyYX7eYt1nn5k6syf89yZWWcVENc&#43;TLCJAAA7K307tZ93KXO9lgOZOvjylmuytlbB6mWUZKzQ78//CTCJAAA7G&#43;a2WdFtjovZ9mn&#43;ut21&#43;/p1YT2hEkAAPgm3lM6R5TkqynAAwAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa/8cugEAAHBEzrI8dBPgexAmAQBgb3V26BbAd2GYKwAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAACwt1LL9NBtgO9BmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJgBNQRqWWq9Icuh0AwM8hTAIcvdLNMEk/g0O3BAD4OYRJgON31yMpTAIAX0aYBDh&#43;8yyTJJ0yOnRTAICfQpgEOHp1mcn64rD0D90agBN3metDNwG&#43;B2ES4BRcZrG&#43;NC7dQzcG4JTVizp5/1HgFAiTACegLvNnfbHJVJwEAD6fMAlwEuo85&#43;uLTaYGuwIAn02YBDgRdfIgTl6V4aHbAwCctn/aP6R08zOrBf67Mj10EwBe8T/m364vjUov53XxnoMBAKemdNLU&#43;ccc6w1hMk16h34LDuLf/NDXDRyrXm7Kb3ESALhTupmmKdf1z/uPZZgrwClrMjh0EwCAb2SQJkm/fEg3mTAJcMpmh24AAPCNLNf/fsjXzcIkwKma56wKkwDAvbtPBv3yAXHyDXMm6yzl0O/BVyp1fWFWzw7dFoCXlEHGmyuX9eLQ7QEAvpc6K9dZLSA2KvP3FuLRMwlwIkr3QZQ8FyUBPkcZfUSPDhzMxXqoa5Np6b7vUMIkwEko3dwtX7TMWZ0cuj0AJ2u47teBo1QXufvCucnV&#43;&#43;KkMAlwGsZp1pfOzZQEAHapk5yvL3YyfU9dV2ES4ASUYe6&#43;WTyv14duDQDwndVJLtcXm0zL8K3H2VSXYRcFeIDvr/xd90squ8O3UkZ580cUAL7MLBdvKcajZxLg6JXeOkouN98zAgDsq7epvNCKMAlw/O4WIJ7U5buOAwD8TE1p2j9ImAQ4enWeSZKZfkkA4E3e9IX0P4duNQDvV883ddngO1nkJ9UW/r/m364v/Yf8PXRj&#43;ES9/C/57w7dCHin/yj/af5P68vLt5bvU4DnVQrwAACve1Bu6MwCPaesVJ8KOXalyXRTB36es7dOkzHMFQAA4Md4FCUn9ffbKy4IkwAAAD/H&#43;EGUfNc0GXMmAQBgb7UcugXwHmWQ/vriO6OknkkAAIAfojQZrS/O3xslhUkAAICfYpDVepLLfEAZKWESAADgZ&#43;is/718e9mde8IkAADAz7BIkizzpnUln1KABwAA4GeYpEkn13XxEQcTJgEAAH6EuszFxx3NMFcAAABaEyYBAABoTZgEAACgNWESAACA1oRJAADYW6lleug2wPcgTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGv/HLoBAABwRC6zOHQT4HsQJgEAYG/14tAtgO/CMFcAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAYG9lWkaHbgN8D/8cugEAAHBEeoduAHwXeiYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAgP3NMj90E&#43;B7&#43;OfQDQAAgONRzw7dAvgu9EwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArf1z6AYcgcv1v4tDNwQAAOC7ECZfVS8O3QIAAIDvxjBXAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWSj10CwAATkDppLO&#43;OK/LQ7cG4PMJkwAAALRmmCsAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBr/wfr7Bns44hgXgAAAABJRU5ErkJggg&#61;&#61; " alt="" /></div>
<p> You can see the direction <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span></span></span></span> in the output being transformed into the input space. This is how we propagate the gradient through <code>func</code>. If you have the gradient of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">x</mi></mrow><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span>, you can compute </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext mathvariant="monospace">Jt_func</mtext><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mo stretchy="false">)</mo><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mrow><mo fence="true">(</mo><msub><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi mathvariant="bold-italic">y</mi></mrow></mfrac><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">y</mi><mo stretchy="false">)</mo><mo fence="true">‚à£</mo></mrow><mrow><mi mathvariant="bold-italic">y</mi><mo>=</mo><mi mathvariant="bold-italic">x</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\texttt{Jt\_func}(\bm{x}, \bm{g}^{\intercal}) = \bm{g}^{\intercal} \left(\left.\frac{d}{d \bm{y} }f(\bm{y})\right|_{\bm{y}=\bm{x}}\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord texttt">Jt_func</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mclose">)</span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.462em;"><span style="top:-2.266em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size1"><span>‚à£</span></span></span><span style="top:-2.864em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.3333em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.3333em' height='1.216em' style='width:0.3333em' viewBox='0 0 333.33000000000004 1216' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V1216 H145z M145 0 H188 V1216 H145z'/></svg></span></span><span style="top:-4.072em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size1"><span>‚à£</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.6886em;"><span style="top:-1.7003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03704em;">y</span></span></span><span class="mrel mtight">=</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">x</span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.1358em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span>
<p>Where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi mathvariant="bold-italic">y</mi></mrow></mfrac><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">y</mi><mo stretchy="false">)</mo><mo fence="true">‚à£</mo></mrow><mrow><mi mathvariant="bold-italic">y</mi><mo>=</mo><mi mathvariant="bold-italic">x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\left.\frac{d}{d\bm{y} }f(\bm{y})\right|_{\bm{y}=\bm{x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.9978em;vertical-align:-0.8358em;"></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03704em;">y</span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mclose">)</span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em;"><span style="top:-1.966em;"><span class="pstrut" style="height:2.616em;"></span><span class="delimsizinginner delim-size1"><span>‚à£</span></span></span><span style="top:-2.564em;"><span class="pstrut" style="height:2.616em;"></span><span style="height:0.616em;width:0.3333em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.3333em' height='0.616em' style='width:0.3333em' viewBox='0 0 333.33000000000004 616' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V616 H145z M145 0 H188 V616 H145z'/></svg></span></span><span style="top:-3.172em;"><span class="pstrut" style="height:2.616em;"></span><span class="delimsizinginner delim-size1"><span>‚à£</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.3886em;"><span style="top:-2.0003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03704em;">y</span></span></span><span class="mrel mtight">=</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">x</span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.8358em;"><span></span></span></span></span></span></span></span></span></span> is the Jacobian matrix of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">x</mi></mrow><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span>. <a href="https://en.wikipedia.org/wiki/Leibniz&#37;27s_notation">Leibniz&#39;s notation</a> is insane, so we&#39;re going to adopt the notation from <a href="http://www.strangebeautiful.com/other-texts/spivak-calc-manifolds.pdf">Spivak</a>, and <a href="http://ceres-solver.org/spivak_notation.html">other</a> <a href="http://www.vendian.org/mncharity/dir3/dxdoc/">people</a> <a href="https://mitpress.mit.edu/9780262019347/functional-differential-geometry/">agree</a>. Let me clarify the notation a little bit more. In math, we often confuse functions and expressions, so if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><mn>2</mn><mi>x</mi><mo>+</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">h(x) := 2x + 5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span>, we would talk about the function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>, when we should be talking about the function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span></span></span></span>. Normally the derivative operator applies to expressions, so we write <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi>x</mi></mrow></mfrac><mo stretchy="false">(</mo><mn>2</mn><mi>x</mi><mo>+</mo><mn>5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{d}{dx}(2x + 5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">x</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">5</span><span class="mclose">)</span></span></span></span> or <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi>x</mi></mrow></mfrac><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{d}{dx}h(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">x</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> which means &quot;expand <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span></span></span></span> into an expression and then differentiate the expression&quot;. In the notation I‚Äôm using, the derivative operator applies to functions, we write <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi>x</mi></mrow></mfrac><mi>h</mi></mrow><annotation encoding="application/x-tex">\frac{d}{dx}h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">x</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">h</span></span></span></span>, which is a new function with same input type. We abbreviate <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi>x</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{d}{dx}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">x</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>. Thus, let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi mathvariant="bold-italic">y</mi></mrow></mfrac><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">y</mi><mo stretchy="false">)</mo><mo fence="true">‚à£</mo></mrow><mrow><mi mathvariant="bold-italic">y</mi><mo>=</mo><mi mathvariant="bold-italic">x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Df(\bm{x}) = \left.\frac{d}{d\bm{y} }f(\bm{y})\right|_{\bm{y}=\bm{x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.9978em;vertical-align:-0.8358em;"></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03704em;">y</span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mclose">)</span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em;"><span style="top:-1.966em;"><span class="pstrut" style="height:2.616em;"></span><span class="delimsizinginner delim-size1"><span>‚à£</span></span></span><span style="top:-2.564em;"><span class="pstrut" style="height:2.616em;"></span><span style="height:0.616em;width:0.3333em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.3333em' height='0.616em' style='width:0.3333em' viewBox='0 0 333.33000000000004 616' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V616 H145z M145 0 H188 V616 H145z'/></svg></span></span><span style="top:-3.172em;"><span class="pstrut" style="height:2.616em;"></span><span class="delimsizinginner delim-size1"><span>‚à£</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.3886em;"><span style="top:-2.0003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03704em;">y</span></span></span><span class="mrel mtight">=</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">x</span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.8358em;"><span></span></span></span></span></span></span></span></span></span> be the Jacobian matrix. Finally, let&#39;s rewrite the equation: </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext mathvariant="monospace">Jt_func</mtext><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
\texttt{Jt\_func}(\bm{x}, \bm{g}^{\intercal}) := \bm{g}^{\intercal}Df(\bm{x}).
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord texttt">Jt_func</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<p>Much better. Note that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Df(\bm{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span> is a matrix, and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span></span></span></span> is any column vector &#40;we&#39;ll talk about what <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">g</mi></mrow><annotation encoding="application/x-tex">\bm{g}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span></span></span></span> really is <a href="/blog/2024/01/05/autograd/#what_is_going_on_bringing_back_rigor">later</a>&#41;. Now, why does composing <code>Jt_func</code> work? We&#39;ll hold off on that for a bit &#40;unless you can&#39;t wait, in which case it&#39;s <a href="/blog/2024/01/05/autograd/#what_is_going_on_bringing_back_rigor">here</a>&#41;. If you&#39;re confused right now, that&#39;s entirely fair. We&#39;ll go through many examples, and then I&#39;ll explain the underlying theory. I&#39;ve just said this stuff so it will click later on.</p>
<p>The way we figure out how to implement these <code>Jt</code> functions is we evaluate <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}Df(\bm{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span> &#40;which you should think about as taking direction <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span></span></span></span> from output to input&#41; for a given <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>. Let&#39;s start with the functions I introduced in the simple neural net at the beginning of this article. </p>
<h2 id="implementing_jt_subtract_const"><a href="#implementing_jt_subtract_const" class="header-anchor">Implementing <code>Jt_subtract_const</code></a></h2>
<p>We will start with <code>subtract_const</code>. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><mi mathvariant="bold-italic">x</mi><mo>‚àí</mo><mi mathvariant="bold-italic">b</mi></mrow><annotation encoding="application/x-tex">f(\bm{x}) := \bm{x} - \bm{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span></span></span></span> with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">b</mi></mrow><annotation encoding="application/x-tex">\bm{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span></span></span></span> a constant. We can calculate the derivative by plucking it out of the taylor series: </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi mathvariant="normal">Œî</mi><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Œî</mi><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">Œî</mi><msup><mi mathvariant="bold-italic">x</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
f(\bm{x}+ \Delta \bm{x}) = f(\bm{x}) + Df(\bm{x})\Delta \bm{x} + O(\Delta \bm{x}^2).
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Œî</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mord">Œî</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">Œî</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<p>We collect terms, and the coefficient of the first-order term is the derivative. We can do this for our function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> : </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi mathvariant="normal">Œî</mi><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi mathvariant="normal">Œî</mi><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>‚àí</mo><mi mathvariant="bold-italic">b</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="bold-italic">x</mi><mo>‚àí</mo><mi mathvariant="bold-italic">b</mi><mo>+</mo><mi mathvariant="normal">Œî</mi><mi mathvariant="bold-italic">x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>I</mi><mi mathvariant="normal">Œî</mi><mi mathvariant="bold-italic">x</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
f(\bm{x}+\Delta \bm{x}) &amp;= (\bm{x} + \Delta \bm{x}) - \bm{b}\\
&amp;= \bm{x} - \bm{b} + \Delta \bm{x} \\
&amp;= f(\bm{x}) + I\Delta \bm{x} \\
\end{align*}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Œî</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Œî</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Œî</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord">Œî</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>Thus, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">Df(\bm{x}) = I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span> the identity matrix. So, If we want to calculate <code>Jt_subtract_const</code> we need to figure out what <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mi>I</mi></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span> is, which is simply <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span></span></span></span>. Thus,</p>
<pre><code class="python hljs"><span class="hljs-keyword">def</span> <span class="hljs-title function_">Jt_subtract_const</span>(<span class="hljs-params">x, gt</span>):
    <span class="hljs-string">&quot;&quot;&quot;x: ndarray shape(n,)
       gt: ndarray shape(1,n)&quot;&quot;&quot;</span>
    <span class="hljs-keyword">return</span> gt</code></pre>
<p>Let&#39;s do a harder one.</p>
<h2 id="implementing_jt_square"><a href="#implementing_jt_square" class="header-anchor">Implementing <code>Jt_square</code></a></h2>
<p>Now <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><msup><mi mathvariant="bold-italic">x</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">f(\bm{x}) := \bm{x}^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> element-wise. Remember, to find the derivative, we take </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi mathvariant="normal">Œî</mi><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi mathvariant="normal">Œî</mi><mi mathvariant="bold-italic">x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi mathvariant="normal">Œî</mi><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>‚äô</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi mathvariant="normal">Œî</mi><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi mathvariant="bold-italic">x</mi><mn>2</mn></msup><mo>+</mo><mn>2</mn><mi mathvariant="bold-italic">x</mi><mo>‚äô</mo><mi mathvariant="normal">Œî</mi><mi mathvariant="bold-italic">x</mi><mo>+</mo><mo stretchy="false">(</mo><mi mathvariant="normal">Œî</mi><mi mathvariant="bold-italic">x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>+</mo><mn>2</mn><mi mathvariant="bold-italic">x</mi><mo>‚äô</mo><mi mathvariant="normal">Œî</mi><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi mathvariant="normal">Œî</mi><mi mathvariant="bold-italic">x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
f(\bm{x} + \Delta\bm{x})
&amp;=(\bm{x} + \Delta\bm{x})^{2}\\
&amp;=(\bm{x} + \Delta\bm{x})\odot(\bm{x} + \Delta\bm{x})\\
&amp;=\bm{x}^{2}+2\bm{x} \odot \Delta\bm{x} + (\Delta\bm{x})^{2}\\
&amp;=f(\bm{x})+2\bm{x} \odot\Delta\bm{x} + O((\Delta\bm{x})^{2}).\\
\end{align*}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.0723em;vertical-align:-2.7862em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2862em;"><span style="top:-5.4221em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Œî</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-3.9221em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.3979em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.8738em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.7862em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2862em;"><span style="top:-5.4221em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Œî</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.9221em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Œî</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚äô</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Œî</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-2.3979em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚äô</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Œî</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord">Œî</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-0.8738em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚äô</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Œî</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">((</span><span class="mord">Œî</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.7862em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>With <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚äô</mo></mrow><annotation encoding="application/x-tex">\odot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">‚äô</span></span></span></span> as element-wise product. Thus, </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">‚Ä¶</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">‚ã±</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">‚ã±</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>2</mn><msub><mi>x</mi><mi>n</mi></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">
Df(\bm{x}) =
\begin{bmatrix}
2x_{1}&amp; 0 &amp; \dots&amp; 0 \\
0&amp; \ddots &amp; &amp; \\
&amp; &amp; \ddots &amp; 0\\
&amp; &amp; 0&amp; 2x_{n}\\
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.8001em;vertical-align:-2.15em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚é£</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚é°</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">‚ã±</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">‚Ä¶</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">‚ã±</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚é¶</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚é§</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>Since this matrix does the same thing as multiplying element-wise by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi mathvariant="bold-italic">x</mi></mrow><annotation encoding="application/x-tex">2\bm{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span> . Multiplying this with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span></span></span></span> gives <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub><msub><mi>g</mi><mn>1</mn></msub><mo>‚Ä¶</mo><mn>2</mn><msub><mi>x</mi><mi>n</mi></msub><msub><mi>g</mi><mi>n</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[2x_{1}g_{1} \dots 2x_{n}g_{n}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">‚Ä¶</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>. So,</p>
<pre><code class="python hljs"><span class="hljs-keyword">def</span> <span class="hljs-title function_">Jt_square</span>(<span class="hljs-params">x, gt</span>):
    <span class="hljs-string">&quot;&quot;&quot;x: ndarray shape(n,)
       gt: ndarray shape(1,n)&quot;&quot;&quot;</span>
    <span class="hljs-keyword">return</span> gt * (<span class="hljs-number">2</span> * x.reshape(<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>))</code></pre>
<h2 id="implementing_jt_arctan"><a href="#implementing_jt_arctan" class="header-anchor">Implementing <code>Jt_arctan</code></a></h2>
<p>Now <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><mi>arctan</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(\bm{x}) := \arctan(\bm{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">arctan</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span> element-wise. This one is much trickier. There&#39;s probably a way to do this using the Taylor series, but there is an easier way in this scenario. To understand it, let&#39;s name the components of the output: </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>f</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">‚Ä¶</mo></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>f</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mo>=</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>arctan</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">‚Ä¶</mo></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>arctan</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">f(\bm{x})=\begin{pmatrix}
f_{1}(\bm{x})\\ \\
\dots\\
f_{n}(\bm{x})
\end{pmatrix}=\begin{pmatrix}
\arctan(x_{1})\\ \\
\dots\\
\arctan(x_{n})
\end{pmatrix}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.8001em;vertical-align:-2.15em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚éù</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.875em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='1.216em' style='width:0.875em' viewBox='0 0 875 1216' preserveAspectRatio='xMinYMin'><path d='M291 0 H417 V1216 H291z M291 0 H417 V1216 H291z'/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚éõ</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">‚Ä¶</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚é†</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.875em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='1.216em' style='width:0.875em' viewBox='0 0 875 1216' preserveAspectRatio='xMinYMin'><path d='M457 0 H583 V1216 H457z M457 0 H583 V1216 H457z'/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚éû</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.8001em;vertical-align:-2.15em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚éù</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.875em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='1.216em' style='width:0.875em' viewBox='0 0 875 1216' preserveAspectRatio='xMinYMin'><path d='M291 0 H417 V1216 H291z M291 0 H417 V1216 H291z'/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚éõ</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">arctan</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">‚Ä¶</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">arctan</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚é†</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.875em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='1.216em' style='width:0.875em' viewBox='0 0 875 1216' preserveAspectRatio='xMinYMin'><path d='M457 0 H583 V1216 H457z M457 0 H583 V1216 H457z'/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚éû</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">.</span></span></span></span></span>
<p>When we first learn multivariable calculus, you&#39;re probably taught that the definition of the Jacobian is the matrix of partial derivatives, i.e. </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="normal">‚àÇ</mi><mn>1</mn></msub><msub><mi>f</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="normal">‚àÇ</mi><mn>2</mn></msub><msub><mi>f</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">‚Ä¶</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="normal">‚àÇ</mi><mi>n</mi></msub><msub><mi>f</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="normal">‚àÇ</mi><mn>1</mn></msub><msub><mi>f</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">‚ã±</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">‚Ä¶</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">‚ã±</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="normal">‚àÇ</mi><mi>n</mi></msub><msub><mi>f</mi><mrow><mi>n</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="normal">‚àÇ</mi><mrow><mi>n</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><msub><mi>f</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="normal">‚àÇ</mi><mi>n</mi></msub><msub><mi>f</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
Df(\bm{x}) = \begin{bmatrix}
\partial_{1}f_{1}(\bm{x})&amp; \partial_{2}f_{1}(\bm{x}) &amp; \dots&amp; \partial_{n}f_{1}(\bm{x}) \\
\partial_{1}f_{2}(\bm{x})&amp; \ddots &amp; &amp; \\
\dots&amp; &amp; \ddots &amp; \partial_{n}f_{n-1}(\bm{x})\\
&amp; &amp; \partial_{n-1}f_{n}(\bm{x})&amp; \partial_{n}f_{n}(\bm{x})\\
\end{bmatrix}.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.8001em;vertical-align:-2.15em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚é£</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚é°</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord" style="margin-right:0.05556em;">‚àÇ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord" style="margin-right:0.05556em;">‚àÇ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">‚Ä¶</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord" style="margin-right:0.05556em;">‚àÇ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">‚ã±</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">‚Ä¶</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">‚ã±</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord" style="margin-right:0.05556em;">‚àÇ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord" style="margin-right:0.05556em;">‚àÇ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord" style="margin-right:0.05556em;">‚àÇ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord" style="margin-right:0.05556em;">‚àÇ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚é¶</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚é§</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">.</span></span></span></span></span>
<p>We&#39;re going to exploit the fact that the Jacobian happens to equal this matrix of partial derivatives since we know how to evaluate the scalar <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>arctan</mi><mo>‚Å°</mo></mrow><annotation encoding="application/x-tex">\arctan</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mop">arctan</span></span></span></span>. Because our function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> is element-wise, only the diagonal will have values on it. That&#39;s because <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">x_{m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> has no effect on <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>arctan</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_{k}(\bm{x}) = \arctan(x_{k})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">arctan</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> unless <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">k=m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> &#40;which would put it on the diagonal&#41;. This is true in general: element-wise operations yield a diagonal Jacobian. In our scenario, since <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">(</mo><mi>arctan</mi><mo>‚Å°</mo><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msup><mi>x</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D(\arctan)(x)=1/(1 + x^{2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mop">arctan</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, this gives us </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">‚Ä¶</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">‚ã±</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">‚ã±</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msubsup><mi>x</mi><mi>n</mi><mn>2</mn></msubsup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">
Df(\bm{x}) = \begin{bmatrix}
1 /(1 + x_{1}^{2})&amp; 0 &amp; \dots&amp; 0 \\
0&amp; \ddots &amp; &amp; \\
&amp; &amp; \ddots &amp; 0\\
&amp; &amp; 0&amp; 1 / (1 + x_{n}^{2})\\
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.8001em;vertical-align:-2.15em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚é£</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚é°</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">‚ã±</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">‚Ä¶</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">‚ã±</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚é¶</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>‚é§</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>Putting it into code we get:</p>
<pre><code class="python hljs"><span class="hljs-keyword">def</span> <span class="hljs-title function_">Jt_arctan</span>(<span class="hljs-params">x, gt</span>):
    <span class="hljs-string">&quot;&quot;&quot;x: ndarray shape(n,)
       gt: ndarray shape(1,n)&quot;&quot;&quot;</span>
    <span class="hljs-keyword">return</span> gt * (<span class="hljs-number">1</span>/(<span class="hljs-number">1</span> + x**<span class="hljs-number">2</span>)).reshape(<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>)</code></pre>
<h1 id="what_is_going_on_bringing_back_rigor"><a href="#what_is_going_on_bringing_back_rigor" class="header-anchor">What is going on &#40;bringing back rigor&#41;</a></h1>
<p>You might be thinking: I&#39;m familiar with multivariable calculus, I love a good dual space, but this all feels unjustified. To fix that, we&#39;ll look again at what a derivative really is. Given a function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>:</mo><mi>V</mi><mo>‚Üí</mo><mi>W</mi></mrow><annotation encoding="application/x-tex">f:V\to W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚Üí</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span> between vector spaces, the derivative is <em>the</em> linear map that takes incremental inputs of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> and will output incremental changes in the value of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>. It is often represented as a matrix, but to clarify the types, we&#39;ll pretend it&#39;s just a linear function. That is, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>f</mi><mo>:</mo><mi>V</mi><mo>‚Üí</mo><mo stretchy="false">(</mo><mi>V</mi><mo>‚Üí</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Df: V \to (V \to W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚Üí</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚Üí</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span>, and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>:</mo><mi>V</mi><mo>‚Üí</mo><mi>W</mi></mrow><annotation encoding="application/x-tex">Df(\bm{x}): V\to W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚Üí</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span>. That is, we&#39;re currying the function when we evaluate it at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">x</mi></mrow><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span>.  It has a nice property that </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">h</mi><mo stretchy="false">)</mo><mo>‚âà</mo><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi mathvariant="bold-italic">h</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
f(\bm{x}) + Df(\bm{x})(\bm{h})\approx f(\bm{x}+\bm{h}).
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚âà</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<p>We&#39;re using slightly different notation since we&#39;re treating <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Df(\bm{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span> as a function, but remember, the application of it as a function is just left multiplication with the matrix. With our new understanding that the derivative is a linear map &#40;and it just happens to be a matrix&#41;. Let&#39;s look again at this figure</p>
<div class="im-800"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAByYAAALuCAQAAABBK7lWAABG1klEQVR42u39PY9jXfwuZN4LnmgkJPb/BJMgceQmICE4uD&#43;CC1IS90dwpUS4JFICV3RiOyNDVTlJOZ6ozEikM&#43;0ZAiQIaBMiIbQI7HK92S7vemmX7euy9LRftvderu6ntu&#43;91vqtUgMAAADt/DuHbgAAAADHR5gEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEk4OqUpd6X3CfsZl8GhPwsAAMfqn0M3AL5KadJNkszqYv1MU&#43;eHbtcnfK67TOr0E3Z1lbuSOjn0JwIA4BgJk2evjDY&#43;Pf2UsHK4T9XLML3MskjSK9Nc12mSYbq5OHTbPvjJmtxl9hgAyyCdl9vUq1fvGT57Yr58f12UX7kXJwEAeA9hku7qv83q8TKAHXX/XRlknNv8eOiFLIOMy20mGeaoI3KSZJzUyyePu&#43;nkoQ82mWe&#43;4e&#43;uSTedVehcZPb4Qp2XX7krszoLAAC0UuqhW8C3UJr8SZJcv&#43;zVOj5lkHEmzwLXsj&#43;vkybTetQ9k2WYUS5e9xqX&#43;3ST3NZfW9/Z5HeaTX&#43;/5Sbd/HwYCgwAAPtRgIckyfeNEmW0ZSDutu2bjLLIi8hUF8c&#43;vHX12YZbZksueyN3/y02udx4qeAqnRfDYAEA4E3CJKdmkCa3r8NxfRUwj9AwTa43vrIMk52d773dPDeyzjPJsOx6LwAAvCJM8t11W27fy5YeujrJt&#43;1/3UdpMsh0SzXaN8Jk6WaQy22vZpLomwQAoB1hkm&#43;tNGm7nuKu8Hnc5XcGaXK75bW3eibHud4&#43;lLnOMk&#43;/NAEAgL0Jk3xv/dbvWOx413HXLO0nb4TJlI1RugyzqNfZ5TbNO37WAACcMWGSb6w0aVV8J8kyMHbKcMtrRzvQtXTSzWxb7&#43;J68Guz8Z3DN&#43;eLTpPWfcAAwNEpTbkrX3bOL&#43;MyOPQn5G&#43;yziQ7lOXahE26mS5riJZ&#43;uknmz&#43;fuvdyudNJLJ3l415MtH1ZE7GX&#43;WA5m9Sutk87TaqOll1HaD72cpp9kVPK6L65OHwe67t/m1fbdPHz22aYCP0/2O0gnTRaZ5XbTDMcySCfdJLNtx9qon93DdOfpJOlu2GacyZvrSM4iTALwTHlYoXhej3r16Xd&#43;&#43;odvLOsLuaVJc/w/idLkbktl&#43;M9xlbuSzSX/OEXCJLuMnwSMaelnmGmm6WaYcXm6YuHvx7eUecZpMk3S5K7Mc/3sF8rNeo/TrJ4voyfFX1b7LN3crGcADtf9jPusEnmbYTpJRmWQ28wy2/KLf/82pzQZp8ltbjNPL6OMyvWmYaOlyTj9TLMs9dPLXbl9vhhH6WeU5DqTNOnnrkzza89lWZZBdrv5Khy/bFM/nbd/anVR5umU7puhE4AzUDoZpJ8ms8zSTbckt7k&#43;/iC19&#43;fvZZjeajxTr0xzXadJhuke&#43;0JjpcldZk&#43;/5ZThq&#43;8O68v9G16b1fWEm1UHw6PrukjqovzKvTh5RqqbW2rqwz&#43;F0YtnmwyXz2eQcZrVs538Sc3g2Xaj1NTc5Hf662e7&#43;ZOa8cY93j17tpffqakbWzVq&#43;Um6L574nXEGD21/V5tvnj5Ok/uXWzx559OfSid/nrY&#43;g9TcP7bk5eOdn&#43;p3ano7Xh8vP8urz/hn17uebHn3vO1ubm5ubud5W50dfz87n/WXZ779zljHfssgNTfpPHn8O6N08uK7yzHecpP7F8&#43;Mc7f8DpaamvvcZfhk66ev3eXu2b&#43;KUe7WD37n5sn3m15quof&#43;rG5/53bwBrh9l9vqj9GWV0Yvwt9N6qtfR8s/nv3yWAW78YYtX/xCXga7zcdu/Vl6&#43;fPqyT&#43;PgbFdm1eP757tv&#43;ZFtEuT388/aTrLOy/e9fxYd/t&#43;vtTUXSfxVTB&#43;/VMd77P31ftb/6Td3Nzc3E7rlu622Jhxan6ffkTIIK&#43;/tzS5z58cfZjMMBsvTKdZ3dn0Tam3urPx0nS6qZsuW&#43;cmv8/j0oObAjzsZ5jnwzrn2bwIx/XzgZJ1lkmSwddN9N6kTvMj1y8GhTa52TIl/K02L4d49J7t/3XN2FE6ybOf0suFOsZJpi8Gkt4mGby9KEfpJMnOAbHLT/vs76T0Mniz9M5TnRbbAnBySjd36ea2Xr4&#43;49TLTNLJXWm7/vPzI4xK&#43;9J6f/F4pckoi5fnzro49uGtq8823Dxbcv23vel7xup7y5ZZlvMkFxteu0rHCtbnQZhkP4t3T9Vexqu/eupI6qJe1R/5kctMnoTK8Z6h9nmb51nk5bIiszyLXqXJIHkxP3OW6Xpfy7I7rxcnWc7TfPvE/HbMWx75eSwd52rPGZnZ8G4AzkppcpMmi1xu2eAq8zS5O&#43;l1iQdpNpXZq4tWF2e/p2GaXLd907r80OZvUMOXl&#43;RX75pnkmFxkfoMCJPs592FWep82Yt5iF8odV4n9bL&#43;yI/1L89x&#43;zbXeX7kov7c&#43;ZZlL&#43;WzwF0X9aKWdQGe3ust1kt6fEa/7epv6PGKcRk9rZj7prMpqwDAFuN0ku2XIesi10ma/c6lW3yoX/MvHK&#43;Xzf1zqZPjXV4sWV32nm4tojTb8b7t&#43;&#43;ykvzWeThJ9k&#43;dANVe&#43;3rLOaC8Hq&#43;tV57kqt7lP0in9xzpk&#43;7a5LpYhsHTTTSfNammPp/btW&#43;x/1YDfuijLO6tf&#43;qWTQX622IEwCXDWSi/9JIvsOEvWSRmmk37pvW&#43;8UmnSe//l6b9yvF3n8&#43;lRj&#43;AZpNnxd7sMyr0NC4ztCoSjZQXXTeqszNMv7UZIcYT0TPL1ljHlL/VMli2/9Opsde1sv2uUL9pcmjIqv3Ofbua5rRevTk1vf7ruar/TF7eLXHxSzF626SGsjjNpVcT9mE&#43;QAHzcsq7A7Rtf/pdx5L09Tv13vu&#43;92h9vseNdx718Vj/JPpfTnymd9FcB89U3ndJLs3ME1G2av/43zl&#43;nZ5JTM9o64OI6w7wr1Jb&#43;ap3Jnx&#43;&#43;vjb7wmWCn7StDNLUdrM7/vbAIwC&#43;kdJZfe1/KzCtLlyWTvtVJ0vzdysovOt4s3TSKcNNq0lndrznytJJN7Md32K2/W2Oc7m6dPD6&#43;9No6&#43;zapWmGhxyXxt8hTPL1lr9&#43;PuF6Xhlkj0VwS7duPFZdlGl6e/bAPWlz6ecmyaTu&#43;pU5e3Pe4/RDMyP3CbHLNnRXp89fHzgaAOfm4Rz1VkR8OMOu5sqVhyJyvafz9FdTOjrpPF7YLL2Mtp2DSyedLAvSTes0KZ300kmWj55t&#43;SnH22GafpJRyes4WaePg0D3b/H6Hd30000yz2xX/2/pZJBOmiwyy&#43;3ryF4Gq8k2s&#43;3H2qCfZNfWi9VP8Pmxekmdbh7zVQaZ1d3f7Wb5nKoQfGvCJF9v&#43;Wv/MwaH7Ner2N15rP3a8bTN4yTzbVFy&#43;Yt2Yy3Vl8ft7f0JXqmz0mbz8ebS32867gE8ALzfqs/trbNHnZdn2&#43;dmHRemD31QZfRkGOxVkpRubtZnwOE6nEzrw4Ibvx&#43;PUOYZp1lVO78r81w/u4z8Ocfb7jbDdJKMyiC3mb2o0/5o/xYnKc1qhNNt5ulllFG53tT3WZqM0880y2I/vdyV26fjjEo/oyTXmaRJP3dlml97jplaxti3vPweM85FNl4wL02Gb1VmqIsyT2fbJX5OxqEXunT7LrfVH6Mtr7xYpjej1NQN2716f7qpqbl59tz9hj3evN7jy31mtKl9r96xdUnh/M6LBXnfbnP6m7Z5/ATLNqXJn9T83nDMfgY1Nemk5tUyyKsthnv8/fzJlgWDn&#43;xneaeXP&#43;0XCs5N6j7tcHNzc3M7xVvulnf22HL5x/36cZNhal6cfdPL79f7S03dfCZPs/xmkZv8fjxTp5s/eXHu/Jzj7fh83RdP/M44g9fn1f1bXJObp8&#43;kyX02fCNYvXfw5JlO/jz5FjRIzf1jS14&#43;3vmpfmfnt4jVZ3n&#43;Mx0uj73xtT2&#43;ka3&#43;VQ32aZ/b8d4U4OFzve6bW14PfH79bdNVtH0GQjR79Z31ymDT06WTTuYbarnubvOG&#43;RHl1cqQdZFJkk7pb9jXPEnqPNdJ&#43;htKbI/2&#43;lSzvFUk5&#43;GnOs7lO&#43;Z2NtEzCXC&#43;9h85szxXrM&#43;DdbGpj61O2xV7qYtVD1w/vx7P1HWWiySDMn625Sccb0dLZrl49j2lk0HG&#43;f3yDL9/i0s3/QzK3eM7c5Vk8Ly&#43;&#43;2qVz8mTwbud/E7z0OtaehknT8/wdZJpunsWQ9q01vVTr4rslCaDbVUoSif9vSozvFiVm1MkTPK5BuVZzCr99JNcvhji8CoYleHyJPBqNcpZnsa5fQt8j8qmKfKjZOOSw7vbvDxBPI9xw9VglqVlWLzKNMmovPxci/WQoevMXq/OVYZ7FuV5/pPYtkWSzPZa/OSl3tuDmwA4Wft/5f/acHD9/BtDnWWSV8Hra9VpfuT6xaDQJjebL1Xv0eLlN4PesyO8rho7SifPL74//0mPk0xffJ&#43;6TTIob84MXa2b/faF5qdHHK6X/Xg9PHac/Yv8CZMnTpg8e6VXeqVXHuqd9Uq/9Epv&#43;WundMtDL1&#43;39JfPlk7pld7yV2IZld6LX&#43;/XuXmMZqW/uor2smjOJIt0n2w3SO&#43;h2PiLPV4n6S23LP3M96wdN8ldeRnrxulnsjFm7Wzz&#43;qSw/pVfBmlymaRbuqVZtzz5ldt0cvcYiMsw/cdCOHWRi8zSL&#43;PHlpVR&#43;m/UQnswzRthcvUrf9HiF/zjT6eb3RPzATht&#43;49N&#43;dtLSS3j1V&#43;tA1sX9ar&#43;yI9cZvIkSo33jLQvWzzPIi9/wi/67EqTQfJihuYs04e9lcHGvsXlpe1917puoXTSW397W7bp8ZtSL2lx2drSYydOAR7unj3q5iZJcp2rJKP1dbQmN6tnB08GVAwzTPK8NsxFxmWReZJuepnk&#43;nUArPNykVHuym0WSTqZ59fql9Qgg6d7rLflMqPclUmadPP2xPkkua5X5Taj/Cm3mWeeRbrpp5PrrUMydra5XpZF&#43;rkpD9Php/UyKZcZ5z6LrJfjrYv8KoMM87vcZp6kn2kunl4HrIv8XG&#43;xyDKIXuw3JLVOy2KvirHX7Yu1Z3m9VJgEOF&#43;rc1Fp9pwo8dfOGXVe5umk&#43;57FSD565GWJn9JZf/cZ50f7Ftd5&#43;ZHuG6N/lpesn21TF0&#43;&#43;9/Rev74uh9T7hL&#43;NlzH1dd9j8&#43;S1/b6P7VPyh6MnTJ69uqNM6KaqZ/Vqd89XneeidNJLk&#43;vtNcbqLBelk056mWVS50mZr341vVgFqU4yKb2HCLeH21yv9/9QPjuZbCqvvW&#43;b61WuSjeddDN9GPRRJ&#43;X29amhTjJ5ueXWLW4fg&#43;ien2xQ&#43;juvBc6ycSbJHt61lDEAJ&#43;OhYmd3dzBZj&#43;T5mzFhnk5yuBUL6zxX5Tb3STpvnIe3tLgulj/V0k03nTTrbyeP3updXPYt9r9quG9dLL8Oll6dJqX/ZJLOi0oXZbjrG9WrnwMnT5jkCzxcy3tzq/njKavOt//Kebqy05t7fRxWOm8z4POtNtdZZs/j1sOp4e0t22&#43;x0SSDJ4NqN&#43;33HQNck9VSxvufGgA4PQ89U2&#43;EyfWAyb9Zsm3&#43;7Mhfqgw3X5Sts3KdYZLuXufvVy0uTYbpp5NJZpnXabl7MdrorU/XXe1300DXzz9/D5&#43;uVv2wPFnp1HlpMnhrSZAnDHE9A8IkHIk6K9P0S7vezP0MkkNd7wXgO6i3ZZEmb/eQLV9fnOxoltG2CqZZhsl3RdrSX60z&#43;fOD5/D9Sva9z&#43;Ih&#43;pVRphsvMHcyzzCTFp/h7dmcHD0FeOB4XD2WCP88pckgU5VcAc7c8qLiW8Mol3P7bj/jwmYZbKmP&#43;tIywH24L3S/45UtAWg1Hmm/vrZnLS791aIfv3b81N76dB87S&#43;/zt7Va8qU06e1cEuR902k4WcIkHI06y/U&#43;JcBbGiZ7VpQF4HRdZ5Gk2RW4Sj&#43;dJIt8TqDo7NnPt4x3Hx9Yu9/x9luGq02Lx0nm2yo/rKrYL3sCt5/hZ6tP8C61Ta3e0Ya&#43;x9nqtfE7vi9Yw/rECZN8kvIwcf&#43;IHGGbr7N4uVLlB38GnQzfWQEWgBNSH5aW2jUCZvna67PGpsDwSXMcSzdN8mJm/xce78Xqjy&#43;PsEc0et7i0l8&#43;erHRY2xcLrd2u6oY/3pv/fI4GaW78fV9xiwt1t96duukUyeb3p1k&#43;Kwszz462a9XlCMmTPIJSi11tcRIr9RSy19dDep82rxcfiS9PYcF7ecmE0NWAFjWG0/S2XZGLMN0k41njU2B4e3o0myIZq/75lYB9ouOt2E/m8&#43;ypZNO5htqub7V4k0B8NXakHWx&#43;tn3N&#43;xtntR5rpP0N4xOGu31qWZ5a4juci/9HcULu61Xsm6iZ/LkCZN8hosXt2Mo5nKMbU5SZ/mVUfmk3tQyTvZccgWAk1cvM0ky3BSnyiCjJJONZ41XUaUMl31xpfNqu8czWG9D0Bg8P8OVfvpJLl8M1Py8422y&#43;Sw7SjaGqbdavIyfz4Pc8Nn8y&#43;VqlFeZJhmVl5/roTfwOrM0L0cnleGeRXme/yS2m2wcErsM7&#43;3HMfUSNRlOXnVzczuyW7r5nc4n7GeUcZpDfxo3Nzc3t&#43;90yzA1NaPn54eMls9ueU8nf1LTXT8e5C691NSM00tv/Xw/9WG79HP3Yi/L4/5&#43;sp9&#43;/qRm8DXH2/hJlm348&#43;rzj1Mz3rL1Gy3OODU1/SetHaezbFma3D8cKU1uUnP/eIbP8PHVmjS5T3165s7o6es7P1cvdffnzyg1fzbvbddrO/bYfeuYbqdwszQIHJ06KxefMgfhtsWUfADOQr0utxlmmH65XdUQ7WaQTm5zta1nqs7LRUa5K8uZf53M82vVDzbIIElZbXdbLjPKXZmkSTcXG3d2kXFZZJ6km14mm/rDPvV4L13Xq3KbUf6U28wzzyLd9NPJ9dbVnN9ocb0si/RzUyareZHTepmUy4xzn0XWS37VRX6VQYb5XW4zT9LPNBePxXDqIj/Xry/SpJfbp6/v/FudlsUbA4Hnyc5lP9ovTdbLR6vQcgRKPXQLAAD4VkonvXRXRW3mmb8ogLPtPZ30MsuszlePkmT2MoSUXnqZvZ59WGqyjGylk16azF6/9zOPt3GfN7lcvr90MkhnNRR1uvnzt2lx6aaTbqaPW5Qm3U2DQF9v2e71LccfZ5Bf238KpZth/bXltX76217bccT7dPNDib9TJ0wCAHBwj9HsWBxTi0s391tmvH7N8Tr5ndv2EZRjowAPAACctDrLdGM12K/yuKAJJ02YBACAU3eVJvusSfkJSpNBpiq5ngNhEgAATlyd5TqDv9Q3OUxi6bGzIEwCAHBgZVlr9JPWUdbija6zeLlS5VconQzfsSolR0kBHgAADujV19FvX9Tm&#43;Fq8anc3d7mqXzyXsdxn9vdK/XBY1pkEAOCQXq4A&#43;f37tI6vxUmSOiu/clNmX7nOdBknouT50DMJAABnonRzk4uvGoRaRmly1WYFTI6bMAkAAGejdLL4qrhXul/Z68n3I0wCAADQmmquAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTbypNuSn3ZXDodgAAAHwfpR66Bd9eGWcZJC/q9NBtAQAA&#43;B6EyTeUXu5Wd2f156FbAwAA8D0Y5rpT6eRm/aBbxoduDwAAwPcgTO5QmtykefLEoAwP3SYAAIDvQJjcqjS5SffFkyOFeAAAAMyZ3Ko0uXsVJZcu6&#43;TQrQMAADgsPZMblc6GKPl/rv4cl9Gh2wcAAHBYwuQGZZj7dZScrZ/&#43;/2axujcsd6XbercAAAAnQ5h8oQxLzWhddmeSi/VL/3Mu1nGyl/tyL1ACAE&#43;VpnQO3QaAv0WYfKY0eTqEdVIv6&#43;LxYZ3l4klPZTeK8QAAa2WUP/mtWB9wLoTJ5x6vJs7zq16&#43;fLnOcpHH8jvNfjsFAE5f6Wa5hNio&#43;IYAnAVh8pk6y2XmmeU6P&#43;vtxi0W9TIXuc08t7k6dHsBgG9jvPqzWd8DOGmWBnnT&#43;kc0rRcf2hEAcLLK&#43;Nn0l&#43;vqkjNw8vRMAgB8UBm9qKQwNHMSOH3CJADAh5TBarbkU&#43;PSP3S7AL6WMAkA8AFltGWO5I3eSeC0CZMAAO9UmjJe90r&#43;H69eHpdRu/0BHBNhEgDgHUpTBrlfz5Vc5L9bv/Rv87BO9bD8Ln1LhQCnSZgEAGitdPI74/UK1bNc5H9dv/jf52IdJzu5yb04CZwiYRIAoL1BHgPiLBd19vTFOstF5uuHnSjGA5wgYRIAoL2H8LjIVf1ZFy9frrP8zPX64Xzf3QIcj38O3QAAgONTb8tlOllk8jpIrrZY5KpMMkgyrdNDtxfg8wmTAADvUCd7bDPP1aHbCfBVDHMFAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJiFJUgZldOg2AADA8RAmYamf4aGbAAAAx0OYBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgtX8O3QD4JmaHbgAAABwTYRKSJPXq0C0AAIBjYpgrAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZOQJCnd0jt0GwAA4HgIk7A0yt2hmwAAAMdDmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNb&#43;OXQD4Ju4SnPoJgAAwPEQJiFJUmeHbgEAABwTw1wBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmIQkSRmVu0O3AQAAjocwCUvd9A7dBAAAOB7CJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArf1z6AbANzE7dAMAAOCYCJOQJKlXh24BAAAcE8NcAQAAaE2YBABgq9KUu9J797vHZfB3jtTuWMBnMMwVAOBslW6aLOrWygGlyV0mdfruA1zlrqRO9mjJR4/U4ljA5xAm4YyUUbrrB039eej2ANBO6WRX39siszZhrHRzk3lm6ZbkV11s2KLJXWYfiWd1UX7l/u2It&#43;1Ibc5c&#43;x4L&#43;CzCJJyN0mT45KH6tQDHp7OKVsvBoPPMn73aS8oik1xvCoYvlU7uMqsXpcko/QxyvWGjcVIvP9bkOi&#43;/cldmdfd5Z&#43;OR2p659jwW8EmESTgbdVF&#43;pJOHa7wfGUgEwEHU6fK3d6lJkl8vQ1MZZJRheuVyjzg1TpNpklEGSTqvNyjD9HPxGa0ut7kpP7dH3G1Han/mevtYwOdRgAfOSJ3X6frrgqu2AEeqLH&#43;Tb5jpWCf5kVm6uSvNG/voppdlPFtueftqiybDD85hfHSVzrM&#43;xr2P9I4z185jAZ9JmISzUrp5&#43;HqhZxLgWC0HuW4OX4tcJmkyfmMf/SSpsyRXuc7Fhig3TLNx6Os71HkmGZbOlpd3HqntmeuNYwGfSJiE8/JQcn1mABDA0VoO&#43;tzST1dnuU3SL9039zFNkjqvV6&#43;jZGkyyLTO81kmyeb&#43;wjeP1P7MtfVYwOcSJiFJUrofWdnqiDx8tdAvCXC8dvRMPnmlv3Mf3eweNjpI83ro6/vVWebpbxx8&#43;9aRWp&#43;5dhwL&#43;FTCJCyNcnfoJvwV6&#43;u7h24IAO9TOukku9aGXNV47e3cR7PebrN&#43;8plhMsltmo0B960jvefMte1YwKcSJuGMmDEJcALe6pd80H3zta1hsnTS/fQJEdNsCLhvHemdZ66NxwI&#43;m6VB4Jw8mXdSOumnlyaLJLNMPnFeDABfaeeMyTb72FGptZ&#43;d4a0M0kuTJovHM0gZrs4q07q5mM4smwLeG0d655lr87GAT6ZnEs7Jet5JGeV3Bplnmnl6GeZ3GRy6cQDsZd&#43;eyQ1Kr9RSS12Wp1neX61Z&#43;Vw3W/stS7fcZ5xOZpmmk2F&#43;l1Fpyn1GmS/XrSz3m95XF5mneVUWaMeR1q8nLc9cW44FfDI9k3BOHq7S9tPJ1cOV45IMkozLZ1btA&#43;BL7DFjckefXJ2mJEn5nU5u66&#43;te9ga8Uo3d8nDUiJlkt9JhhmkyUWdliY3SbpluLF3cp5Oui/6VN8Kk&#43;89c206FvDJ9EzC2Xgy76TJzyen&#43;YeZKkoVAHx/&#43;/RLLtdYnL2xxfyN1ze8vzS5S/LzYYDsOso1mdRpkvGqfZsrqc7WbXvzSKvjvf/MtelYwCfTMwnn4/FK9dXGK9qKqAN8f/vMmHxjm/JGIC2dJNlYFGeUJr8eewOfLL8xSfIY7rYH1WcBb8eRlj525hIm4YvpmYTz8TB35LZONj7/uVX7APgKb/ZMrgbC7trmrUC6PYQNMq9Pl/F4CHvzVdRb9h1OX5xnnnoe/96Kex87c7lICl9MzyScj4dT/svVvFovBw3AYew1Y3LZO7io29du7CSZv2vhj6sNMx6T9RmkXpXpjta1n5n//jOXKgDwFwiTcCa2rdRVeqvnd381AeA72GfG5LLG6WTHFm8VvdnqVVmd9cId6y12ta3lMT905hIm4S8wzBXOxZOVujY&#43;f9tqbwAcwpszJktv2XeZ6zf28gkXEEvTcmxL22GnHzlzGeIKf4GeSUiS1ItDt&#43;DLbTvh97c8D8D383bP5DBJcr19EGvZp4RPm9Yk8z2Xlmq77uNHzlzWmIS/QM8knItXQ5GS9RXs3XNrAPgW3p4xWfrpJbmtb/VL7g6T&#43;86m/Pic&#43;91HcuaCb06YhLOwbd7J&#43;urubZKUpvwpN4duKwBbvLWkR5Nxklkud&#43;5lGUh39CXuCqvlvvwug2fteRn2bkrdcfRn2&#43;6arf8JZy61AOCLCZNwHjbOOynN&#43;pT8sD5Y49QL8G3t7FMsTe7SZJaLN&#43;q07jNjcrFejfLpETq5STedjFbHe&#43;iZnD3bpr&#43;1&#43;M1yNuceR0ry0TPXpmMBn0yYhPOweSjSw1Xf2era8DCLnfX/ADikHT2TpZu7dPeIksu9vBUmZ9lUwuahR3J5hIdQ97x/cZRs7RltNhx585GSj565Nh0L&#43;GTCJJyHh&#43;u7mwdHTZOkjNLZVbIBgEPaPmOyNGWU&#43;3RzXX&#43;&#43;9Vu8LOcbvlUwZ5ZdJWyuktKsSv083/s4/VxvXR6kt2HpkO1H&#43;tiZq/fGMiXAJ1DNFc7Dw4pcz06sdVpmy1N4aTLMMJOdJRsAOIjVMNBleJu/GBTaSTeDJJNc71VTdb9artMMN0S8SQZpclVvSzfjdHKZQbpJGecqST&#43;DdHNdr7Z8im42BcPNR0o&#43;dObacizgs1W3N27rO3eHbomb2/tvuU9NzeDV803uVnf/ZHjoVrq5ubkd8y2j9d3ep&#43;53uPPl37nJMJ1Wrfyzx3Z/Ujc8283v9XF7NWkyzp/1y3e7PnmGqZvONJuP9LEz17Zjubm5fe5tZ7ktkjz&#43;iKZnsBIhJ6s06W5bB2w5cMpgIICPKaP1wM&#43;L7/s7tdyll9v6683txhnk16bFN0o3zfPBtqu&#43;0tnuIbblPt38eH0m2nakj5y5th0L&#43;FyGucJZqIvtw33q/M25MwCcik72GwA6ySC9bAiTr&#43;ds7hOdSyfd3G6Md1uO9P4z145jAZ9KAR4AgBNXmtIk6yI&#43;t2&#43;/o84yTb80b2&#43;5p&#43;W8zr9xpB3HAj6XMAlJknJnzDcAp6kM8id/Si/LCqmTPet2X2VjxdZ3taDJINOtPZifeKQ3jwV8ImESAOC0jZIsB7h2k&#43;xZt7vOcp3BJ/UYDrN99cnPPdIbxwI&#43;kzAJAHDamiSz3JZOBnsuILJ0nUXGHz986WT4xnE/6Uh7HQv4NMIkAMBpu848V&#43;nmJpNtq0BuUhf5lV4ZfPj4N2&#43;tY/xpR9rjWMDnUc0VTlrpJK7PApy3elWm6aXJVduZhHVWfuWmzF5XcN1fGSf1zWGnn3GkfY8FfBY9k3DCyii/87t8WlEDAI5TndarevmeojR1movclM57j1xGSfZaqfujR2pzLOBz6JmEU7aMkaPStBnWBACP6qxcZL/6r5vc7t/X&#43;MEjtToW8Bn0TMIpe7gGPSx3pXfoxgBwnOp8z8VENr23Vbz7yJHaHgv4OGESTtljf2Qvd&#43;Wu9A/dIDgvpVt6Hxm0BwDfmTAJJ6zO8jOP5Xd6uSl/ylikhL&#43;h9Mrv3GSYu3LzaevnAcA3IkzCSauz/MzkyRNNBrkptdyXDxU5AHYrg9xlXn/Ui1ynt1oyHgBOijAJS7c50VWp6qJe5sezQJkk3fR9vYWvUpqMklwlZZRxmnzG6nkA8M2o5gpJkjr5&#43;D6&#43;rzovV/nf8y/5N&#43;keui1wFoZpVsVAlqWvlAUB4ATpmYSTV7plnD/5r/Kv68/8yOMqYyfaFwvfwCAP1ZSnSeaxiDoAJ0jPJJy0Mshg3RvZK50s1o&#43;ulVCHr1G6abLqjaxXscorACdKmIQTVToZZJDnNSQHyeqZefUFF77Kcmjr/IN7AYBvTpiEE1Q6GWXTAiD/ef7D1T1DXOHrLCsl6/sH4MQJk3CaXkfJaW6TjJMk89MuOAQH1k1W5XcA4IQpwAMnqM5z&#43;&#43;ThIpP8qBd1shp8p18SvlY3eVLqCgBOlDAJp&#43;mh53Gey/yol3WelGbdX3n73t0CbylmTAJwJoRJOEl1mnkmuag/6qQuVk&#43;uo&#43;T6GeDTlH65L7XU3CVJBqWWWmq5P3S74KuVTumVzqFbARyCOZNwxEo/g6RebHqt/nj11MOp3vA7&#43;AqzTDNN0k0vySTLizZ6KDlxpZP7NEmZZZppnb54rZN5Pbn/C0rNdPO5F86NMAlJkjJI55gWyyhNhukv42Hp7lno42GFyZM7rcN3UOfLFSXLXZLUy0O3B/6S/mrJqW66GZZksa5k3KSbZFEulKOCUyVMwlI/vWNZWrz00s/gyRODtPva6qQOX6kbl2w4Jy//tTfrYm8Pj7vOO3CqzJmEI1KaMij3uXsWJZN&#43;afZ6&#43;8NMyf22Bt6hdNLEJRvOyduz8P3/ACdLzyQck98bg&#43;Btmj1O5sl1&#43;klmpzd7Bb6R5XBy/5dxNuq0PH34f&#43;XfffJokdvcGuQKp0uYhGNy&#43;6JPcp7bXO9bm7XOyr&#43;kW5Xfga&#43;0DJP&#43;P&#43;NsvBgb8&#43;9mVn&#43;WXpKFEAmnT5iEYzJ5EianmdSW60XWha&#43;48MWWVZN9ieZ8dF8&#43;LmMFqOBcmDMJR6TOMkuyyHV&#43;1Iu2URL4C7pJFtZy5Qw9/qsflMEH9gMcEWESvqHSbD0RX&#43;ey/ku9Mu8RvqPSpBP9kpyXhzWM/9sncXJcuu/bGXBcDHOFb6Z0Mkw/TZlvmt2oNxK&#43;teUXaGGSc/IQJv&#43;XXOR&#43;/exd&#43;aGHHk6fnkn4Rsqg3OV3BmmS9A/dGqC15fp6wiTn5KEPclZnz1Y97rxnZ8BxESbhWyidMip/Mn6y1POgOBHDsVnWtRQmORuleThv1WlSJ5kkSWb5cdK1XK9jnBAkMcwVvoHSy2BjP2Q/14duG9BKN0nMaeaMPMzwX03MqJelm9mpV3OtV4duAXwXwiQkSerFAQ/e3xAlZ5nUyQHbBLxHN9aY5IyUJsPV3XVPXf156FYBf49hrnB4z/sfF5nkZ/0pSsKxKWZMcm66q6HdC8M&#43;4TzpmYSDq/MyXc05mWeSifp3cKSWhUgMcuV8zLJIk&#43;TSmQvOkzAJ38FternNpBoeB8ds2Ufj/2PORl2Un&#43;llap4wnCthEv6a0k9/c2Csk&#43;JUDMevm2Tu/2XOSZ3HpAw4Y8Ik/AWlySCD1ZpbG3stfP2EE9BLzByDTUrHeQ5OkQI88MVKt4zzJ6NVlOxbPRJOU1nOmBQm4YXSlJvcl&#43;bQ7QA&#43;nzAJX6gMyn3u16twLQ3euTPgGyqjcleWiyP0ksxPeqF2eIfSzV36aXJ36JYAn0&#43;YhC9S&#43;uVPxqvqjsBJKqMM08soyXLG5PXH9genpnRytzoTdsv40K0BPpswCV9llpdDeua5zo96deiGAZ9mvRhIadLP3Pqw8FydP1l5dVBOZGxOGZ3KJ4GPEibhi9T5s7lT01zWH/VKAQI4KfMscptfSYZZ5NehmwPf0K8na6&#43;OS&#43;/QzfkUw/QP3QT4HoRJSJKUu1I/fafLMLnIJD/qhR4LOEFXmWeRfhlnkAvzJeG1usivLNYPb5Shg1MiTMKHlWbzqbHe5jaX&#43;VEv9UfCaaqL&#43;jPTJLP8ECVhszrL4wSPJjfqusLpsM4kfEjpZJBBZrnY9Go16A1OXr21HAjsVielk&#43;HqQTejXB66RcDn0DMJ71b65S6/M0yTnmE7ALBNvcp0/WBQzDiEEyFMwjuUpozK79zksZDA8AO7A4BT91iI57rqzYcTIUxCS6VXxvmTYZ73RfbNAQGAbVaFeBb5ZYksOB3mTEIrpcndhqdnUasV&#43;HZKL7O6&#43;Ph&#43;4DPUWbnMXKkqOCV6JqGVungVGye5qD/rxBc24Hspo9zlt1ETfB/1VpSE0yJMQpLS5F&#43;SPYvoPM70mOc6/1Iv63Sv9wH8Xd0kjcXVAfgqwiRnrwzKff7kP03yu/wuo7eu4tdpZklu86v&#43;qFf6I4Fva9kHNNQ3CZ9sGj2skESY5MyVptxnnO76iU6G&#43;V26SVJ6ZbTlbVf5UX&#43;pRQd8c9dZJOlk9OE9AU/UC0WEYEmY5IyVJvdPguSDJvflvym/c5dh6W16X53W&#43;Zs7BziwulgtDT8o40O3BYBTJExyzm6ybZbkf716xVwj4IjV21XJsEGxFi7fVOkWfedwtIRJzlbppffmRgNzjYBjVi9XcXKkd5LvqAxyn6GLHXCshEnO19tRcv&#43;tAL6rq1WpkEG537NmNfwlZZzlRY5RcbaFo/TPoRsAB9N94/VFJpmYHQnfTRlFL8b7dHNfJgqH8F2UzpPJJDflpzMuHB89k99a6ZW68bbx&#43;l2527jt3SfsefO2G&#43;c4lNHmrbd8wjZ7/uzP99ZV0P9fvXp9YvvCz9diz0f/L8P8GDiMJsPy1oU0&#43;EvqPI&#43;XNprcmFgCx0fP5Pe2yHTL85vMWjzbbs&#43;bt51veXbz1pu12fNnf75Fdp&#43;2/se//Pna7PnY/2W4&#43;gyHsojVcfk26qR01iMNuhmt6g8DR2Nbhwpr6x/RtF4cui18pnK3u2&#43;ylkO3ENhkr&#43;JZPPX/zH&#43;Rfz9JcpsrQwm/zpMh2Be1zYXHs1Zungx2varXh24P0IaeSc7XdOcX0ttDNw/YrE5bjQ84e6Wbu1WUvKyTQ7cGXrlMZ13FYFTm1fkXjog5k5yvyc7BXr5yASegNLlJk2SRX6Ik31Fd5PLJ&#43;Xh8DLN6S&#43;8YWgl/gzDJ2aqLbB9Mc2uAEnD8SpO7dJIscqG/h&#43;&#43;qzo5uruRdFJKDJMIkZ61eb&#43;l/PL7TGsAmw9XwwV919sE9wReqt6vLu7P88G8Vjok5k5y1elnmGb6o6nqd66raIXD0SndVDubSWAu&#43;u3pVOllUl3LhyAiTnLl6XSYZpJd/k3&#43;VaWaZqHQInIhBkmRqriTHoP46dAuA9oRJzl5d5DrX5S49i78AJ6WTJLHUAgBfxJxJADhNkywyMcQVgK&#43;iZxIATlK9tWIuAF9JzyQAAACtCZMAAHxLpXPoFgC7GOYKrZRBemnSZPFY&#43;bUM00uTRaZVoQsA&#43;BSlyTi9cmHlSfi&#43;9EzC3kq33GecTmaZppNhfpdRacp9RplnmmRU7g/dRgA4BaWbu/TTZFyaj&#43;8N&#43;Bp6JmFPpZu7JBfLyohlkt9JhhmkyUWdliY3SbplqHcSAD6mdHKXZYjsZpzvtgblRRaHbgJ8D3omYWmWneXzS5O7JD8fiuwvB7gmaVaF98fprR4DAB9S50/Oyv0yOnR7XrRuaugtLOmZhCRJvXpjg1Ga/FpHyDwZdDNJkvRXj&#43;YBAD7qMp10V/eHZVYtdAPfkJ5J2M8g82cnst7qz/nq6uRycOu0Tg7dUAA4fnWRyyeDScel&#43;4GdAV9EmIT9XOXy2eOHk9rDsNerXORnvTh0MwHgNNTZkzOvQjzwLQmTsJd6XZ/PqXzomVzPmjCDAgA&#43;U73N4ySUbsaHbg/wkjAJ71Calz2TAMBnq9d5nD7SL4NDtwd4TpiE93icMangDgB8nav1GKBrdQnguxEm4T30SwLAX1AX&#43;ZVFFvn1Zt114K8TJmEvpV/uy&#43;/1AJtXMyaTpNyUeuh2AsBpqfNc5MLSIPAdWWcS9lA6uUmSjDJ5NmNy9mybvlUmAeCzKXAH35WeSdjHQ4/kcsWr/sPTz05vo&#43;TF8iEAwMkpd2V06DbA96BnEpIkpZumvj0D8iopTYYb3j9OP9d77AEAOG69j&#43;8CToOeSVga5W7Hq5MsklzV29LNXTq5XA5wLePSlKYMyn0GuVYaAACA8yFMwh7qPBeZZ1Rq7tPkok5ykUkWGeRP/mScRS5ESQAAzolhrrCXOsuP0k2TxXKeZF3kMpdlOdBlVheHbh8AnJPSzaCqVAAHJkzC3l5XkzNHEgD&#43;vjLIOCkLo4LgsAxzBQDgiJRxxkmS4Xr9Z&#43;AghEkAAI5G6Twu0ZVR6X5gV8AHCZMAAByNOs&#43;v9YMmN6U5dIvgfAmTAAAckTrN41zJTm4O3R44X8IkAABHpV5nsn7QK6NDtwfOlTAJAMCxucpjjfW/XYhnmtnHdwKnwNIgAAAcmboov3Kfh/mSozKrfy3g1YtDf3r4LvRMwtJVnBoA4Gg8K8QDHIQwCUmSOqvTQ7cBANhfneYySTLLj7/XLwk8MswVAICjVCelm9TLQ7cDzpUwCQDAkRIk4ZAMcwUAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAOCklO6hWwDnQZgEAOBklKbc5P4r42TpCauwJEwCAHAiSjd36Se5K82XHeQuo0N/TvgehElIkpRRuTt0GwCAjyhN7rLsNWzivA5fTpiEpW56h24CAPARdZHb9YNuGR&#43;6PXDqhEkAAE5Evcxs/WBQBoduD5w2YRIAgNNxkcX6/lipHPhKwiQAACejLnLx5OFXFuKBsydMAgBwQuosl&#43;sHCvHAFxImAQA4KXWSyfpB18xJ&#43;CrCJAAAJ&#43;ZJIZ7rOvnQroCt/jl0AwAA4NNd5HeSy3r74T0BWwiTAACcnLooF0mdfXxPwDbCJAAAJ&#43;irgmQth/5k8F0Ik7B0G9cuAQBgb8IkJElMzgcAgDZUcwUAAKA1YRIAAIDWhEkAAM5E6Zab0hy6FXAqzJkEAOAslEHGSRa5PHRL4DTomQQA4AyUccZJkkEZHrotcBqESQAATl5p0ls/GJXeB3YFrAiTAACcvLrIryzWD29K59AtguMnTAIAcAbqLFfrB00U4oEPEyYBADgLdZLr9YNuRu/bS6nl7tCfBL4HYRKSJGVQ3nlKAQCORb3KdP1AIR74IGESlvpxQgGA0/cr8/V9hXjgQ4RJAADOxrNCPIsnJXmA1oRJAADOyLoQzyw/6uzQrYFj9s&#43;hGwAAAH9TnZROmlxV/ZLwIcIkAABnpl59fB&#43;AYa4AAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAACQpHT32uw6t4duKXwPwiQAAGevNGWc&#43;9J/e8t6VSeHbi18D5YGgSRJvTh0CwCAQymd3KSbZFzmdXbo1sCx0DMJAMBZK03usxzi2mRcmkO3B46FMAkAwFmrizwOXO1mfOj2wLEQJgEAOHP16klRnX4ZHbo9cByESQAAuMzjXMnhPoV4AGESAICzVxe5zGL9cLznMiFw1oRJAABIneVy/UAhHtiDMAkAAEnqba7XD7oZHLo98N0JkwAAkORZIZ7rev2hXcEZECYBAODBZWZZ5LJebdugjIo&#43;S0iS/HPoBgAAwHdRF&#43;UyqbMdmwwzfbIuJZwxPZOQJCl3pR66DQDA4dXZzigJrAmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAsFPplpvSHLoV8N1YGgQAAHYog4zSJPl16JbA9yJMAgDAVmWUYZKkX/5t/l/pJvmPyzBTC4iAMAkAANv11vf&#43;y/yXSZL/IKOkTHMlUHLezJkEAIDtfmWx8fle7srg0I2DQxImAQBgqzrfOleyyah0D90&#43;OBzDXGHpNgaqAADtNBnn56EbAYciTEKSpE4O3QIA4Jsa7XitW/r19tANhMMwzBUAALYqTXYPZe3tuSM4OXomAQCOXultjjT1auPWm3vapnW6YdtBOhu2nW8a01M62VyQZlLnH9zz132&#43;t/f81qzI/6x0Pvz52v3kPvfzvXfPf&#43;VfxuZ28m1Utzdu6zt3h26Jm5ubm5ub2/e9ZbS&#43;2zvo0Z/dtmy9&#43;enRxm3vNm678XtRelv23Pvwnr/u8725562f6jM/X7uf3Kd&#43;vu/9L&#43;OtH73bYW96JgEAjt8k0xZbX2x8dr7x2as0G57dvFjGbMueNxe5a7Pnr/t87fa8yf/wCZ&#43;v3U/u6z7fd/6XwTdU6qFb8O2tf0TTevGhHQEAJ6yMMlzdvagfjSd8K298Yb42FJNzpQAPAADscvuBV&#43;GECZMAALDL9Y7XptVK1ZwtYRIAAHaos61xcpFfh24dHI4wCQAAO9WrjXFynou6aL0zOBnCJCRJymDLykoAAKlXuXhWF3WR6/w0xJXzJkzCUn9dgw8A4JU6rRf5kV9J/j&#43;5qP9Sr/RKcu6sMwkAAHup88xL8j9Z/AUSPZMAAAC8gzAJAABAa8IkAAAArQmTAAAAtCZMAgDAt1Cacld67373uAwO/Qk4L6q5AgDAX1G6abLYtjplaXKXyQcqxV7lrqRODv0pOR/CJAAAfLnSzU3mmaVbkl&#43;v16gsTe4y&#43;0gUrIvyK/fiJH&#43;PYa4AALC/i1y1f1Pp5C7zepHrzNPNpuGo46RefqxpdZ5fGZfuoX9EnAs9k7A0&#43;/guAIDT985hqOM0mSYZZZCk8/LlMkw/F5/RunKbm/Lzdc8nfD49k5AkqVf1E36BAwC8VrrpJZkmaZIkty9ebzL80GzJp67SyfDQn5jzIEwCAMDX6idJnSW5ynUuXsXGYZpcf86h6jyTDEvn43uCtwiTAADwtbpZ9kumzuvVyyhZmgwyrfNPO9ok0TfJ3yBMAgDA1&#43;pmV32GQZqXA18/os4yT780h/7QnD5hEgAAvlDppEmyveexn3xmmExym2Y5tBa&#43;kjAJAABfablUx5YwWTrpZvbJ1VenSXqH/ticPkuDAADAV&#43;omO5YU6Wc1n3KbMkgvTZosMstkObeyDNNLk0WmdVPhnlmESf4CPZMAAPAFSq/UUktdFsNZ3i/11Wbd7BgCW7rlPuN0Mss0nQzzu4xKU&#43;4zyny5bmW5f/2uusg8Teke&#43;ifAqRMmAQDgC9TpMj9mnuR2lSXLq812hMnSzV06uag/61W9ynJN7GF&#43;p5uLerlaTKRbNlVunedheC18GWESAAD2Vu7KqOVbOtlVfqeTLZVeS5O7JD8fBsiuFw9pMqnTJOPVUNZNdVtnqz3DFzJnEpIkpZumTj&#43;&#43;HwDgxLWci1iW22/5llE6SbKl/M4oTX49rj/5ZLGPSZKs67VuC6rCJF9MzyQsjXJ36CYAACdoOdh02yqTuwLfIPP6dMmQhxg7r8u9LYe5Tutky/utNMkX0zMJAABfp5Nk/q6lP65eRNCHOZAPw16vyjSLujmmzgNfTpgEAICvs7Na6y6vFv146Jlcx8cdU3SESf4Cw1wBAODrdLN9kGsLpXnZM7mTIa78BcIkAAB8kbJ7xmQbjzMm9&#43;l1tCwIf4EwCQAAX&#43;WtMLn/XMo2/ZLwVwiTAADwVTpJFtv7EuuOPsvSL/fldxmsHr6aMZkk5abUrTv4jP5Q2EGYBACAr/L2jMnFei3KZ0onN&#43;mmk1HybMbk7Nk2/S2ldjpp0&#43;sJ7yJMAgDAV&#43;nlrTA5y&#43;ZyOQ89kstI2H94&#43;llf5ijJ5ca9Nm8eFz5MmAQAgP1N9w9ppZPkrWU6ZtldLucqKU2GG/Y&#43;Tj/XW5YH6e1cOAQ&#43;hTAJAAB7qxf1au&#43;N96nlOs3mMDnJIslVvS3d3KWTy&#43;V&#43;yrg0pSmDcp9Brje3pXSjUA9/gTAJS1e5OHQTAIAT002yqDvDZJ1mkQ1zJus8F5lnVGru0&#43;SiTnKRSRYZ5E/&#43;ZJxFtsfaXoRJ/oJ/Dt0A&#43;B6qWQUAwGfbr4fwNoPSr7cvn66z/CjdNA9xtC5ymctVsZ5Z3VVep5/kNvDFhEkAAPganewTJicZpLc5/L2&#43;3P32TMjSSTe3df7WdvBRhrkCAMAnKk1pkqR00skePYR1lmn6pXlzx/saJJkc&#43;qfAORAmAQDg05RB/uRP6WU5c3FS91nt8Sob67W&#43;6/hNBpmq5MrfIEwCAMDnGSVZDnDtJrne5y11lusMPqlvcphta0/CJxMmAQDg8zRJZrktnQxyvffMxessMv74wUsnwxZHhQ8RJgEA4PNcZ56rdHOTyf4rUtZFfqVXBh8&#43;&#43;k0mda/eUPg41VwBAODT1KsyTS9NrtrNW6yz8is3ZfaR5crKOKmGuPLXCJMAALC30ntY93GbOt1jOZCN7ysXuSkX7x2kWkZJLg798&#43;GcCJMAALC/u0y/KrLVWbnIPtVfN7v9SK8mtCdMAgDAN/GR0jmiJH&#43;bAjwAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALT2z6EbAAAAR&#43;Qii0M3Ab4HYRIAAPZWp4duAXwXhrkCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAHsrtdwdug3wPQiTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAlwAsqo1HJTmkO3AwA4H8IkwNEr3QyT9DM4dEsAgPMhTAIcv4ceSWESAPhrhEmA4zfLIknSKaNDNwUAOBfCJMDRq4tMVneHpX/o1gCcuOvcHroJ8D0IkwCn4Drz1b1x6R66MQCnrF7Vycf3AqdAmAQ4AXWRX6u7Te7ESQDg6wmTACehznK5utvkzmBXAOCrCZMAJ6JOnsTJmzI8dHsAgNP2T/u3lG7Os1rgvyl3h24CwBv&#43;//nXq3uj0stlnX9kZwDAqSmdNHX2Oft6R5hMk96hfwQH8a/O9HMDx6qX&#43;/JTnAQAHpRu7tKU2/rr4/syzBXglDUZHLoJAMA3MkiTpF8&#43;pZtMmAQ4ZdNDNwAA&#43;EYWqz8/5XKzMAlwqma5qMIkAPDo4ZtBv3xCnHzHnMk6TTn0z&#43;BvKnV1Z1ovDt0WgF3KIOP1g&#43;t6dej2AADfS52W2ywXEBuV2UcL8eiZBDgRpfskSl6KkgBfo4w&#43;o0cHDuZqNdS1yV3pfmxXwiTASSjdPCxftMhFnRy6PQAna7jq14GjVOd5uODc5OZjcVKYBDgN4zSre5dmSgIA29RJLld3O7n7SF1XYRLgBJRhHq4sXtbbQ7cGAPjO6iTXq7tN7srwvftZV5dhGwV4gO&#43;v/Fn1Syq7w7dSRnn3VxQA/ppprt5TjEfPJMDRK71VlFysrzMCAOyrt6680IowCXD8HhYgntTFh/YDAJynpjTt3yRMAhy9OsskyVS/JADwLu&#43;6IP3PoVsNwMfVy3VdNvhO5jmn2sL/Uf716t7/kD&#43;HbgxfqJf/Lf/vQzcCPujfy3&#43;S/8fq/uK95fsU4HmTAjwAwNuelBu6sEDPKSvVt0KOXWlyt64DP8vFe6fJGOYKAABwNp5FyUn9&#43;f6KC8IkAADA&#43;Rg/iZIfmiZjziQAAOytlkO3AD6iDNJf3f1glNQzCQAAcCZKk9Hq7uyjUVKYBAAAOBeDLNeTXOQTykgJkwAAAOehs/rz&#43;v1ldx4JkwAAAOdhniRZ5F3rSr6kAA8AAMB5mKRJJ7d1/hk7EyYBAADOQl3k6vP2ZpgrAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAA7K3UcnfoNsD3IEwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBr/xy6AQAAcESuMz90E&#43;B7ECYBAGBv9erQLYDvwjBXAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAGBv5a6MDt0G&#43;B7&#43;OXQDAADgiPQO3QD4LvRMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAAD7m2Z26CbA9/DPoRsAAADHo14cugXwXeiZBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFr759ANOALXqz/nh24IAADAdyFMvqleHboFAAAA341hrgAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArZV66BYAAJyA0klndXdWF4duDcDXEyYBAABozTBXAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1v5vre6PTiNeQf8AAAAASUVORK5CYII&#61; " alt="" /></div>
<p>There are several things to notice. First, I&#39;ve drawn the dashed axes to represent the domain and codomain of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Df(\bm{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span>. Now, since we&#39;re doing reverse mode, we need to go the other direction: take incremental changes in output and turn them into incremental changes to input. Luckily, we can take the transpose of a linear map: </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><msup><mo stretchy="false">)</mo><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mo>:</mo><msup><mi>W</mi><mo>‚àó</mo></msup><mo>‚Üí</mo><msup><mi>V</mi><mo>‚àó</mo></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><msup><mo stretchy="false">)</mo><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mo stretchy="false">(</mo><mi mathvariant="bold-italic">g</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="bold-italic">g</mi><mo>‚àò</mo><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
Df(\bm{x})^{\intercal}:W^*\to V^*\\
Df(\bm{x})^{\intercal}(\bm{g})=\bm{g}\circ Df(\bm{x})
\end{align*}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚Üí</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àò</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>Where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">g</mi><mo>‚àà</mo><msup><mi>W</mi><mo>‚àó</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}\in W^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span></span></span></span>. It is important to realize <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">g</mi></mrow><annotation encoding="application/x-tex">\bm{g}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span></span></span></span> isn&#39;t special. It can be any element of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>W</mi><mo lspace="0em" rspace="0em">‚àó</mo></msup></mrow><annotation encoding="application/x-tex">W^{*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚àó</span></span></span></span></span></span></span></span></span></span></span></span> . We&#39;re now dealing with the dual space. Elements are often referred to as covectors. They are a linear map from their &quot;normal&quot; space to the underlying field. Thus, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">g</mi><mo>:</mo><mi>W</mi><mo>‚Üí</mo><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">\bm{g}:W\to \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚Üí</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">R</span></span></span></span>. This means the types the expression make sense: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">g</mi><mo>‚àò</mo><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>:</mo><mi>V</mi><mo>‚Üí</mo><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">\bm{g}\circ Df(\bm{x}):V\to \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àò</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚Üí</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">R</span></span></span></span>, or <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">g</mi><mo>‚àò</mo><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>:</mo><msup><mi>V</mi><mo>‚àó</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}\circ Df(\bm{x}):V^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àò</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span></span></span></span> . Often people think of the dual space as linear functions that are &quot;taking the inner product with a vector&quot;. So </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="bold-italic">g</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">‚ü®</mo><mi mathvariant="bold-italic">g</mi><mo separator="true">,</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">‚ü©</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
\bm{g}(\bm{x}) = \langle \bm{g},\bm{x} \rangle.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">‚ü®</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">‚ü©</span><span class="mord">.</span></span></span></span></span>
<p>This is especially useful because we can then represent <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">g</mi></mrow><annotation encoding="application/x-tex">\bm{g}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span></span></span></span> as a row vector, which, when combined with a column vector from the nondual space, gives the inner product. This is the reason I&#39;ve been so careful with keeping the <code>gt</code> of shape <code>&#40;1,n&#41;</code> because these <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">g</mi></mrow><annotation encoding="application/x-tex">\bm{g}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span></span></span></span>s are members of the dual space and are actually row vectors. From now on, I&#39;ll use <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span></span></span></span> as a reminder that it&#39;s a row vector. </p>
<p>Just to check that using the covectors as row vectors will work, let&#39;s examine our vector-Jacobian product </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="bold-italic">g</mi><mo>‚àò</mo><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">v</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi mathvariant="bold-italic">v</mi><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mi mathvariant="bold-italic">v</mi></mrow><annotation encoding="application/x-tex">
(\bm{g}\circ Df(\bm{x}))(\bm{v})=(\bm{g}^{\intercal} Df(\bm{x}))\bm{v}=\bm{g}^{\intercal} Df(\bm{x})\bm{v}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àò</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span></span></span></span></span>
<p>Thus, with our newfound correspondence, let&#39;s evaluate the vector-Jacobian product &#40;and employ chain rule&#41;. Let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>=</mo><mi>C</mi><mo>‚àò</mo><mi>B</mi><mo>‚àò</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">f = C \circ B \circ A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àò</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àò</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>, then </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><msup><mo stretchy="false">)</mo><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mo stretchy="false">(</mo><mi mathvariant="bold-italic">g</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mtext>‚Äâ</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>D</mi><mi>C</mi><mo>‚àò</mo><mi>B</mi><mo>‚àò</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mtext>‚Äâ</mtext><mtext>‚Äâ</mtext><mo stretchy="false">(</mo><mi>D</mi><mi>B</mi><mo>‚àò</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mtext>‚Äâ</mtext><mi>D</mi><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mtext>‚Äâ</mtext><mi>D</mi><mi>C</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>B</mi><mo>‚àò</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext>‚Äâ</mtext><mi>D</mi><mi>B</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext>‚Äâ</mtext><mi>D</mi><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
Df(\bm{x})^{\intercal}(\bm{g})&amp;=\bm{g}^{\intercal} Df(\bm{x})\\
&amp;=\bm{g}^{\intercal} \,((DC \circ B \circ A)(\bm{x})\,\,(DB \circ A)(\bm{x})\,  DA(\bm{x}))\\
&amp;=\bm{g}^{\intercal}\, DC((B \circ A)(\bm{x}))\,DB (A(\bm{x})) \, DA(\bm{x})\\
\end{align*}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mclose">)</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àò</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àò</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àò</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àò</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>Recall our definition from earlier: </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext mathvariant="monospace">Jt_f</mtext><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mo stretchy="false">)</mo><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
\texttt{Jt\_f}(\bm{x}, \bm{g}^{\intercal}) = \bm{g}^{\intercal}Df(\bm{x}).
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord texttt">Jt_f</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<p>Then </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mi>D</mi><mi>C</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>B</mi><mo>‚àò</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext>‚Äâ</mtext><mtext>‚Äâ</mtext><mi>D</mi><mi>B</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext>‚Äâ</mtext><mi>D</mi><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext mathvariant="monospace">Jt_C</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>B</mi><mo>‚àò</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mo stretchy="false">)</mo><mtext>‚Äâ</mtext><mi>D</mi><mi>B</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext>‚Äâ</mtext><mi>D</mi><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
&amp;=\bm{g}^{\intercal} DC((B \circ A)(\bm{x}))\,\,DB (A(\bm{x}))\,  DA(\bm{x})\\
&amp;=\texttt{Jt\_C}((B\circ A)(\bm{x}), \bm{g}^{\intercal})\,DB (A(\bm{x}))\,  DA(\bm{x})\\
\end{align*}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àò</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord texttt">Jt_C</span></span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àò</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>What we should notice here is that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">Jt_C</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>B</mi><mo>‚àò</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mo stretchy="false">)</mo><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mi>D</mi><mi>C</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>B</mi><mo>‚àò</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\texttt{Jt\_C}((B\circ A)(\bm{x}), \bm{g}^{\intercal}) = \bm{g}^{\intercal}DC((B\circ A)(\bm{x}))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord texttt">Jt_C</span></span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àò</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àò</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span></span></span></span> is an element of the dual space of the output of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>. Thus, we can apply this strategy again, where we incorporate an element into a call to a <code>Jt</code> function: </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext mathvariant="monospace">Jt_C</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>B</mi><mo>‚àò</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mo stretchy="false">)</mo><mtext>‚Äâ</mtext><mi>D</mi><mi>B</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext>‚Äâ</mtext><mi>D</mi><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext mathvariant="monospace">Jt_B</mtext><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext>‚Äâ</mtext><mtext>‚Äâ</mtext><mtext mathvariant="monospace">Jt_C</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>B</mi><mo>‚àò</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext>‚Äâ</mtext><mtext>‚Äâ</mtext><mi>D</mi><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext mathvariant="monospace">Jt_A</mtext><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo separator="true">,</mo><mtext>‚Äâ</mtext><mtext>‚Äâ</mtext><mtext mathvariant="monospace">Jt_B</mtext><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext mathvariant="monospace">Jt_C</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>B</mi><mo>‚àò</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
&amp;=\texttt{Jt\_C}((B\circ A)(\bm{x}), \bm{g}^{\intercal})\,DB (A(\bm{x}))\,  DA(\bm{x})\\
&amp;= \texttt{Jt\_B}(A(\bm{x}),\,\, \texttt{Jt\_C}((B\circ A)(\bm{x}), \bm{g}^{\intercal})) \,\,  DA(\bm{x})\\
&amp;= \texttt{Jt\_A}(\bm{x},\,\, \texttt{Jt\_B}(A(\bm{x}), \texttt{Jt\_C}((B\circ A)(\bm{x}), \bm{g}^{\intercal})))\\
\end{align*}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.5em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-3em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-1.5em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord texttt">Jt_C</span></span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àò</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord texttt">Jt_B</span></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord texttt">Jt_C</span></span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àò</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord texttt">Jt_A</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord texttt">Jt_B</span></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord texttt">Jt_C</span></span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">‚àò</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mclose">)))</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>This is very busy notation, so to look at it better, let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">a</mi><mo>=</mo><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="bold-italic">b</mi><mo>=</mo><mi>B</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\bm{a}=A(\bm{x}), \bm{b}=B(A(\bm{x}))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">a</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span></span></span></span> then the final expression becomes </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext mathvariant="monospace">Jt_A</mtext><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo separator="true">,</mo><mtext>‚Äâ</mtext><mtext mathvariant="monospace">Jt_B</mtext><mo stretchy="false">(</mo><mi mathvariant="bold-italic">a</mi><mo separator="true">,</mo><mtext>‚Äâ</mtext><mtext mathvariant="monospace">Jt_C</mtext><mo stretchy="false">(</mo><mi mathvariant="bold-italic">b</mi><mo separator="true">,</mo><mtext>‚Äâ</mtext><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
\texttt{Jt\_A}(\bm{x},\, \texttt{Jt\_B}(\bm{a},\, \texttt{Jt\_C}(\bm{b},\, \bm{g}^{\intercal}))).
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord texttt">Jt_A</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord texttt">Jt_B</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">a</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord texttt">Jt_C</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mclose">)))</span><span class="mord">.</span></span></span></span></span>
<p>This should hopefully justify the program I provided at the beginning of the post. Just by knowing the <code>Jt</code> functions of the primitives, we end up with the ability to convert <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span></span></span></span> into a covector of the input space of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>. Now let&#39;s reflect on what this means. If we choose <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">‚Ä¶</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}=\begin{bmatrix} 1 &amp; 0&amp; \dots&amp;0 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">‚Ä¶</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span>. Then we get back a row of the derivative: </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">‚ä∫</mo></msup><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">‚Ä¶</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mtext>‚Äâ</mtext><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="normal">‚àÇ</mi><mn>1</mn></msub><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="normal">‚àÇ</mi><mn>2</mn></msub><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">‚Ä¶</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="normal">‚àÇ</mi><mi>n</mi></msub><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
\bm{g}^{\intercal}Df(\bm{x})
&amp;=\begin{bmatrix} 1 &amp; 0&amp; \dots&amp;0 \end{bmatrix}\, Df(\bm{x})\\
&amp;=\begin{bmatrix} \partial_{1}f(\bm{x}) &amp; \partial_{2}f(\bm{x})&amp; \dots&amp;\partial_{n}f(\bm{x}) \end{bmatrix}
\end{align*}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.02em;vertical-align:-1.26em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.76em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">‚ä∫</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-2.4em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.26em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.76em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">‚Ä¶</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-2.4em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord" style="margin-right:0.05556em;">‚àÇ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord" style="margin-right:0.05556em;">‚àÇ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">‚Ä¶</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord" style="margin-right:0.05556em;">‚àÇ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:1.26em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>&#40;borrowing notation from <a href="https://mitpress.mit.edu/9780262019347/functional-differential-geometry/">Sussman</a>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">‚àÇ</mi><mn>1</mn></msub><mi>f</mi></mrow><annotation encoding="application/x-tex">\partial_{1}f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">‚àÇ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> is the partial derivative with respect to the first argument&#41;.</p>
<p>This is great because almost all loss functions in ML are scalar, so the Jacobian just has one row, and thus, we can efficiently compute the gradient for our descent.</p>
<p>You may be thinking, hold on a minute, the gradient is actually a linear form &#40;in the case of a scalar loss function&#41;: we can&#39;t add that to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">x</mi></mrow><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span>, and you&#39;re right. We should think of the gradient as something that can turn small changes of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">x</mi></mrow><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span> into small changes in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(\bm{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span>. When we&#39;re doing gradient descent, we want a small change in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">x</mi></mrow><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span> that will maximally decrease <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(\bm{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span> for a given step size. The small change in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">x</mi></mrow><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span> that will cause the most increase is in fact the transpose of the gradient &#40;this makes sense since the dot product is maximal when the vectors are parallel&#41;. So, it is okay to use the gradient for gradient descent after all.</p>
<p>It is important to note that the components of the Jacobian depend on the basis of the vector spaces of the domain and codomain.</p>
<h1 id="wrapping_up"><a href="#wrapping_up" class="header-anchor">Wrapping up</a></h1>
<p>I hope this post helped you understand JAX backward-mode automatic differentiation. I wrote an <a href="https://github.com/jasoneveleth/autograd">implementation</a> that automatically tracks the computations, so you don&#39;t have to write out the <code>Jt_f&#40;&#41;</code> functions explicitly. This is one of my most technical posts. Let me know if any part of it needs better or more in depth explanation.</p>
    <script src="https://utteranc.es/client.js"
        repo="jasoneveleth/blog"
        issue-term="pathname"
        label="Comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
    </script>

<div class="page-foot">
    ¬© Jason Eveleth 2023 ¬∑ Powered by Franklin.jl ¬∑ Last modified: January 18, 2024
</div>
</div><!-- CONTENT ENDS HERE -->
  </main> <!-- end of id=main -->

  <!-- if we're in an iframe -->
  <script>
    if (window.self != window.top) {
      console.log("we're in an iframe!!!");
      document.querySelectorAll(".blog-nav").forEach(i => i.style.display = "none");
    }
  </script>

  <!-- <script src="/blog/libs/vela/metisMenu.min.js"></script> -->
  <!-- <script src="/blog/libs/vela/slideout.min.js"></script> -->
  
    



  
  
    <script src="/blog/libs/highlight/highlight.min.js"></script>
<script>hljs.highlightAll();hljs.configure({tabReplace: '    '});</script>

  
  
</body>
</html>
