<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
   <link rel="stylesheet" href="/blog/libs/katex/katex.min.css">
   
   <link rel="stylesheet" href="/blog/libs/highlight/styles/github.min.css">
   

  <link href="/blog/css/franklin.css" rel="stylesheet">
<link href="/blog/css/global.css" rel="stylesheet">
<!-- <script src="/blog/libs/jquery/jquery.min.js"></script> -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🦦</text></svg>">


  <title>A Rigorous (and Not-So-Rigorous) Look at JAX's Autograd</title>
</head>
<body>
<nav class="flex-container blog-nav">
  <!-- type-a have a fixed width which never changes -->
  <!-- type-b will grow up to a point -->
  <!-- type-c start at 0 and absorb remaining space-->
  <!-- https://jsfiddle.net/dehsq3jb/ -->
  <div class="type-c"></div>
  <div class="type-b link-spacer"></div>
  <div class="type-a logo"><a href="https://www.jasoneveleth.com">Jason's</a> <a href="https://www.jasoneveleth.com/blog">Blog</a></div>

  <div class="type-b content-spacer"></div>

  <div class="type-a nav-link"><a href="/blog/search">Search</a></div>
  <div class="type-b link-spacer"></div>
  <div class="type-c"></div>
</nav>

<main id="panel">

<h1 class="post-title">A Rigorous (and Not-So-Rigorous) Look at JAX's Autograd</h1>
<!-- <hr> -->
<!-- Content appended here -->
<div class="franklin-content"><p> 
<details>
<summary>Table of Contents</summary>
 <div class="franklin-toc"><ol><li><a href="#what_this_post_is_about">What this post is about</a></li><li><a href="#related_work">Related work</a></li><li><a href="#how_does_it_work_examples_plz">How does it work &#40;examples plz&#41;</a></li><li><a href="#what_are_those_jt_fx_gt_functions">What are those <code>Jt_f&#40;x, gt&#41;</code> functions?</a><ol><li><a href="#jt_subtract_const"><code>Jt_subtract_const</code></a></li><li><a href="#jt_square"><code>Jt_square</code></a></li><li><a href="#jt_arctan"><code>Jt_arctan</code></a></li></ol></li><li><a href="#what_is_going_on">What is going on</a></li><li><a href="#wrapping_up">Wrapping up</a></li></ol></div> 
</details>
</p>
<h1 id="what_this_post_is_about"><a href="#what_this_post_is_about" class="header-anchor">What this post is about</a></h1>
<p>Warning: this is my understanding, I&#39;ve only just starting learning differential geometry, so if I&#39;ve made a mistake, please leave a comment.</p>
<p>I&#39;ve started writing this post from scratch several times as I&#39;ve tried to get the presentation just right. I settled on this two goals: &#40;1&#41; if you have heard the terms &quot;<a href="/blog/404">vector space</a>&quot; and &quot;gradient&quot; thrown about before, you should be able to understand and write JAX primitives, and &#40;2&#41; if you&#39;re comfortable with vector spaces, dual spaces, and multivariable calculus, I will assuage your fears about rigor.</p>
<p>We&#39;ll cover <code>JAX</code> flavored reverse-mode autograd, and focus on the &#39;grad&#39; part of that: you should see <a href="/blog/2024/01/05/autograd/#related_work">Related work</a> for the &#39;auto&#39; part, basically you wrap every <code>ndarray</code> in a custom class that keeps track of how it was made.</p>
<h1 id="related_work"><a href="#related_work" class="header-anchor">Related work</a></h1>
<p>There is a lot of prior art in this area. These are the things I found helpful. One of the main contributors behind JAX made <a href="https://videolectures.net/deeplearning2017_johnson_automatic_differentiation/">a video</a> about their framework, and <a href="/blog/404">here</a> are my notes on it. I also found another <a href="https://thenumb.at/Autodiff/">autodiff blog post</a>, and my <a href="/blog/404">notes</a>. The most directly relevant stuff is probably the <a href="https://jax.readthedocs.io/en/latest/notebooks/autodiff_cookbook.html#jacobian-vector-products-jvps-aka-forward-mode-autodiff">autodiff cookbook</a> for JAX, specifically the section I linked to, and <a href="https://jax.readthedocs.io/en/latest/notebooks/How_JAX_primitives_work.html">what you need to do</a> to implement a primitive. Finally, I also found <a href="https://engineering.purdue.edu/~qobi/papers/toplas2008.pdf">a paper from 2008</a> and a core JAX contributor&#39;s <a href="https://dougalmaclaurin.com/phd-thesis.pdf">phd thesis</a>  &#40;pages 48-52 and 13-19 are relevant&#41;.</p>
<h1 id="how_does_it_work_examples_plz"><a href="#how_does_it_work_examples_plz" class="header-anchor">How does it work &#40;examples plz&#41;</a></h1>
<p>First, let&#39;s look at a </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><mstyle mathcolor="red"><mo stretchy="false">∣</mo><mo stretchy="false">∣</mo></mstyle><mstyle mathcolor="green"><mi>arctan</mi><mo>⁡</mo><mo stretchy="false">(</mo></mstyle><mstyle mathcolor="blue"><mi>W</mi><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi mathvariant="bold-italic">b</mi></mstyle><mstyle mathcolor="green"><mo stretchy="false">)</mo></mstyle><mo>−</mo><mstyle mathcolor="purple"><mi mathvariant="bold-italic">y</mi></mstyle><mstyle mathcolor="red"><mo stretchy="false">∣</mo><msup><mo stretchy="false">∣</mo><mn>2</mn></msup></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mrow><mtext> </mtext><mstyle mathcolor="blue"><mtext>single-layer</mtext></mstyle><mtext> neural net with </mtext><mstyle mathcolor="green"><mtext>arctan activation</mtext></mstyle><mtext> and </mtext><mstyle mathcolor="red"><mtext>MSE</mtext></mstyle><mtext> loss w.r.t. </mtext><mstyle mathcolor="purple"><mtext>labels</mtext></mstyle><mtext> </mtext></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
&amp;f(\bm{x}) := {\color{red}  \lvert\lvert} {\color{green}\arctan(}{\color{blue} W\bm{x} + \bm{b} }{\color{green})} - {\color{purple}\bm{y} } {\color{red} \rvert\rvert ^{2} }\\
&amp;\text{ {\color{blue}single-layer} neural net with {\color{green}arctan activation} and {\color{red}MSE} loss w.r.t. {\color{purple}labels} }
\end{align*}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0241em;vertical-align:-1.2621em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7621em;"><span style="top:-3.7621em;"><span class="pstrut" style="height:2.8641em;"></span><span class="mord"></span></span><span style="top:-2.2621em;"><span class="pstrut" style="height:2.8641em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2621em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7621em;"><span style="top:-3.8979em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen" style="color:red;">∣∣</span></span><span class="mord"><span class="mop" style="color:green;"><span style="color:green;">a</span><span style="color:green;">r</span><span style="color:green;">c</span><span style="color:green;">t</span><span style="color:green;">a</span><span style="color:green;">n</span></span><span class="mopen" style="color:green;">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;color:blue;">W</span><span class="mord" style="color:blue;"><span class="mord" style="color:blue;"><span class="mord boldsymbol" style="color:blue;">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:blue;">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord" style="color:blue;"><span class="mord" style="color:blue;"><span class="mord boldsymbol" style="color:blue;">b</span></span></span></span><span class="mord"><span class="mclose" style="color:green;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord" style="color:purple;"><span class="mord" style="color:purple;"><span class="mord boldsymbol" style="margin-right:0.03704em;color:purple;">y</span></span></span></span><span class="mord"><span class="mclose" style="color:red;">∣</span><span class="mclose" style="color:red;"><span class="mclose" style="color:red;">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:red;"><span class="mord mtight" style="color:red;"><span class="mord mtight" style="color:red;">2</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.3979em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord"> </span><span class="mord"><span class="mord" style="color:blue;">single-layer</span></span><span class="mord"> neural net with </span><span class="mord"><span class="mord" style="color:green;">arctan activation</span></span><span class="mord"> and </span><span class="mord"><span class="mord" style="color:red;">MSE</span></span><span class="mord"> loss w.r.t. </span><span class="mord"><span class="mord" style="color:purple;">labels</span></span><span class="mord"> </span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2621em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>If all the computation &#40;evaluation and gradient accumulation&#41; happened sequentially, it would look like the following. Note: in <code>numpy</code>, the <code>.T</code> property takes the transpose of a 2D array. Don&#39;t worry about the <code>Jt_f&#40;x, gt&#41;</code> functions, they will be explained.</p>
<pre><code class="python hljs">a = W @ x
b = a + bias <span class="hljs-comment"># I&#x27;ve replaced `b` from f(x) with `bias`</span>
c = np.arctan(b)
d = c - y
e = d**<span class="hljs-number">2</span>
loss = np.<span class="hljs-built_in">sum</span>(e)
<span class="hljs-comment"># begin backward mode</span>
gt = <span class="hljs-number">1.0</span>
e_gt = Jt_sum(loss, g_t)    <span class="hljs-comment"># gt * np.ones((1, loss.shape[0]))</span>
d_gt = Jt_square(d, e_gt)   <span class="hljs-comment"># e_gt * (2 * d.reshape(1,-1))</span>
c_gt = Jt_subtract_const(c, d_gt) <span class="hljs-comment"># d_gt</span>
b_gt = Jt_arctan(b, c_gt)   <span class="hljs-comment"># c_gt * (1/(1 + b**2)).reshape(1, -1)</span>
a_gt = Jt_add_const(a, b_gt)<span class="hljs-comment"># b_gt</span>
delta_xt = Jt_matmul(x, a_g)<span class="hljs-comment"># a_gt @ W</span>
delta_x = delta_xt.T</code></pre>
<p>We see that in backward-mode we are using the values from the original computation. I&#39;ve put comments for the definitions of the <code>Jt</code> functions. At the end of the computation, we get a <code>delta_x</code>: the gradient of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> with respect to the input <code>x</code>.  </p>
<h1 id="what_are_those_jt_fx_gt_functions"><a href="#what_are_those_jt_fx_gt_functions" class="header-anchor">What are those <code>Jt_f&#40;x, gt&#41;</code> functions?</a></h1>
<p>I&#39;m borrowing the transpose vector Jacobian product &#40;<code>Jt</code>&#41; from <a href="https://jax.readthedocs.io/en/latest/notebooks/autodiff_cookbook.html#jacobian-vector-products-jvps-aka-forward-mode-autodiff">JAX documentation</a>. I keep the notation so it&#39;s familiar when you interact with JAX documentation. <strong>The next few paragraphs are meant to click later in the post; please don&#39;t give up just because it doesn&#39;t quite make sense now.</strong></p>
<p>In <code>Jt_f&#40;x, gt&#41;</code>, the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">x</mi></mrow><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span> tells us where in the input space of some <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> we are, and, morally<sup id="fnref:1"><a href="#fndef:1" class="fnref">[1]</a></sup> , <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span></span></span></span>  is a direction in the output space of that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>. <code>Jt_func</code> turns that direction in the output space, to a direction of the gradient in the input space. Here&#39;s a picture:</p>
<div class="im-800"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAByYAAALnCAQAAABmJOieAABBB0lEQVR42u39PYtjXfwuZt7rnCcasGH/YcDBBEbtATuYSA3&#43;AiozX0DNZJMYFThypgLHBlV0YimbbKjKDUaKzTC0jice02KcHQduBQYziVkOpFK9qaq0622rVNe14Wm9bG0t1dNdW/dea/1WqQEAAIB2/lXXDQAAAODrESYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGjtn64bAMeuNOknSZZ1vXukqauu2wUAAF0SJnknZbL34UVddN2yN32qQcYZZJl1kkFZ5LIukozTz1nXbQMAgC4Jk7yX/va/zfb&#43;JoB96f67Mso01/lx0wtZRpmW68wyzpeOyAAA8Haldt0CTkpp8jdJclkvum7Lmz/LKNPM6vmDzzdPL00WVc8kAADfmgI8vKubWYXHp0yeGIj71P5NJlnnQSSua8NbAQAgESbhKaM0uX4cjuujgAkAAN&#43;RMMl30W&#43;5/yDJ3n7WOsvR9r8CAMBnUYCHb6E0GWTZ6iXPhc/FrswQAHCg0ksvSbL6jgtsWWqMU6Rnku9h2PoV62de1S6WAsA3V3plUv7kd8YZZJzf5W&#43;Zll7XrfrEzz8o8/zNJOOM87fMyyBJMs6065bB2wiTfAOlSaviO0k2gbFXxk88Z6ArABykNGWSPxnmsv5LPasX9az&#43;S87Tz58yLd9ipE8ZZZ51ftSf9aye1ZLrTMuk9DJ&#43;&#43;7GhW4a58gm2w1qa9LOoiyQpw/STrLK4O7zj4X6ll0F6yc2r7ux5M1RkkFWd7R7dXOfrpXd3YZIyyOQVw1IXGSaZlNTLh0/Vxe06k4e3ebt/PzeffbmvwM&#43;d447SS5N1lrneNwimjNJLP8nyqfcCgK6VfqbpZ5aLu&#43;e8ep3rMs0og/Krnvh4n8dLjdVZuc48o65bBu&#43;g2mzvum3/mNx7bL67OanJML8zySDj/Lm/552XTNLLPL8zySTT1PzJ6IkjznePTW532D3Wz589jZwf8Dma3Sv/ZJJhes9&#43;3gPaXJMmV5lnlH6aDPMnfzN&#43;4r2vUjPPMIMMMsmf&#43;z/PmgzzJ3&#43;yiZOT1MzTdP1/3maz2Wy2h1v6&#43;Zuaqyeenabmb/pveofJw3PkB3&#43;ilu&#43;XJn/z9/FZOk3&#43;5qBvJDbbMW&#43;dN8B2atv2j4fhp8l483hGmd78Sk0vf1PvRq4020h4lT8Z7h7dnIqme49479dwBpsIuLdVLU826T944E&#43;mGe09HRza5qu799Pk98M97rzy7k&#43;ll7/3QvcoNb9vW/Lwvs1ms9lsx7BtL8z&#43;feoM9dLzB73HsYfJcfac62u2Z29h0vbFt84bYDu1bfvH5IlnJg/C31Vqfu89wr3rlNtgN92z54Nfw5tgt/&#43;9W3&#43;WQf4&#43;evDvbWBs1&#43;bt/fm949fUDO69anNivRs6e5sbD151/73mr/l8NpvNZrN95Jar1NSH43Tu7TFKzZM9lwe9x/yTw2TL93vuDJ2/wqTtq28K8PC5xrk/A3GV/YtwXN6fQVGXmSUZbWdFfpK6yI9c5v58xSZXZf8sh5favJm3Obh3/Mc1YyfpJfd&#43;Sg&#43;r3U2TLB7MMLlOMvoeZQwA&#43;BrKIMMk61w/vU&#43;dZZVk&#43;Nrze2nyqd8MXvF&#43;zy81Bl&#43;cMMnnWr&#43;6VMwmXrWvyvomdV0v6o/8yHlmd0Ll9MCT3v02r7LOw2VFlrkXFkuTUZLlvYI7yyx2x9qU3Xm8OMkimyJAAHAsNpdenyk2t3k&#43;SV5d17T90l9vY6kxuEeY5HO9&#43;tdmXW16MbtYlaqu6qye1x/5sesxPGhdqPttrqv8yFn9&#43;exLNqebe4G7rutZLbv6tIPHeyTb8PmpV2cB4Gmltz2nvXTm3zw/eM35/VVLf73lM1lqDB6wNAhfxyq9JIPM3nykV6qrXJTr/E7SK8N6fcBL7rW5rjchsPTTTy/NdmmPu17uW9ycbF89IAgAPsXNeWr1wn43YXO4uWB7&#43;OJfzy399RGLjR3XUmPvt9iYpcZ4C2GSr2Pz6&#43;&#43;TeibL&#43;PEv/SSpy3KZcZJ&#43;DguT99pcmowzTC&#43;zLLOqizJ/0Jv48qfrb4&#43;7b6DrSydsAPgs28ujL8WTuir39s/V7sy4uLl8XCZ3hsFeJEnp52p3zhzv&#43;v0W9Wx768/tO5RVpmm2E0LmZZXLevey9Pu839OuM04vyaSMcp3lg6kstw5vcZLSZJom17nOKoNMMimX&#43;763lCbTDLPILOskg8zL9b21uIeZJLnMLE2GmZdFflW9pbTRdQUg26lt2z&#43;equZ6QO3VJ18/ffjMoUd8TTXXx8fYPdOk5kHlucPanOFmta07i3rM73&#43;C7fqZk&#43;falZoHFWBtNpvNZju27WZF6AP23Pyxq&#43;3eZvGv1Dxx1vyYxcaefr9nPt&#43;7LzX2XouNWWrM9vbNnEm&#43;js0VwXeYrF5GT9Rjvb/XE0NOt4NVDxvocqfNZZirNJnV5675vfzpDEAB4Cs4fCTR5ty3O&#43;vW9b4&#43;tro4aERQ7hxl0wM3zK/biSl1mbMkozK9t&#43;c7vN8zLVnm7N7cyF5GmeZPeVCW5/AWl36GGZX57StzkUc170uz/d5xO3i3lz9pbnpdyyDTJOe330rqLIv0X10MiW9JmOTr2Jxm3qPyWe&#43;gU9zz8xcPa8fdNk&#43;TrOr5/h3LoAxyM1D1uaC63H4CADhmh5&#43;pPvacdgSLjb3zUmPvtdiYpcZ4B8IkX0Tpp0keTBzfF&#43;je75T0dPnvfYtzvNDmMtzcfrDL7a/rQQZJrrdzGh4fa7g95WyuL/b37uFaIgDH4vCLv58dXTpYbOxdlxp7l8XGLDXG&#43;xAmOU6PTyyboHR/IMq&#43;4aKH/FpuDjrFDfZfMSy99LLaU8v1&#43;Tbvi3&#43;Pfl3XdWZJemW451irJKmrXCYZ7rlqOLFeFQBHY3uOPriX69OmcXS32Nj7LDX2TouNWWqMdyFMcpxG92cslmGGSc7r46tw905SZbzp&#43;3t0gljmbpwbHBi7JnvnTU6yre3Wqs2b8Hn/lDq&#43;N/tyExYvskgyKQ8/13pXD&#43;8yyzQPTz9lnKWC3gAcjZsz7Qu9XLtz52dWJO84MtVVvcgmCu67fHxAi&#43;v2W0Hpl1GZlGmZt15s7Gapscn9raufCV&#43;VMMk7KYMyKIPdL6FBGZZB2S5BXPrlppevX4abR0uvDMpmaGfKZDtj8NZlrm6jWRlup4g/XGFylnX6d/YbZbANbeMHR7xMMtjsWYZZ1cNOWbPMy8NYN80ws71rTD7b5t2Mh91Jo4zS5DxJv/RLs2t58ivX6WV&#43;G4jLOMP8urlX1znLMsMyvW1ZmWSYJ2ZjAkAHDgyTu6GZnzm65hMXG3tqCkpdPj1y6ZAWl6ZMyp/8Tj&#43;rXNezRz&#43;/lz7dzVJjiwfbWc66W9Gbr8c6k7yX&#43;b17/VwlSS5zkWSyu5bW5Gr76OhOtbBxxknKvSOcZVrWm2EdGWSWy8cBsK7KWSaZl81Mw15W&#43;bX95TjK6O4R63U5zyTzMkuTfl5eFSpJLutFuc4kf8t1VlllnX6G6eWyXjzximfbXM/LOsNclZu1nhb1PCnnmeZ31rm4qaZW1/lVRhnnT7nOKskwi5zdrQBb1/m522OdTRA9sy4UAMejXpd1mrwcljbPr9&#43;rdurRmeTyiWc261a/KtKW4XadyZ9vPPsb1cQbCZO8k1qeeW5PeKsXucgz6ipnpZdBmlw&#43;vYBuXeas9NLLIMvM6iopq21UXN5/TZ1lVgY3Ee4A17ncHX&#43;U3vZkN3tQAqhVm&#43;tFLko/vfSzyOXm&#43;Tor1&#43;k//FVeZ5k93PPJPa5vgygAHI1Zxnl5MOlmxM71e5zJyiiph/SqvdNiY4e9X&#43;nXve9U12WRQfulxraLjSWzZ7/RLF/4yS/MjOQ9CJMcsbo6ZKBFXWV1O4F8O0l9/56Lw6f319thpavnY2&#43;7Ntdllvevvm7XrTxgz/Z7AEBnLjNKk6aMng5cZZhekvWTvXftHNrL916LjR32fv1n36n9UmMvLjaW1MWLi41twqalxngjcyYBAHh3db29GPvcwlXbuuePRv184OJfn77Y2LsuNfZui41Zaox3IUwCAPAB6my74NUTNULLOP0ks/q4X/J1i3/tW/rrIxcb62KpsXdabMxSY7wPYRIAgA9RzzNLMt4Xp8ookzw18&#43;/Qxb9eXvrrfRcb636psfdbbMxSY7yHarMd1ZZBamrmXbfj1Ntss9lsNtvnbBmnpmaS5t6jk82jT7yml7&#43;p6e/ujzLfnm2nGWSwe3yYerNfhg/PxNv3/XPnOMP8Tc3oY95v7yfZtOHvo88/Tc30ib1faHGmqakZ3mntNL1Ny9Lk9807pclVan6nd&#43;f/xe/bdqTJ79RM7zwyufu8zfbyVmrXaRZ2Hv11fHoRjqPxFdsMAJ&#43;p9DLOKKtcb0vO9TNKL9e5eLpCeulnkn5uF/&#43;6TP92GbLbGvI3/Zubpb/u14QtNcllZpnmhcXG3uf99n6Omst6UfqZZJAXlxo7tMVlkmF6uV1s7CIpo0yTrHNxt&#43;BRGWWcXm4XG3tQAb6MMk6T26XGLlWIpw1hkiNSHs5OWD19kjkWX7HNAPDZSi&#43;D9LdFbVZZPbfU1p3XbBb/WtbV9l7yaPGvpAwyyPLx7MNNNKsX23dvsnz82vd8v73HvMr55vXbpcY2g04X&#43;z9/mxbvlhDb7VGax4uN7d&#43;z3fPwNGESAIATdBvNvoqv12K&#43;OwV4AAAAaE2YBAAAoDVhEgAAgNaESQAATs62RF7/jYfRYniGAjwAAJyUr7dw19drMSTJP103AAAA3tXZg/vHv2zX12sxRM8kAAAAr2DOJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALT2T9cN&#43;ArKOE2u67LrdgAAAByLUrtuwdErk4yTrPOjrrtuCwAAwHEwzPUFpZdRkqTJtOu2AAAAHAth8iVXaba3hmXUdWMAAACOgzD5rDJN/87daem/&#43;lAAAAAnRJh8RpnkYV/kXJwEAAAQJp&#43;xLbxzXyNOAgAACJNPKtM9UTLZxMlB160DAI5RaUqv6zYAfBZhco/SL/PdANfb5UD&#43;f9s/m8zLpOs2AgDHpkzyN38U7AO&#43;C&#43;tMPlD6GWe4u7vKr/ze3l5kkcmdZ65zaeVJAGCj9LffGaxNDXwTeiYfmt&#43;Jksv8rMvbp&#43;plznd3ehk/MRAWAPiOblaktjY18E0Ik/eUwW5VyWSWs4fXFessP7Pa3VWKBwBI8mA5saEJMcB3IEzeUxeZJUkWOavn&#43;4ao1GX9kcvtTMrLrtsLAByDR8uJjc2cBE6fOZOPlF7Wd2Pk7ke0qGd3Hu1nZT4EAJCU0d6Brb/qddctA/hIeiYfqQeFxLoUJQGApEyemCN5pXcSOG3CJADAK5XmzsrU//9HT0/NnQROmTAJAPAKpSmj/L6zMvX/c/fUv9mtUz0uf8qwNK0PDvAFCJMAAK2VXv5kmt727jJn&#43;Z92T/43OdvFyV6u8lucBE6RMAkA0N7oznJiy5zdXZk6qcuc3VlMrHdnFWuAkyFMAgC0dxMe17moPx&#43;X5avL/LyziNjq0MMCfB3/dN0AAICvp16X8/Syzuyp&#43;u51nYsyyyjJoi66bi/A&#43;xMmAQBeoc4O2GeVi67bCfBRDHMFAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRKSJKVfBl23AQAAvg5hEjYmmXfdBAAA&#43;DqESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaO2frhsAR&#43;IiTddNAACAr0OYhCRJXXbdAgAA&#43;EoMcwUAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEpIkZV5q120AAICvQ5gEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDW/um6AXAkrrPsugkAAPB1CJOQJKmzrlsAAABfiWGuAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkxCkqSMyqTrNgAAwNchTMLGMOOumwAAAF&#43;HMAkAAEBrwiQAAACtCZMAAAC0JkwCLypNmZdB161o0d5pGXXdBgCAU/dP1w0Ajl1pMs&#43;sLrpuRwsXmZfUWdfNAAA4ZcIk8KzSZJ7l8QSz0qS/7/G7Ybeuy6/8FicBAD6SMAk8b5rU864bccd8f5gs1/XX7b26Kr8yL8u67Lq5AACnypxJ4BllnGEuum7FPc1hu9VFrnNVDtwbAIC29EzCE8rkUQ/Ysn5YrCqDjDJIk2SVi3rd9afftqrJ&#43;OhmS/7c/X&#43;ZpJ/lLuo&#43;7oO8yJ&#43;MjywKAwCcDGESnjJ61Af2Yb1cZZrb6qO9XJWfRzI8c5wml1034r66zjbclnWS9dNRt67KLOMyq6uu2wwAcIqESUiS1LNHD/3KZjGMJqMks6zzoL&#43;wNJkkuajrt713mWSUZJlZVpmmlw&#43;Mra3a1WSUxZeOYrOMMs4xzfgEADgZwiQ8oS42PWBlkFGS6z09YP3NM3nrMNBhklXO6jopvzLJ8kgGlo7S5EgG3L5OXZZVhuXNcR8AgMcU4IHu9ZJcbwJPXdazj5uZ2dIw&#43;dphMsl1mgy7bgQAwCkSJoG9Si/9LL98n94i2Q5XBgDgXRnmCieo9NJLsnpuvmNp0k8/TZJlVnsK/gyT5wfwlk392SbrLLMtc1PGGaTJOov6ysI9pZdhBkl6WWWZy7ouvfRePfB3GWESAOBDCJPQWvl7r0DOvNx9cll/HnSMQeb3HhiX8e72r83SIGWcyfaRdX5s&#43;gjLJDf77d7p3n4/08/4ZvGMssqvfXVhSy/jO/Vj9&#43;/ZT/JkGC39TNPPMoskwwwyLpe5zDz9zLJOP5MyPOwnce&#43;oTTbFiNaZZZkm44zKdUZJWewpkXSAui6r9Er/SKrjApyw0jxaUitJciR1AIAPIEzC&#43;3qPOqy9PUftb3sJb5/bd8pucnXv8V7m5efD/skyymTbznWW2Zz8e7nKj3u7PRMmSz/zJGebLwhllj9JxhmlyVldlCZXSfpl3K53svQzT5PkOufb6DzLfBt6X9&#43;7uEov/QiTAB9tvj9Mluv6q&#43;umAR9DmIT2fmxPl/3N0iD3gsqBoaUuyo9dMJwnme1K3axvetHqZVmk2b7Lzet&#43;lUGS4d1&#43;xXv79ZNc57Iutz2WTUa5V9CnDDPNpu/vZmjqppf0YYTtPfVpSpN5kl1Iratt32yTWV0kme4WVWlhFyWXt1866rLMtj2xrw&#43;Dywz2xHMA3ttRLGsFfCZhElqr6&#43;2iIZu7r1zIo65u&#43;v1Kkqz3HaUud&#43;9y&#43;9giKYNn9ru46Q&#43;sl2WY/v0&#43;vdJso&#43;TZnYGfyyzTz71exNLbftJ9Jmny67a/s9x&#43;fZglya56aosVKkuzjZK5H313X03eNkhKmAT4eD93PZOT9LPc/T43NgROljAJp&#43;V&#43;4ZtV&#43;g8GHY3TJPfnR9Z1Hs9ufC5&#43;jbKqd5cMuYmrN2V8LjNOsqizFu2&#43;GXi7eBCqb479tq8irpYDfLibS61JWeeJi6TAaREm4bTcXxfycd/gMK/uS925yONSPcmu97BelMXtYN1DlN5u2O71g8d794/9Ci36RwEAOJwwCUmSMs&#43;glrcfp3PPRqdtOHvjteJHZXUe9R62Dqu3M0Cf6Jd8cr3Ll9fBFCYBAD6EMAnfyaaf710HHt0pBf/64&#43;5mWT6oPPv8kS8yfNATu48hrgAAH0KYhO/nfePV7YzJ1/cBPjWY9dkZk3V50EzK/gH7APCi0sswgyS9rLLMZV2XXnpmRsJ39q&#43;6bgCclvL69RA/wybuHRKvXh4&#43;euPN/ZJ3fmb3wuG7zJgE4B2UpkzzZ1ul9TqrjPOnTPMn8zLvum1Ad4RJuKcMyri8uueuXGVerj6hma9s4XY5kuEBez7T51eG5Xf5U27mOe7tPSxXpR7crNvger9v8&#43;UZk4dSlh7gDUo/fzJKcp0f9aJe1PP8zM189&#43;O&#43;iAp8KGES7ii9zDPJ/ausbU6TTT5njt7rh25eJ&#43;mV8YPP3ZS/pZb7IXO9v5&#43;19HKVfnqZbF65a8vy3j7Dwwvf1KcK97x9LmayGUL71jAK8I2V/nYl4GX9dXNxry5zs/yTy3XwjQmTcFfvzn9v9PPUalmbU&#43;oucJVeBvmo6qF3ImoZvSFMXmaVZFJG9x4d74nAy&#43;wPxjev3Hz6XQC915c5SXJ&#43;p8X98rv8ffCed13vfoK3r2l2x377GpO&#43;6gC8Umm2UTK5uPfEzRnCRAT4xoRJuGsbBG9iT&#43;mVqwyS3fXXe&#43;oyqySjzcDYMsxmgOvL9UU3xx7cbEmSZnf/YYDbtGm86TcsgzLN9M4R&#43;je3tgGzf&#43;&#43;x5v5&#43;SV3nV9ZJpmVehqVJSr9cZZxkWe&#43;3fJnne0AvktJk/PiJMs0wl/fi9zj9NJmW3hPHunwYTcsgv2&#43;&#43;qNQDf6JPGLxiqRIAbky2v40X9YnFm7puINChanth292Yd90S24f&#43;f56n1tRktOfJ32meeNXg0UOTZ5/dbPMn3mezXT16l8mjff7eud3L&#43;NHzwz2P9XbH6&#43;fPy58xg&#43;z9W59e/qZmXJN&#43;fqdmlN&#43;pqZmmSbO9N3nwmqvtjfGTP//B9jNNMswk8/s/rTf8f&#43;2/9Qg2m8126Hbnt/Wg67a822fq7W6Onnh8zxky8/jda7N9i83SIHBPnZV1xnd65NaZ1Ysn916Us4x3V2cXD/rj1k8M/lkmWWX9xOzKR8Nk60VJhrvBt8vMss7Vbu/1o1es9wy1Xd3OG6zL8jOjjHZHXOU6lw&#43;L3NRFWe&#43;bL1pX5SxXmZRJklXO6qJcZ5JhRtsBsIucPeoJvEw/vVw/PZ&#43;0LsqPjNPPePtzO89g20/5tmvegxiCBfB6txMUnuiXfHOJNOALa1Fw8bva/YgW9azrtvBxyjyDWnb3eumln3VWhwyQ3Bah&#43;eAT6nahjHd8l5faXaYZ5df&#43;Qaalnybru/Mkt8N1n2lfGWTwdDB/tPffbfQ8e8sg1fI7/fx4wwqYAAcrk93Q/zf95jom5c/2wuOq/rj3&#43;HQbMy/3/V4v8wxyXX913Xrgo&#43;mZhI3ruz1gdZXV4f1Zdf0ZfV/bZT3e84gvtXuWUQb754A&#43;XjrkgC9OvRf32Cn93YzJt0TJXvq5FiUBXu2p9X6fnzF5keGhFQSAr0yYhCRJnb39GKemLssiw3Lxbn2h/f1fLcoow6xzeS&#43;g3g4dfotRniieBMDL7iwQdX8t4d6TITNJUpfK8sD3oJor8LSL7K3X&#43;hqlSX9fL2MZZppBhg/e52aWzhuubJcmo0fVBwE43O3FxPtjPMyYBJIIk8Az6jKXGZXm7UdKMn6il/H&#43;upVJkjLdXvNevKnHeJx7q10C0M7tiJEHF&#43;ZuytS5XAffnDAJPOcy65t1Ld&#43;i9NN/ovjOevvfbWwsgzLfBszrvKF4Q&#43;llnEvzJQHeZDs&#43;5O46waXZrQpsMCt8c8Ik8Iy6zq8MyuhtRym9XOWpOq6XWSVpMi3zMi9/Ms8gyXXO6q83DZ&#43;6yqxedvNTAzgZl9tLfjfxMWWQ37sSaYrswDenAA/wrLosv3JVlvUN15/rqvx8KhjWZX6UQW6qty6zzvLts3DKNKmGuAK80eYckCaT0mSZfvp3ViA2yBW&#43;PWESeEFdlLNclbO3DBl9PhzWxft&#43;JSmTJNaFBXgHdVF&#43;ZJx&#43;xknWWeQ8g20/pUGu8O0Jk8CL6rKc5StV7Lt&#43;Sz8qAHfV9f2JCmWyvaFnEr49YRI4wNcqZCNKAnyU0t/NmBQm4dtTgAcAgD3KqMzLVenfe/BmzqQoCeiZhI0ySb&#43;aZQcAW2W4Wxrq7kJNN/W9VXIF9EzC1t36dADATWy8M2e&#43;TLNZcXJRZ103D&#43;ieMAkAwGPr7X&#43;3sbEMynwbMK/v9VUC35ZhrgAAPHaZfnppMi3rJL1tn&#43;R1ZkrvABvCJAAAj9RlfpRBbqq3LrPOMsv6lRaKAj6YMAknrAwzSi&#43;/LJUBwGvUhaqtwNPMmYRTNs0gvcyL4kIAALwzYRJO2WYwUpN5mZSm68YAAHBKhEk4ZbeF28f5I1ACAPB&#43;hEk4YfUyF7s7Tcb5U67KSKSEz1L6ZVB6XbcCAD6GMAknrV7mZ1a7u02GmeZvmZeJUAkfqwzKn1xlnHm58q8NgFMkTMLG8lTr1dVl/ZHzO4EySQYZZ5px122D01VGmWdVf9SzXGaQSdftAYD3J0xCkqRe1LOu2/CBn25Wf&#43;S/yv/nwcP9rtsFp6o0mSS5SMok0zQZdd0iAHh/wiR8A2VU5vmv8//Oj1zkds3J667bBSdrnCapyySbhXms9QrACRIm4aSVXpmUP5lmkGSYdb3Mzdyt6zp7y5GBZ4yS7dD5RZJVzrtuEAC8v3&#43;6bgDwUcogw3uD65qMyjqbypJrX27ho5R&#43;mmx7I&#43;vFnZrKAHBShEk4QaXJMOM8XpDgNlrO6rrrVsLJ2gxtXb3xKABw5IRJOEW9TPc8OstqW1NyncuumwgnbHMhxzxJAE6cOZNwgurywdfYVS7yL/V811epXxI&#43;Uj/Zlt&#43;Bb6D0yqD03n4c4OsRJuE03RbXuc6v&#43;qNe1nWS4aNngffXT0515Vp4qPTyO/P8Kb/LpAwePneaMbPUMu&#43;6DXAcDHOF03SdSZJZZnU3b6sMt5Vcl9VcLvgwxYxJvpebc0s//YxLst6NjWnST7IuZ/rp4VQJk/CFlSajNHVPrci67&#43;Td3/5pfUn4AGWY8e5fWTIqm4JXy/qz65bBh3p44aTJ4MH9vhnEcKqESUiyKeVfv9SwtNLPaHM9uMz29TTuuQ58M9TISR0&#43;wjKLLJL0M0gyy2Zmsh5KTt3Lc/CddeBkCZOwMckgpetGHKqMMrrbA3LgOnbN9k&#43;ndfgAdbX5l7iZS1Wt5Mo3URf3Tp7/W/71nXvrXOfaIFc4XcIkfCmll1FGu1i4MWy5KHpfaRD4QP3oj&#43;QbKffPSP86y/qzDJKshUg4fcIkfCHlaleP9a6m9A86ZV9nc3oXJeHDlF6a6P/nO&#43;k/vF&#43;meubhuxAm4StpHj2yyHU9cKGPOitJT/kd&#43;FCbL9Z6Jvl&#43;1rtz1KgsDz0zAV&#43;bMAlfyfWdGnnrXGfWbhCRkzt8uE2Y1P/P93FT3O3/kf/7Lk5Oy9IgV/gO/lXXDQAOV2fb/o5VzvOjnjtVw9HZfLH2b5Pv4yZM/ruc3Xl0XprXHAz4WoRJOEpPnoSvM8tZ/VFn9eVi7MDn6ydZ&#43;/fJN3IzZ3JZl7k7V7L3moMBX4thrnB0yjCjDMqPvatHtqvbCnyq0qQX/ZJ8I6W5mX5RF0mdlX5GSZY5O&#43;lLKpfmRcOGMAlHpDQZZ7i9mnvo6pHA8dj00QiTfB&#43;j7Z/becL1vPSzPPVqri7swg1hEo5EGWS4OyknwiR8RZs&#43;GmGSb6I0GW9v7iqF159dtwr4POZMQudKU0bld&#43;b3omTSlNErDwh0ZTPbWZjku&#43;hv/86vLTsF35OeSdi4SHd156YZ7nl05gspfDn9JKlmU/FdLLerS56f9AxJ4EnCJCRJOl1k4/pBmFzlOpdOzPAF9WONSb6Rui4/M8jCBRT4roRJ6Fy9LqtdCfVFZtVgIfiSihmTfDt1lVnXbQC6Y84kHINZknUu86OeiZLwZW1queqjgUeKVSfhJOmZhE9TmgyfGAw0yzrXBrbCF7eZeW2YK9xTmkwzKD&#43;c5eD06JmET1F6ZZo/me6KqN9T13XmJAtfXj/JyuwxuKv0M88wTeZdtwR4f8IkfLgyKvP8yShNkmHprmos8LEGiQUS4K7Sy3w7ALxfpl23BnhvwiR8oNIrk/In0&#43;1C5knS7F0GBPjyyuYLszAJd9TVnZJUo1NZP7lMTuWTwFsJk/BBSr9M8yfjPCw6IEzCCSmTMi&#43;b4euDJKtOlxmCY/TrTlGqaRm84UjHY&#43;xcDhvCJHyUJo&#43;vWy5zXs&#43;6bhjwXsok4wwySbKZMXnZdYvg2NR1fuW2KsCVuq5wSoRJ&#43;CB18WC1uVl&#43;1p/VelxwSnaLgZQmw6z8C4fH6jIXuztNrtQOgNMhTEKSzVC1dz/ozdfKVS7yL/Xc8Dc4Oausc51fScZZ51fXzYHjVGd3eu3727584AQIk7DRz/vP47jefM2sP&#43;qlhT/gJF1klXWGZZpRzlwwgqfUizsrsI6KGYdwIoRJeKMyKFf7y53Xdf2X&#43;quq7Qgnq67rzyySLPNDlIRn3RbiuXRmhFPxT9cNgK&#43;rNBlltKnWWi70PcL3VK8tBwIvq&#43;vyK/Mk56IknA5hEl6l9DO6V611fKe8AADwQF2Wc8vnwGkxzBVaK6PyO78fLPxh/gcAPKtei5JwWvRMQiull9/ZV9R8WXp11fpwAADwRemZhFbqKg&#43;vqq5zmR/1lygJHJcyLLVcdd0KOEGL6GGFJHomob3rO4uILHJtkXLgSI2SDMtQuRN4X/Ws6xbAsdAzybdXemVS5hkk5XeZlBdXm6yzrJOsM8uPeiZKAkdrM15i9MajAMAThEm&#43;uTLJn4y3fY39jDMvV6VJktI8GSwvc54f9dzAVuCoXSZJBkWc5IiVfpl03QbgtQxz5Vsr0z3X7Ifplf88/7eM0pQf&#43;wJjvey63QAvq6tymXGSaYlRFBynMso0KWtnVvia9EzyjZXJE8O/&#43;vnvM04Tw8OAr&#43;1yWyZkUvpdNwUeK9NMkyQHTDIBjpEwybdVehm/uJMwCXxhdZ2zLJM0mRvsyrEpvTtrNF&#43;VXtftAdoTJvm&#43;hgfs0/j6BXxldZ3zrJM0mZqZxnGpq1zs7jTZViwAvhJzJvm&#43;Xh5Ss8wsSurDkSmjgy4Fcev/m/8k/36ScelH6TCOSJ3dGSXUzyTnXbcIaEeYPGqln/3XkS/qnsVyyyT75sQs68Wefdsdeb53370rLD71NW//mkytjvzen&#43;&#43;lGUT/bf2/furna3HkL/83w&#43;qcvEXvgEtB7DfI7/JTnOR41Is7g11HZaUQD3wtwuRxa574yrR/IEi/xResdkfev&#43;9y76Ptvua1OfJ7f76XhtP8Hz/587U58lf/m7F/D&#43;DjNS/&#43;7oPPdZ7e7pLnpKyqEUHwhZTadQuO3u5HtNjf98RXVebPR6xaum4hsE&#43;ZHFA8i/3WOfdV/ePc&#43;bt5Vhddt&#43;brKP3Mdxc51jmrR3/BsQyyPv5WwmdQgIfva/mGZ4HO1ItabIdv&#43;Zfd77Pr/BAlOT51&#43;eXmSs6jnBUkESb5zq7f8CzAVzHdDiGc1V913XVjYJ96nc1cyWV&#43;6PGDr0SY5NuqyzxdBEYJAOAklOm2uMl5/Wp9P3wr9SLXmdWfLnjA16IAD9/ZRfp765yu86vrpgG8XRlns1bupQrKHLvqzAtfkJ5JvrG6zlkel0hYfYXJ/wAvKc22HMxs30JAAPBWwiTfWl3Xs/y6Mz9ymYtqvgZwGsZpkqwMcAXgYxjmyrdXr3OdlP9X/lOLgQAnZTOMX68kAB9EzyRs/C9dNwDgnS2TrGK9QwA&#43;iDAJACepXuRn/aE6Jl9Z6XXdAuA5wiQAnCgzwPnKSlOu8rv0334k4KMIkwAAHJnSzzzDNJmWpuu2AE9RgAdaKaMM0qTJOsvM6ipJyjiDNFlnUS&#43;7bh8AfH2ll3k2IbKf6dGt/nwWw8chiZ5JaKH0y&#43;9M08syi/Qyzp8yKU35ncm2xMWk/O66jQDw9dW7paOGZdJ1ex60bmEIOWzomYQDlX7mSc7qIknKLH&#43;SjDNKk7O6KE2ukvTLWO8kALzZeXq5mS85Lst6/aajAR9CzyQcpDSZJ/lZt1dKNwNckzSZ1UWSaQbb&#43;wDAG9V1zu8MJp0qxAPHSJiEJEk9q&#43;XZHSZpcr6LkLlTDmCWJBlu760CALxZXeZ8d0chHjhKwiQcZpTVvSE2g&#43;2fq&#43;28ic3g1kWddd1QADgN9ToXuzv9TLtuD/CQMAmHubhzfTTJbh7HzbDXi5zlZz3rupkAcDrqZW4v0g7LqOv2APcpwAMHeVRW56ZnclfPrS4OPxoAcJCL9LcXcC&#43;N/oFjo2cSXqE0D3smAYD3V9f5lXXW&#43;VUv3n404H3pmYTXuJ0xqeAOAHyguipniZUd4RgJk/Aa&#43;iUB4JMIknCsDHOFg5Rh&#43;V3&#43;7Kb&#43;P5oxmSTlqtSu2wkAfKwyL5Ou2wDHQc8kHKD0cpUkmWR2b8bk8t4&#43;Q6tMAsDJG7z9EHAa9EzCIW56JNdJkuHNw/cG3kySB8uHAADAyRImoY2LpDQZP36iTDPMpeVBAAD4LoRJSJKU&#43;bPzHWdZJ7mo16WfeXo53wxwLdPSlKaMyu&#43;McqloOQB8jtIv067bAAiTcIC6yllWmZSa32lyVmc5yyzrjPI3fzPNOmeiJAB8jjLK74yUwYGuKcADB6nL/Cj9NFlv5knWdc5zXjZT8Jd13XX7AOC7KNNtLYNxWdVZ162B70yYhIM9XufKHEkA&#43;Fyld1sIL5OytAoldMcwVwAAvoy6yq/dnSZXpem6RfB9CZMAAHwhdZHbOgU3K0EDHRAmAQD4UuplbudKDhTiga4IkwAAfDUXuZ0rOS6jT33vRczThCQK8AAA8OXUdfmV37mZL/mphXjqWdefHo6FnkkAAL6ce4V4gE4IkwAAfEF1kfMkyTI/LBACXTDMFTauzX8AgK&#43;lzko/qeddtwO&#43;K2ESkiR19vZjAACfS5CELhnmCgAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAwEkp/a5bAN&#43;DMAkAwMkoTbnK74&#43;Mk2UgrMKGMAkAwIko/cwzTDIvzYe9yTyTrj8nHAdhEgCAk1CazLPpNWwy77o1cPqESQAATkJd53p3p1&#43;mXbcHTp0wCUmSMiqGrADAF1fPs9zdGZVR1&#43;2B0yZMwsYw466bAAC82VnWu9tTpXLgIwmTAACcjLrO2Z27H1mIB749YRIAgBNSlznf3VGIBz6QMAkAwEmps8x2d/pmTsJHESYBADgxdwrxXNbZmw4FPOmfrhsAAADv7ix/kpzX6zcfCXiCMAkAwMmp63KW1OXbjwQ8RZgEAOAEfVSQrKXrTwbHwpxJAAAAWhMmAQAAaM0wV9gwpwIAAFoQJiFJUi&#43;6bgEAAHwlhrkCAPBNlH65Kk3XrYBToWcSAIBvoYwyTbLOedctgdOgZxIAgG&#43;gTDNNkozKuOu2wGkQJgEAOHmlyWB3Z1IGbzgUsCVMAgBw8uo6v7Le3b0qva5bBF&#43;fMAkAwDdQl7mt3d5EIR54M2ESAIBvoc5yubvTz&#43;R1Rym1zLv&#43;JHAchEkAAL6JepHF7o5CPPBGwiQAAN/Hr6x2txXigTcRJiFJUvpOJwBw&#43;u4V4lnfKckDtCZMwsYk5j8AwDewK8SzzI&#43;67Lo18JX903UDAADgM9VZ6aXJRdUvCW8iTAIA8M3Ui7cfAzDMFQAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAJKU/kG7Xea665bCcRAmAQD49kpTpvldhi/vWS/qrOvWwnEQJgEA&#43;OZKL/OMkkwP7J0EIkwCAPDNlSa/swmRTaal6bo98FUIk7BxkbOumwAAdKGucztwtZ9p1&#43;2Br0KYhCRJXdZF120AALpRL&#43;4U1RmWSdftga9BmAQAgPMsd7fHhxTiAYRJAAC&#43;vbrOeda7uwrxwAGESQAASF3mfHdHIR44gDAJAABJ6nUud3f6GXXdHjh2wiQAACS5V4jnsl6&#43;6VDwDQiTAABw4zzLrHNeL57aoUyKPktIkvzTdQMAAOBY1HU5T&#43;rymV3GWdxZlxK&#43;MWESAAB2ng2SwB2GuQIAANCaMAlJkjIp867bAAAAX4cwCRv9DLpuAgAAfB3CJAAAAK0JkwAA8KzSL1el6boVcGxUcwUAgGeUUSZpkvzquiVwXIRJAAB4UplknCQZln&#43;T/y79JP9xGWdhCREQJgEA4Gm3Jfr&#43;y/yXSZL/UyZJWeRCoOR7M2cSAACe9ivrvY8PMi&#43;jrhsHXRImAQDgSXX15FzJJpPS77p90B1hEgAAXqfJtOsmQHeESQAAeM7kmef6Zdh186ArwiRsLLPougkAwPEpTZ4fyjo48EBwclRzhSRJvei6BQDwemWwP9LsP7&#43;V/T1ti7rnwmoZpbdn31Wd7dm3l/0FaWZ19cYjf9zne/nIL82K/M9K782fr91P7n0/32uP/Cl/M3xDO3LV9sK2uzHvuiU2m81ms9mOd8tkd3PQ6bvf257Ye//Dk737zvfuu/d7UQZPHHnw5iN/3Od78chPfqr3/HztfnLv&#43;vmO&#43;2/GSz96W7ebnkkAgK9v1mq6xtneR1d7H71Is&#43;fR/YtlLJ848v7VGNsc&#43;eM&#43;X7sj7/Nv3&#43;HztfvJfdznO&#43;a/GRyhUrtuwdHb/YgW9exNBwIATliZZLy9eVbNwz8pL3xhvjQUk&#43;9KAR4AAHjO9RuehRMmTAIAwHMun3luUZcHHwdOjDAJAADPqMsn4&#43;Q6v7puHXRHmAQAgGfVi71xcpWzum59MDgZwiQAALygXuTsXl3UdS7z0xBXvjdLgwAAwIvqIovSSz9X&#43;R/yX6jYC8IkbJV&#43;GqcFAOA5dZVVSf5H3xkgMcwVbkwy77oJAADwdQiTAAAAtCZMAgAA0JowCQAAQGvCJAAAHIXSlHkZvPrV0zLq&#43;hPwvajmCgAAn6L002T91OqUpck8szdUir3IvKTOuv6UfB/CJAAAfLjSz1VWWaZfkl91/ej5JvMs3xIF67r8ym9xks9jmCsAABzuLBftX1R6mWdVz3KZVfrZNxx1mtTztzWtrvIr09Lv&#43;kfEd6FnEgAADvbKYajTNFkkmWSUpPfw6TLOMGfv0bpynavy83HPJ7w/PZMAAPChSj&#43;DJIskTZLk&#43;sHzTcZvmi1510V6GXf9ifkehEkAAPhYwySpyyQXuczZo9g4TpPL93mrusos49J7&#43;5HgJcIkJEnqWS1dtwEAOFH9bPolU1f14mGULE1GWdTVu73bLNE3yWcQJgEA4GP1kyyffHaU5uHA17eoy6wyLE3XH5rTJ0wCAMAHKr00SZ7ueRwm7xkmk1yn2QythY8kTAIAwEfaLNXxRJgsvfSzfOfqq4skg64/NqfP0iAAAPCR&#43;skzS4oMs51P&#43;ZQyyiBNmqyzzGwzt7KMM0iTdRZ1X&#43;GeZYRJPoGeSQAA&#43;ABlUGqppW6K4Wxul/pot36eGQJb&#43;uV3pullmUV6GedPmZSm/M4kq826leX341fVdVZpSr/rnwCnTpgEAIAPUBeb/JhVkuttlnxcPf6ZMFn6maeXs/qzXtSLnCVJxvmTfs7q&#43;XYxkX7ZV7l1lZvhtfBhhEkAADhYmZdJy5f08lz5nV6eqPRamsyT/LwZILtbPKTJrC6STLdDWffVbV1ujwwfyJxJAAA4XMu5iGWz/xOzIksvSZ4ovzNJk1&#43;360/eWexjliS7eq1PBVVhkg&#43;mZxIAAD7OZrDpU6tMPhf4RlnVu0uG3MTYVd0cbTPMdVFnT7zeSpN8MD2TAADwcXpJVq9a&#43;uPiQQS9mQN5M&#43;z1oiyyrvtj6irw4YRJSJKUeQZ7psQDALzNs9Van/No0Y&#43;bnsldfKxPLykiTPIJDHMFAICP08/Tg1xbKM3DnslnGeLKJxAmAQDgg5TnZ0y2cTtj8pBeR8uC8AmESQAA&#43;CgvhcnD51K26ZeETyFMAgDAR&#43;klWT/dl1if6bMsw/K7/Cmj7d1HMyaTpFyV&#43;uQB3qM/FJ4hTAIAwEd5ecbkercW5T2ll6v008skuTdjcnlvn&#43;ETpXZ6adPrCa8iTAIAwEcZ5KUwucz&#43;cjk3PZKbSDi8efheX&#43;YkyfneozYvvi&#43;8mTAJAACHWxwe0kovyUvLdCzzfLmci6Q0Ge85&#43;jTDXD6xPMjg2YVD4F0IkwAAcLB6Vi8O3vmQWq6L7A&#43;Ts6yTXNTr0s88vZxvjlOmpSlNGZXfGeVyf1tKPwr18AmESQAA&#43;Bj9JOv6bJisi6yzZ85kXeUsq0xKze80OauznGWWdUb5m7&#43;ZZp2nY&#43;0gwiSf4J&#43;uGwAAACfqsB7C64zKsF4/fLgu86P009zE0brOec63xXqW9bnyOsMk14EPJkzCxrVJ6gDAO&#43;vlkDA5yyiD/eHvca/myzMhSy/9XNfVS/vBWxnmCkmSOmsx/wEA4EmlKU2SlF56OaCHsC6zyLA0Lx74UKMks65/CnwHwiQAALybMsrf/C2DbGYuzuohqz1eZG&#43;91le9f5NRFiq58hmESQAAeD&#43;TJJsBrv0kl4e8pC5zmdE79U2O89Tak/DOhEkAAHg/TZJlrksvo1wePHPxMutM3/7mpZdxi3eFNxEmAQDg/VxmlYv0c5UWFRnqOr8yKKM3v/tVZvWg3lB4O9VcAQDg3dSLssggTS7azVusy/IrV2VZ31BfvkyTaogrn0aYBACAg5XBzbqPT6mLA5YD2fu6cparcvbaQaplkuSs658P34kwCQAAh5tn8VGRrS7LWQ6p/rrf9Vt6NaE9YRIAAI7EW0rniJJ8NgV4AAAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABo7Z&#43;uGwAAAF/IWdZdNwGOgzAJAAAHq4uuWwDHwjBXAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAOBgpZZ5122A4yBMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCnIAyKNMy6roVAMB38k/XDQDgrUqTeZKUdb3uui0AwHehZxLg6&#43;tv/9Q3CfDxLuPCHSTRMwlwClbbPwdlUBddNwbgtNWLrlsAx0LPJMCXV1e7q&#43;RXpdd1awCA70GYBDgFF1knSZpclabrxgAA34EwCXAC6iqX25v9zMVJAODjCZMAJ6FeZra9KU4CAE8ovdJ/&#43;1E2hEmAE1HP78TJP&#43;93ogAATkXp53d&#43;l6v3OdorqrmW3jctPv8flUnXTQB41v&#43;af5f/IEnSZF4u6&#43;UbjwcAnJZRmiTD96n//pqlQXoZd/0z6MR/&#43;E0/N/A1NZmUYc7quuuGAABH4&#43;Z7wSjvECYNcwU4Xf1vOpIEANjvJkIOyzt8RxAmAQAAvoW62K1NPXl7fQVhEuBUrWPWJMC7K5P36NGBztyuTT1/a5x8zZzJZc66/gl8qvn2z39rziRw5P7Pucy/t729zHlddt0ggBM0zmJXPRu&#43;nLoqF5kmSZpclV9v&#43;bbwijBZ1&#43;8xWfPrKDc3/r5HxSOAj1KaTHdRcpYLpXcAgMfqrGQbJ3uZl1&#43;vTzmGuQKchNJknt72zmU9FyUBgP3qLDcTYZrMy6vHX5ba9Sc5ersf0aJ&#43;r&#43;G9wJdSrjLc3rysF123BjbKxBQRgC9gkYvXDHfVMwlwAspgFyVnoiQA0MpgVyemFWES4BRMt38u6nnXTQEAvpymNO1fJEwCfHmlv5stKUoCAO3NXlNt4TVLgwBwXG6uJV7WVddNgXtW36oC/H&#43;U/3B769/mb9eN4QMN8j/nv&#43;&#43;6EfBG/17&#43;L/k/bG&#43;vc16vX3MQBXhepAAPcPzKn/SS/LSyJHTnTrmhM8uJnbJSfSvkqytN5ulv7yxz9toa8HomAU7Bz/Sz0i8JALzkXpScvaXagjAJcALq&#43;lsNJgQAXm/6PlFSmAQAgBZq6boF8BZldGc5sTcW7lPNFQAA4FsoTSbbm8u3LycmTAIAAHwPo20N&#43;HXeoYyUMAkAAPA93KxMffnaCq53CZMAAADfw6by&#43;zqvWlfyIQV4AAAAvodZmvRy/T7LiQmTAAAA30Jd5&#43;L9jmaYKwAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAABys1DLvug1wHIRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABo7Z&#43;uGwAAAF/IZVZdNwGOgzAJAAAHqxddtwCOhWGuAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAMDByrxMum4DHId/um4AAAB8IYOuGwDHQs8kAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAHC4RZZdNwGOwz9dNwAAAL6OetZ1C&#43;BY6JkEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGhNmAQAAKA1YRIAAIDWhEkAAABaEyYBAABoTZgEAACgNWESAACA1oRJAAAAWhMmAQAAaE2YBAAAoLV/um7AF7DY/rnsuiEAAADHQph8UT3rugUAAADHxjBXAAAAWhMmAQAAaE2YBAAAoDVhEgAAgNaESQAAAFoTJgEAAGit1K5bAABwAkovve3NZV133RqAjydMAgAA0JphrgAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK0JkwAAALQmTAIAANCaMAkAAEBrwiQAAACtCZMAAAC0JkwCAADQmjAJAABAa8IkAAAArQmTAAAAtCZMAgAA0JowCQAAQGvCJAAAAK397zRrxHuKRA5dAAAAAElFTkSuQmCC " alt="" /></div>
<p> You can see the direction <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span></span></span></span> in the output being transformed into the input space. This is how we propagate the gradient through <code>func</code>. If you have the gradient of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">x</mi></mrow><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span>, you can compute </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext mathvariant="monospace">Jt_func</mtext><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mo stretchy="false">)</mo><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mrow><mo fence="true">(</mo><msub><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi mathvariant="bold-italic">y</mi></mrow></mfrac><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">y</mi><mo stretchy="false">)</mo><mo fence="true">∣</mo></mrow><mrow><mi mathvariant="bold-italic">y</mi><mo>=</mo><mi mathvariant="bold-italic">x</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\texttt{Jt\_func}(\bm{x}, \bm{g}^{\intercal}) = \bm{g}^{\intercal} \left(\left.\frac{d}{d \bm{y} }f(\bm{y})\right|_{\bm{y}=\bm{x}}\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord texttt">Jt_func</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mclose">)</span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.462em;"><span style="top:-2.266em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.864em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.3333em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.3333em' height='1.216em' style='width:0.3333em' viewBox='0 0 333.33000000000004 1216' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V1216 H145z M145 0 H188 V1216 H145z'/></svg></span></span><span style="top:-4.072em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.6886em;"><span style="top:-1.7003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03704em;">y</span></span></span><span class="mrel mtight">=</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">x</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1358em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span>
<p>Where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi mathvariant="bold-italic">y</mi></mrow></mfrac><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">y</mi><mo stretchy="false">)</mo><mo fence="true">∣</mo></mrow><mrow><mi mathvariant="bold-italic">y</mi><mo>=</mo><mi mathvariant="bold-italic">x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\left.\frac{d}{d\bm{y} }f(\bm{y})\right|_{\bm{y}=\bm{x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.9978em;vertical-align:-0.8358em;"></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03704em;">y</span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mclose">)</span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em;"><span style="top:-1.966em;"><span class="pstrut" style="height:2.616em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em;"><span class="pstrut" style="height:2.616em;"></span><span style="height:0.616em;width:0.3333em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.3333em' height='0.616em' style='width:0.3333em' viewBox='0 0 333.33000000000004 616' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V616 H145z M145 0 H188 V616 H145z'/></svg></span></span><span style="top:-3.172em;"><span class="pstrut" style="height:2.616em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.3886em;"><span style="top:-2.0003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03704em;">y</span></span></span><span class="mrel mtight">=</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">x</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8358em;"><span></span></span></span></span></span></span></span></span></span> is the Jacobian matrix of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">x</mi></mrow><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span>. <a href="https://en.wikipedia.org/wiki/Leibniz&#37;27s_notation">Leibniz&#39;s notation</a> is insane, so we&#39;re going to adopt the notation from <a href="http://www.strangebeautiful.com/other-texts/spivak-calc-manifolds.pdf">Spivak</a>, and <a href="http://ceres-solver.org/spivak_notation.html">other</a> <a href="http://www.vendian.org/mncharity/dir3/dxdoc/">people</a> <a href="https://mitpress.mit.edu/9780262019347/functional-differential-geometry/">agree</a>. Thus, let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi mathvariant="bold-italic">y</mi></mrow></mfrac><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">y</mi><mo stretchy="false">)</mo><mo fence="true">∣</mo></mrow><mrow><mi mathvariant="bold-italic">y</mi><mo>=</mo><mi mathvariant="bold-italic">x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Df(\bm{x}) = \left.\frac{d}{d\bm{y} }f(\bm{y})\right|_{\bm{y}=\bm{x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.9978em;vertical-align:-0.8358em;"></span><span class="minner"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03704em;">y</span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mclose">)</span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em;"><span style="top:-1.966em;"><span class="pstrut" style="height:2.616em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em;"><span class="pstrut" style="height:2.616em;"></span><span style="height:0.616em;width:0.3333em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.3333em' height='0.616em' style='width:0.3333em' viewBox='0 0 333.33000000000004 616' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V616 H145z M145 0 H188 V616 H145z'/></svg></span></span><span style="top:-3.172em;"><span class="pstrut" style="height:2.616em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.3886em;"><span style="top:-2.0003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03704em;">y</span></span></span><span class="mrel mtight">=</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">x</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8358em;"><span></span></span></span></span></span></span></span></span></span> be the Jacobian matrix. Let&#39;s rewrite the equation: </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext mathvariant="monospace">Jt_func</mtext><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mo stretchy="false">)</mo><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
\texttt{Jt\_func}(\bm{x}, \bm{g}^{\intercal}) = \bm{g}^{\intercal}Df(\bm{x}).
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord texttt">Jt_func</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<p>Much better. Now, why does composing <code>Jt_func</code> work? We&#39;ll hold off on that for a bit, but jump to <a href="/blog/2024/01/05/autograd/#what_is_going_on">the section that covers it</a>. If you&#39;re confused right now, that&#39;s entirely fair. We&#39;ll go through many examples, and then I&#39;ll explain the underlying theory. I&#39;ve just said this stuff so it will click later on.</p>
<p>The way we figure out what these <code>Jt</code> functions should be is just evaluate <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}Df(\bm{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span> &#40;which you should think about as taking direction <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span></span></span></span> from output to input&#41; for a given <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>. Let&#39;s start with the functions I introduced in the simple neural net at the beginning of this article. </p>
<h2 id="jt_subtract_const"><a href="#jt_subtract_const" class="header-anchor"><code>Jt_subtract_const</code></a></h2>
<p>We will start with <code>subtract_const</code>. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><mi mathvariant="bold-italic">x</mi><mo>−</mo><mi mathvariant="bold-italic">b</mi></mrow><annotation encoding="application/x-tex">f(\bm{x}) := \bm{x} - \bm{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span></span></span></span> with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">b</mi></mrow><annotation encoding="application/x-tex">\bm{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span></span></span></span> a constant. We can calculate the derivative by plucking it out of the taylor series: </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><msup><mi mathvariant="bold-italic">x</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
f(\bm{x}+ \Delta \bm{x}) = f(\bm{x}) + Df(\bm{x})\Delta \bm{x} + O(\Delta \bm{x}^2).
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mord">Δ</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">Δ</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<p>We collect terms, and the coefficient of the first-order term is the derivative. We can do this for our function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> : </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>−</mo><mi mathvariant="bold-italic">b</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="bold-italic">x</mi><mo>−</mo><mi mathvariant="bold-italic">b</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi mathvariant="bold-italic">x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>I</mi><mi mathvariant="normal">Δ</mi><mi mathvariant="bold-italic">x</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
f(\bm{x}+\Delta \bm{x}) &amp;= (\bm{x} + \Delta \bm{x}) - \bm{b}\\
&amp;= \bm{x} - \bm{b} + \Delta \bm{x} \\
&amp;= f(\bm{x}) + I\Delta \bm{x} \\
\end{align*}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord">Δ</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>Thus, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">Df(\bm{x}) = I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span> the identity matrix. So, If we want to calculate <code>Jt_subtract_const</code> we need to figure out what <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mi>I</mi></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span> is, which is simply <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span></span></span></span>. Thus,</p>
<pre><code class="python hljs"><span class="hljs-keyword">def</span> <span class="hljs-title function_">Jt_subtract_const</span>(<span class="hljs-params">x, gt</span>):
	<span class="hljs-string">&quot;&quot;&quot;x: ndarray shape(n,)
	   gt: ndarray shape(1,n)&quot;&quot;&quot;</span>
	<span class="hljs-keyword">return</span> gt</code></pre>
<p>Let&#39;s do a harder one.</p>
<h2 id="jt_square"><a href="#jt_square" class="header-anchor"><code>Jt_square</code></a></h2>
<p>Now <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><msup><mi mathvariant="bold-italic">x</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">f(\bm{x}) := \bm{x}^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> element-wise. Remember, to find the derivative, we take </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi mathvariant="bold-italic">x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi mathvariant="bold-italic">x</mi><mn>2</mn></msup><mo>+</mo><mn>2</mn><mi mathvariant="bold-italic">x</mi><mo>⊙</mo><mi mathvariant="normal">Δ</mi><mi mathvariant="bold-italic">x</mi><mo>+</mo><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><mi mathvariant="bold-italic">x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>+</mo><mn>2</mn><mi mathvariant="bold-italic">x</mi><mo>⊙</mo><mi mathvariant="normal">Δ</mi><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi>O</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><mi mathvariant="bold-italic">x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
f(\bm{x} + \Delta\bm{x})&amp;=(\bm{x} + \Delta\bm{x})^{2}\\
&amp;=\bm{x}^{2}+2\bm{x} \odot \Delta\bm{x} + (\Delta\bm{x})^{2}\\
&amp;=f(\bm{x})+2\bm{x} \odot\Delta\bm{x} + O((\Delta\bm{x})^{2}).\\
\end{align*}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5723em;vertical-align:-2.0362em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5362em;"><span style="top:-4.6721em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-3.1479em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.6238em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.0362em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5362em;"><span style="top:-4.6721em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.1479em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord">Δ</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-1.6238em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">((</span><span class="mord">Δ</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.0362em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>With <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊙</mo></mrow><annotation encoding="application/x-tex">\odot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">⊙</span></span></span></span> as element-wise product. Thus, </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>2</mn><msub><mi>x</mi><mi>n</mi></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">
Df(\bm{x}) =
\begin{bmatrix}
2x_{1}&amp; 0 &amp; \dots&amp; 0 \\
0&amp; \ddots &amp; &amp; \\
&amp; &amp; \ddots &amp; 0\\
&amp; &amp; 0&amp; 2x_{n}\\
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.8001em;vertical-align:-2.15em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">⋱</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">⋱</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>Multiplying this with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span></span></span></span> gives <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub><msub><mi>g</mi><mn>1</mn></msub><mo>…</mo><mn>2</mn><msub><mi>x</mi><mi>n</mi></msub><msub><mi>g</mi><mi>n</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[2x_{1}g_{1} \dots 2x_{n}g_{n}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>. So,</p>
<pre><code class="python hljs"><span class="hljs-keyword">def</span> <span class="hljs-title function_">Jt_square</span>(<span class="hljs-params">x, gt</span>):
	<span class="hljs-string">&quot;&quot;&quot;x: ndarray shape(n,)
	   gt: ndarray shape(1,n)&quot;&quot;&quot;</span>
	<span class="hljs-keyword">return</span> gt * (<span class="hljs-number">2</span> * x.reshape(<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>))</code></pre>
<h2 id="jt_arctan"><a href="#jt_arctan" class="header-anchor"><code>Jt_arctan</code></a></h2>
<p>Now <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><mi>arctan</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(\bm{x}) := \arctan(\bm{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">arctan</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span> element-wise. Now we&#39;re going to exploit the fact that the Jacobian is a matrix of partials. Since it&#39;s element-wise, we&#39;re dealing with a diagonal matrix. This gives us </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msubsup><mi>x</mi><mi>n</mi><mn>2</mn></msubsup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">
Df(\bm{x}) = \begin{bmatrix}
1 /(1 + x_{1}^{2})&amp; 0 &amp; \dots&amp; 0 \\
0&amp; \ddots &amp; &amp; \\
&amp; &amp; \ddots &amp; 0\\
&amp; &amp; 0&amp; 1 / (1 + x_{n}^{2})\\
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.8001em;vertical-align:-2.15em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">⋱</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">⋱</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>So it makes sense that </p>
<pre><code class="python hljs"><span class="hljs-keyword">def</span> <span class="hljs-title function_">Jt_arctan</span>(<span class="hljs-params">x, gt</span>):
	<span class="hljs-string">&quot;&quot;&quot;x: ndarray shape(n,)
	   gt: ndarray shape(1,n)&quot;&quot;&quot;</span>
	<span class="hljs-keyword">return</span> gt * (<span class="hljs-number">1</span>/(<span class="hljs-number">1</span> + x**<span class="hljs-number">2</span>)).reshape(<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>)</code></pre>
<h1 id="what_is_going_on"><a href="#what_is_going_on" class="header-anchor">What is going on</a></h1>
<p>You might be thinking: I&#39;m familiar with multivariable calculus, I love a good dual space, but what is going on here? To answer that, we&#39;ll look again at what a derivative really is. Given a function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>:</mo><mi>V</mi><mo>→</mo><mi>W</mi></mrow><annotation encoding="application/x-tex">f:V\to W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span> between vector spaces, the derivative is <em>the</em> linear map that takes incremental inputs of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> and outputs incremental changes in the value of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>. That is, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>f</mi><mo>:</mo><mi>V</mi><mo>→</mo><mo stretchy="false">(</mo><mi>V</mi><mo>→</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Df: V \to (V \to W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span>, and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>:</mo><mi>V</mi><mo>→</mo><mi>W</mi></mrow><annotation encoding="application/x-tex">Df(\bm{x}): V\to W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span>. It has a nice property that </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">h</mi><mo stretchy="false">)</mo><mo>≈</mo><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo>+</mo><mi mathvariant="bold-italic">h</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
f(\bm{x}) + Df(\bm{x})(\bm{h})\approx f(\bm{x}+\bm{h}).
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<p>We&#39;re using slightly different notation since we&#39;re treating <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Df(\bm{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span> as a function, it will turn out that it&#39;s okay to treat it as multiplication. With our new understanding that the derivative is a linear map &#40;and it just happens to be a matrix&#41;. Let&#39;s look again at this figure</p>
<div class="im-800"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAByYAAALnCAQAAABmJOieAAA&#43;4ElEQVR42u39v2tj7/83dj6v5F0t3IHzhYUUWwTNvZAtttLA/gNy2H9Aw3Zpggyp0tmQekGuUlvddovdLwSrDiGM7nvrDSOS7k6RUREI24QrhWSP7ZFsXbZsydLjceAzlnR0ziV/5j1Hz3P9eJUaAAAAaPPv7bsBAAAAfD3CJAAAAM2ESQAAAJoJkwAAADQTJgEAAGgmTAIAANBMmAQAAKCZMAkAAEAzYRIAAIBmwiQAAADNhEkAAACaCZMAAAA0EyYBAABoJkwCAADQTJgEAACgmTAJAABAM2ESAACAZsIkAAAAzYRJAAAAmgmTAAAANBMmAQAAaCZMAgAA0EyYBAAAoJkwCQAAQDNhEgAAgGbCJAAAAM2ESQAAAJoJkwAAADQTJgEAAGgmTAIAANBMmAQAAKCZMAkAAEAzYRIAAIBmwiQAAADN/tl3A&#43;DQlS79JMmsLh6e6ep83&#43;0CAIB9EibZkTJe&#43;/S0Tvfdsnd9qkEuMsgsiySDMs1VnSa5SD9n&#43;24bAADskzDJrvRX/9utHi8D2JfuvyujXOc23&#43;57Icso1&#43;U2k1zkS0dkAAB4v1L33QKOSunyO0lyVS/33ZZ3f5ZRrjOp588&#43;31166TKteiYBADhpFuBhp&#43;5nFR6eMt4wEHfT/l3GWeRZJK4Lw1sBACARJmGTUbrc/h2O618BEwAATpEwyanoN&#43;4/SLK2n7VOcrD9rwAA8FkswMNJKF0GmTW95aXwOX1YZggA2FLppZckmZ9igS2lxjhGeiY5DcPmdyxeeFdbLAWAE1d6ZVx&#43;5WcuMshFfpbf5br09t2qT/z8g3KX3xnnIhf5Xe7KIElyket9twzeR5jkBJQuTYvvJFkGxl652PCaga4AsJXSlXF&#43;ZZir&#43;i/1rF7Ws/ovOU8/v8p1OYmRPmWUuyzyrX6vZ/WsltzmuoxLLxfvPzbsl2GufILVsJYu/UzrNEnKMP0k80wfD&#43;94vl/pZZBecv&#43;uR3veDxUZZF4nD88u7/P10ntcmKQMMn7DsNRphknGJfXq&#43;Ut1&#43;qfO5PZtXu3fz/1nn61b4OfRcUfppcsis9yuGwRTRumln2S26VwAsG&#43;ln&#43;v0M8nl42tevc1tuc4og/KjHvl4n79LjdVJuc1dRvtuGexAtdl2uq3&#43;GD957u7hx3FNhvmZcQa5yK&#43;nez56yzi93OVnxhnnOjW/MtpwxLuH58Z/dnh4rp9faxp5t8Xn6B7e&#43;SvjDNN78fNu0eaadLnJXUbpp8swv/I7FxvOfZOauwwzyCDj/Hr6&#43;6zJML/yK8s4OU7NXbp9/z9vs9lsNtvzLf38Ts3NhlevU/M7/XedYfz8GvnBn6jxfOnyO7//vkqny&#43;9s9Y3EZjvkbe8NsB3btvrjefjpcrF8PqNc3/&#43;Tml5&#43;pz6OXOlWkfAmvzJ8eHZ5Kbpee8Qn/wxnsIyAa1vVeLFJ/9kTv3Kd0drLwbZtvnn8OF1&#43;Pt/j0Tsf/1Z6&#43;f0kdI9S8/NPS54/ttlsNpvtELbVjdnfm65Qr72&#43;1TkOPUxeZM21vmZ19RYmbV9823sDbMe2rf4Yb3hl/Cz83aTm59ojPLlPuQp212v2fPbP8DLYrT9382cZ5PdfT/7&#43;Exjb2rx6fPfk&#43;DU1gyfvWl5YH4fO3vKHZ&#43;96eq67t3w&#43;m81ms9k&#43;cstNaurzcTpP9hilZmPP5VbnuPvkMNl4vpeu0PktTNq&#43;&#43;mYBHj7XRZ7OQJxnfRGOq6czKOoskySj1azIT1Kn&#43;ZarPJ2v2OWmrJ/l8Fqbl/M2B0&#43;O//easeP0kie/peer3V0nmT6bYXKbZHQayxgA8DWUQYZJFrndvE&#43;dZJ5k&#43;Nbre&#43;nyqd8M3nC&#43;l0uNwRcnTPK5Fm9eKmYZr9pXZX2XuqiX9Vu&#43;5TyTR6HyesuL3tM2z7PI87IiszwJi6XLKMnsyYI7s0wfjrVcdufv4iTTLBcBAoBDsbz1&#43;sJic8vXk&#43;TN65q2l/56H6XG4Alhks/15n8263zZi7mPqlR1Xif1vH7Lt4cew63qQj1tc53nW87q9xffsrzcPAncdVHPanlYn3bw9x7JKnx&#43;6t1ZANis9FbXtNeu/MvXB2&#43;5vr&#43;p9Nd7PpNSY/CM0iB8HfP0kgwyefeR3qjOc1lu8zNJrwzr7RZvedLmuliGwNJPP710q9Iej73et7i82L55QBAAfIr769T8lf3uw&#43;ZwecN2&#43;&#43;JfL5X&#43;&#43;ohiY4dVamx3xcaUGuM9hEm&#43;juU/f5/UM1ku/v5HP0nqrFzlIkk/24XJJ20uXS4yTC&#43;TzDKv03L3rDfx9U/XXx133UDX1y7YAPBZVrdHX4sndV6e7J&#43;bhyvj9P72cRk/GgZ7mSSln5uHa&#43;bFQ7/ftJ6tfvr15wxlnut0qwkhd2Weq/r4tvRuzrfZbS7SSzIuo9xm9mwqyx/btzhJ6XKdLre5zTyDjDMuV&#43;u&#43;t5Qu1xlmmkkWSQa5K7dPanEPM05ylUm6DHNXpvlR9ZbSYt8rANmObVv9sWk11y3WXt34/uvnr2x7xLes5vr3MR5e6VLzbOW57dqc4bLa1qOiHndPP8Gqfub4pXal5tkKsDabzWazHdp2XxF6iz2Xfzys7d5S/Cs1G66aH1NsbPP5Xvh8Oy81tqtiY0qN2d6/mTPJ17G8I7iDyepltGE91qd7bRhyuhqsut1Al0dtLsPcpMukvnTP7/VPZwAKAF/B9iOJlte&#43;h6tuXazrY6vTrUYE5dFRlj1ww/z4MzGlznKWZFSun&#43;y5g/O90JJZzp7MjexllOv8Ks&#43;W5dm&#43;xaWfYUbl7s87c5m/1rwv3ep7x5/Bu738Snff61oGuU5y/udbSZ1kmv6bF0PiJAmTfB3Ly8wuVj7rbXWJe3n&#43;4nbteNzm6yTzer5&#43;xzIog9wPVH0pqM5WnwAADtn2V6qPvaYdQLGxHZca21WxMaXG2AFhki&#43;i9NMlzyaOrwt0u7skbV7&#43;e11xjlfaXIbLn5/t8uef60EGSW5Xcxr&#43;PtZwdclZ3l/sr93DvUQADsX2N38/O7rsodjYTkuN7aTYmFJj7IYwyWH6&#43;8KyDEpPB6KsGy66zT/L3VaXuMH6O4all17ma9ZyfbnN6&#43;LfX/9c10UmSXpluOZY8ySp81wlGa65azhWrwqAg7G6Rm/dy/Vp0zj2V2xsN6XGdlRsTKkxdkKY5DCNns5YLMMMk5zXv&#43;/CPblIlYtl399fF4hZHse5wZaxa7x23uQ4q7Xdmtq8DJ9PL6kXT2ZfLsPiZaZJxuX551o8rId3lVm655efcpGZBb0BOBj3V9pXerkerp2fuSL5niNTndfLLKPgutvHW7S4rr4VlH4ZlXG5LnfNxcbuS42Nn277&#43;p3wVQmT7EgZlEEZPPwjNCjDMiirEsSlX&#43;57&#43;fpluHy29MqgLId2poxXMwb/uMrNn2hWhqsp4s8rTE6ySP/RfqMMVqHt4tkRr5IMlnuWYeZ1u0vWJHfleay7zjCTtTUmX2zzw4yHh4tGGaXLeZJ&#43;6ZfuoeXJj9yml7s/gbhcZJgf94/qImeZZViu/7SsjDPMhtmYALAHW4bJh6GZnzm65hOLjW2aglJnm0cubdPi0pVx&#43;ZWf6Wee23r21&#43;/vtU93X2ps&#43;mw7y9n&#43;Knrz9agzya7cPXnUz02S5CqXScYP99K63KyeHT1aLewiF0nKkyOc5boslsM6MsgkV38HwDovZxnnrixnGvYyz4/VP46jjB4fsd6W84xzVybp0s/rVaGS5KpeltuM87vcZp55FulnmF6u6uWGd7zY5npeFhnmptzXeprW86Sc5zo/s8jl/WpqdZEfZZSL/Cq3mScZZpqzxyvA1kW&#43;P&#43;yxyDKInqkLBcDhqLdlkS6vh6Xl64tdrZ16cMa52vDKsm71myJtGa7qTH5/59XfqCbeSZhkR2p54bU14a1e5jIvqPOclV4G6XK1uYBuneWs9NLLILNM6jwp81VUnD19T51kUgb3EW4Lt7l6OP4ovdXFbvJsCaCmNtfLXJZ&#43;eulnmqvl63VSbtN//k95nWTyfM&#43;Ne9z&#43;CaIAcDAmucjrg0mXI3Zud3ElK6OkbtOrtqNiY9udr/Tr2jPVRZlm0F5qbFVsLJm8&#43;I1m9spvfmpmJLsgTHLA6nybgRZ1nvmfCeSrSerr95xuP72//hlWOn859ra1uc4ye3r3dVW3cos92/cAgL25yihdujLaHLjKML0ki429d2227eXbVbGx7c7Xf/FM7aXGXi02ltTpq8XGlmFTqTHeyZxJAAB2ri5WN2NfKly1Wvf8r1E/H1j869OLje201NjOio0pNcZOCJMAAHyAOlkVvNqwRmi5SD/JpP7dL/m24l/rSn99ZLGxfZQa21GxMaXG2A1hEgCAD1HPM0lysS5OlVHG2TTzb9viX6&#43;X/tptsbH9lxrbXbExpcbYhWqzHdSWQWpq7vbdjmNvs81ms9lsn7PlIjU143RPnh0vn93wnl5&#43;p6b/8HiUu9XV9jqDDB6eH6be75fh8yvx6ry/Hh1nmN&#43;pGX3M&#43;dZ&#43;kmUbfv/1&#43;a9Tc71h71danOvU1AwftfY6vWXL0uXn/ZnS5SY1P9N79P/Fzz/tSJefqbl&#43;9Mz48es22&#43;tbqftOs/Dgr7&#43;Om4twHIyv2GYA&#43;Eyll4uMMs/tasm5fkbp5TaXm1dIL/2M08&#43;f4l9X6f8pQ/ZnDfn7/s1l6a&#43;na8KWmuQqk1znlWJjuznf2s9Rc1UvSz/jDPJqqbFtW1zGGaaXP8XGLpMyynWSRS4fL3hURrlIL3&#43;KjT1bAb6McpEuf0qNXVkhnhbCJAekPJ&#43;dMN98kTkUX7HNAPDZSi&#43;D9FeL2swzf6nU1qP3LIt/zep89Sj5q/hXUgYZZPb37MNlNKuXq7N3mf393l2eb&#43;0xb3K&#43;fP&#43;q1Nhy0Ol0/edvafFDCbGHPUr3d7Gx9Xu2vQ6bCZMAAByhP9Hsq/h6LebUWYAHAACAZsIkAAAAzYRJAAAAmgmTAAAcndUSef13HkaL4QUW4AEA4Kh8vcJdX6/FkCT/7LsBAACwU2fPHh9&#43;2a6v12KInkkAAADewJxJAAAAmgmTAAAANBMmAQAAaCZMAgAA0EyYBAAAoJkwCQAAQDNhEgAAgGbCJAAAAM2ESQAAAJoJkwAAADQTJgEAAGgmTAIAANBMmAQAAKCZMAkAAEAzYRIAAIBmwiQAAADNhEkAAACaCZMAAAA0EyYBAABoJkwCAADQTJgEAACgmTAJAABAM2ESAACAZsIkAAAAzYRJAAAAmgmTAAAANPtn3w34CspFutzW2b7bAQAAcChK3XcLDl4Z5yLJIt/qYt9tAQAAOAyGub6i9DJKknS53ndbAAAADoUw&#43;ZqbdKufhmW078YAAAAcBmHyReU6/UcPr0v/zYcCAAA4IsLkC8o4z/si78RJAAAAYfIFq4V3nurESQAAAGFyo3K9Jkomyzg52HfrAIBDVLrS23cbAD6LMLlG6Ze7hwGuf8qB/A&#43;rP7vclfG&#43;2wgAHJoyzu/8smAfcCrUmXym9HOR4cPDeX7k5&#43;rnaaYZP3rlNlcqTwIAS6W/&#43;s6gNjVwIvRMPnf3KErO8r3O/rxUr3L&#43;8KCXiw0DYQGAU3RfkVptauBECJNPlMFDVclkkrPn9xXrJN8zf3hoKR4AIMmzcmJDE2KAUyBMPlGnmSRJpjmr5&#43;uGqNRZ/Zar1UzKq323FwA4BH&#43;VE7swcxI4fuZM/qX0sngcIx9&#43;RdN69ujZfubmQwAASRmtHdj6o97uu2UAH0nP5F/qViGxzkRJACAp4w1zJG/0TgLHTZgEAHij0j2qTP3//&#43;vla3MngWMmTAIAvEHpyig/H1Wm/n8/vPRfPdSpvii/yrB0zQcH&#43;AKESQCAZqWXX7lOb/VwlrP8Tw8v/n9y9hAne7nJT3ESOEbCJABAu9GjcmKznD2uTJ3UWc4eFRPrPapiDXA0hEkAgHb34XGRy/r972X56izfHxURm297WICv4599NwAA4Oupt&#43;U8vSwy2bS&#43;e13kskwySjKt0323F2D3hEkAgDeoky32medy3&#43;0E&#43;CiGuQIAANBMmAQAAKCZMAkAAEAzYRIAAIBmwiQAAADNhEkAAACaCZMAAAA0EyYBAABoJkwCAADQTJgEAACgmTAJAABAM2ESAACAZsIkAAAAzYRJAAAAmgmTAAAANBMmAQAAaCZMAgAA0EyYBAAAoJkwCQAAQDNhEgAAgGbCJAAAAM2ESQAAAJoJkwAAADQTJgEAAGgmTAIAANBMmAQAAKCZMAkAAEAzYRIAAIBmwiQAAADNhEkAAACaCZMAAAA0EyYBAABoJkwCAADQTJgEAACgmTAJAABAM2ESAACAZsIkAAAAzYRJAAAAmgmTAAAANBMmAQAAaCZMAgAA0EyYBAAAoJkwCQAAQDNhEgAAgGbCJAAAAM2ESQAAAJoJkwAAADQTJgEAAGgmTAIAANBMmAQAAKCZMAkAAEAzYRIAAIBmwiQAAADNhEkAAACaCZMAAAA0EyYBAABoJkwCAADQTJgEAACgmTAJAABAM2ESAACAZsIkAAAAzYRJAAAAmgmTAAAANBMmAQAAaCZMAgAA0EyYBAAAoJkwCQAAQDNhEgAAgGbCJAAAAM2ESQAAAJoJkwAAADQTJgEAAGgmTAIAANBMmAQAAKCZMAkAAEAzYRIAAIBmwiQAAADNhEkAAACaCZMAAAA0EyYBAABoJkwCAADQTJgEAACgmTAJAABAM2ESAACAZsIkAAAAzYRJAAAAmgmTAAAANBMmAQAAaCZMAgAA0EyYBAAAoJkwCQAAQDNhEgAAgGbCJAAAAM2ESQAAAJoJkwAAADQTJgEAAGgmTAIAANBMmAQAAKCZMAkAAEAzYRIAAIBmwiQAAADNhEkAAACaCZMAAAA0EyYBAABoJkwCAADQTJgEAACgmTAJAABAM2ESAACAZsIkAAAAzYRJAAAAmgmTAAAANBMmAQAAaCZMAgAA0EyYBAAAoJkwCQAAQDNhEgAAgGbCJAAAAM2ESQAAAJoJkwAAADQTJgEAAGgmTAIAANBMmAQAAKCZMAkAAEAzYRIAAIBmwiQAAADNhEkAAACaCZMAAAA0EyYBAABoJkwCAADQTJiEJEnpl8G&#43;2wAAAF&#43;HMAlL49ztuwkAAPB1CJMAAAA0EyYBAABoJkwCAADQTJgEAACgmTAJAABAM2ESAACAZsIkAAAAzYRJAAAAmgmTAAAANBMmAQAAaPbPvhsAB&#43;Iy3b6bAAAAX4cwCUmSOtt3CwAA4CsxzBUAAIBmwiQAAADNhEkAAACaCZMAAAA0EyYBAABoJkwCAADQTJgEAACgmTAJAABAM2ESAACAZsIkJEnKXan7bgMAAHwdwiQAAADNhEkAAACaCZMAAAA0EyYBAABoJkwCAADQTJgEAACgmTAJAABAM2ESAACAZsIkAAAAzYRJAAAAmv2z7wbAgbjNbN9NAACAr0OYhCRJney7BQAA8JUY5goAAEAzYRIAAIBmwiQAAADNhEkAAACaCZMAAAA0EyYBAABoJkwCAADQTJgEAACgmTAJAABAM2ESkiRlVMb7bgMAAHwdwiQsDXOx7yYAAMDXIUwCAADQTJgEAACgmTAJAABAM2ESAACAZsIkAAAAzYRJAAAAmgmTAAAANBMmAQAAaCZMAgAA0EyYBAAAoJkwCUmSelbLvtsAAIendOWuDN787usy&#43;pwztZ0L2IV/9t0AAAD2pfTTZVFnG1/vcpdJnb75BJe5K6mTLVry3jM1nAvYDWESAOCLKL281Pe2yKwljJV&#43;bjLPLP2S/KiLNXt0ucvsPfGsLsqP/Hw94m06Uxmn//Cgq993cS5gV4RJAICvoreKVsvBoPPMn7w6SMoik1ytC4bPlV7uMqtnpcs4w4xytWan66Sev6/JdV5&#43;5K7MNvd&#43;bj5T6XLx6OHLR9j&#43;XMCOCJNwQlru7wJweOo00yQpNUny43loKqOMc5FBOd8iTl2nyzTJOKMkvb93KBcZ5mwXrS63uSnfN0fcTWeqi/ItvdxfvbbodX39XMDuWIAHTkbpcpHBwwbAF1WWwW/NTMc6ybfM0s9d6V45Rj&#43;DLOPZcs/bv/bocvHOOYx/XKb3pI9x6zPVeZ0&#43;BN3t&#43;htfPBewS8IknIy6yLecPVyKd/P1AIDPt7whuD58LXKepMv1K8cYJkmdJbnMVc7WRLmLdGuHvr5BnWeSi9Lb8PKLZyr93Afjra5cr5wL2CFhEk7IG&#43;7vAnB4loM&#43;N/w7Xme5TTIs/VePMU2SOq&#43;Xf0fJ0mWUaZ1nVybJ&#43;v7CV890P5ZmtvXQ1Y3nAnZLmIST0np/F4AD9ELP5KNXhi8eo5&#43;XbyuO0v099PXt6izzDNcOvn3tTPeheOvr1gvnAnZKmITT0n5/F4CDUnrpJS/Vhlyt8Tp48Rjdw37rDZNdhskkt&#43;nWBtzXzvRw5drBuYCdEibhtDTf3wXgwLzWL3mv/&#43;prG8Nk6aW/89uO06wJuK&#43;d6Y0jataeC9g1pUEgSVLuMqhl3634BG&#43;5vwvAIXlxxmTLMV5YqXWYF8NbGWWQLl0WmWWynO9YLjJIl0Wmdf1iOrOsC3ivnOnxiJrSy3B1jvw5b8O5gB3TMwknxIxJgCOwbc/kGmVQaqmlLpenWf68qln5VD8b&#43;y1Lv/zMdXqZZZpeLvKrjEtXfmac&#43;bJuZfm57n11kXm6v5YFeuFMD68nybSM8yujzDPNPINc5FcZbXrThnMBO6ZnEk7J2&#43;7vAnAwtpgx&#43;UKfXJ2mJEn5lV5u64&#43;NR9gY8Uo/d8l9KZEyya8kFxmly1mdli43SfrlYm3v5Dy99J/1qb4WJu8/yzC9XN4ftSSjJNdl8yqw684F7JieSTglb7q/C8AB2aZfclkEavbKHvNXXl/z/tLlLsn3&#43;wGyD1Guy6ROk1yv2rd&#43;JdXZQ9tePdPqfH9G1HT5/iig3s&#43;x3LzIzrpzATumZxJOyVvv7wJwKLaZMfnKPuWVQFp6SbJ2UZxxuvz4c7V4VH5jkuRPuNt8PXkS8F4409KfPtbLtX2xL5f/ECbhg&#43;mZhJPxjvu7AByKV3smVwNhX9rntUC6OYSNMq&#43;Py3jch735Kuotry3TOtl4hKfx77W4dz&#43;i5vbZEe&#43;ff3m9WZUm4YPpmYTT8b77uwDs3VYzJpe3Bhd1c&#43;3GXpL5mwp/XK6Z8Zg8BNd6WaYvtK59/Mv9lev5Z3m90JWxNvAJhEk4He&#43;7vwvA/m0zY3I5B37ywh6vLXqz0V/L6vxVcKq&#43;1LbGc25ag7wMVs&#43;/FKqFSfgEhrnC6Xj7/V0ADsOrMybLYNl3matXjrKDdU5L13gFaR0B82gN8rXP377wXqNt4BMIk3Ai3nV/F4DD8HrP5EWS5GrzINayzRI&#43;La1J5lsu4NZa93FTVB1ueP495wLeQJiEU/Ge&#43;7sAHIDXZ0yWYQZJbutr/ZIvh8ltpz28f2TLy2f6axBt8tD3&#43;vKsUOBTCJOwdPvigKBj8J77uwAcgtdKenS5TjLL&#43;YtHWQbSF/oSXwqr5Wf5U5l4fdi7KfWFsz/Z96UxMZtG1Dxct26Xn7n8LjfbnAvYPWESkiR1Ui/33YYP5v4uwFf3Yp9i6XKXLrOcvbJO6zYzJhcP1Sgfn6GXm/TTy3h1vvvblLMn&#43;ww3Ln6znM25xZmSbBhRU7qHMHlf2bJb&#43;2nWnQvYMWESTsIO7u8CsG8v9EyWfu7S3yJKLo/yWpicZd0SNvc9ksszPFQnftK/OE429ox2a868/kzJphE199ez2eqsF1msXbl23bmAHRMm4TS87/4uAHu3ecZk6co4P9PPVf3&#43;WpQsy/Eory2YM8tLS9hcJqVbLfXz9OjXGeZqY3mQwZrSIZvPdH/lWn&#43;0aZKUcXobFhsavFKmBNgBdSbhNLzv/i4Ae7QaBroMb/Nng0J76WeUZJKrrdZU3W4t12ku1kS8SUbpcllvSz/X6eU8o/STcp3LJMOM0s/VpmkjpZ91wXD9mZI8rDX&#43;5D11WmbL/UuXi1xksm6xoQ3nAnZMmITTsO393ctXh0cB8KnKxXKO4ko/d09enmeWy9xuWZxjGSZfLQZVp2WRv2Yy1nk5y03GZZxknrM6LbcZZ5jRagDsNGcv9AYOsuYqtP5MSZJlaPw7mp7lJoNc5CKLXG5Yt3btuYBdEybhNLzj/i4A&#43;1Svdrre&#43;LZ9drcZleHzxdnqLN9KP919HK2LnOd81Vc6e&#43;V25DDry1CtPVOSs/TXVbCsi5wth/y&#43;EFw3nQvYKXMm4TQs70Gvu787TXKR3xnlsp43HhWAr6aX7cLkJFnfY1hndfq0Z7NO67ROX46SpZf&#43;hv7TDWeqizrd1N9a53W6OUq&#43;cC5gp/RMwml4z/1dAL640iV18bCIzxZ9dnVWphmW3U1&#43;WM7r/IwzvXAuYLf0TMJJePv9XQC&#43;ujLK7/wugyx7ACdbxrbLrF2x9U0t6DLK5mvNDs/06rmAHRImAQCO23IBn16WMya3nIFZZ7nKqHTb7f2Ki2yuPrnbM71yLmCXhElIkpRxuXv/UQDgAHVJZrktvYy2LCCydJVFrt9/&#43;tLLxSvn3dGZtjoXsDPCJCz1NyxMDgBf3VXmuUw/N5lsqgK5Tl3kRwZl9O7z37y2WvjOzrTFuYDdsQAPAMBRq5dlmkG6XLbOJKyz8iM3ZfZaXcqXlOvk9dXCd3Gmbc8F7IowCQBw5Op0q3Iga99ZznJTzt46cLSMk5x9xplazgXshjAJAMBGdVbO8vayHbfb9zW&#43;80xN5wJ2wZxJOGJlWO7Kr9LfdzsA&#43;Mrq/O01INvi3XvO1Hou4P2ESThm1xmkl7ticSEAAHZMmIRjtry/2&#43;WujHdWvwsAACJMwnGbPPx0kV8CJQAAuyNMwhGrV/lTT6zLRX6VmzISKeGzlH4ZlN6&#43;WwEAH0OYhKNWr/I9fxZZ7zLMdX6XuzIWKuFjlUH5lZtc5K7c&#43;K8NgGMkTMLS7K0VuA5dndVvOc/Tql2DXOQ6F/tuGxyvMspd5vVbPctVBhnvuz0AsHvCJCRJ6mU94jLHdVK/5b/M//fZ00qGwAcpXcZJLpMyznW6jPbdIgDYPWESTkAZlbv8P/Pf5Vsu86cK1&#43;2&#43;2wVH6yLdqubdsjCP6ncAHCFhEo5a6ZVx&#43;ZXrDJIMs6hXuZ&#43;7dVsn7zky8IJRsho6P00yz/m&#43;GwQAu/fPvhsAfJQyyPDJ4Louo7LIcmXJhS&#43;38FFKP11WvZH18tGaygBwVIRJOEKlyzAX&#43;bsgwZ9oOamLfbcSjtZyaOv8nUcBgAMnTMIx6uV6zbOTzFdrSi5yte8mwhFb3sgxTxKAI2fOJByhOnv2NXaey/xLPX/oq9QvCR&#43;pn6yW34ETUHplUHrvPw7w9QiTcJz&#43;LK5zmx/1W72qiyTDv14Fdq&#43;fHGvlWniu9PIzd/lVfpZxGTx/7ThjZqnlbt9tgMNgmCscp9uMk0wyqQ/ztspwtZLrrJrLBR&#43;mmDHJabm/tvTTz0VJFg9jY7r0kyzKmX56OFbCJHxhpcsoXV2zVmRdd/Hur/5UXxI&#43;QBnm4uG/smRUlgtezer3fbcMPtTzGyddBs8e980ghmMlTEKS5VL&#43;9UsNSyv9jJb3g8tkXU/jmvvA90ONXNThI8wyzTRJP4MkkyxnJuuh5Ni9PgffVQeOljAJS&#43;MMUvbdiG2VUUaPe0C2rGPXrf50WYcPUOfL/xKXc6mqSq6ciDp9cvH83/LvP3q0yG1uDXKF4yVMwpdSehll9BALl4aNRdH7lgaBD9SP/khOSHl6Rfr3M6vfyyDJQoiE4ydMwhdSbh7WY32sK/2tLtm3WV7eRUn4MKWXLvr/OSX954/LtZ55OBXCJHwl3V/PTHNbtyz0UScl6Vl&#43;Bz7U8ou1nklOz&#43;LhGjUqs22vTMDXJkzCV3L7aI28RW4zaRtE5OIOH24ZJvX/czruF3f7f&#43;U/fYiT12VmkCucgn9v3w0Atlcnq/6Oec7zrZ67VMPBWX6x9t8mp&#43;M&#43;TP67nD169q50bzkY8LUIk3CQNl6EbzPJWf1WJ/X1xdiBz9dPsvDfJyfkfs7krM7yeK5k7y0HA74Ww1zh4JRhRhmUb2urR7at2wp8qtKlF/2SnJDS3U&#43;/qNOkTko/oySznB31LZUr86JhSZiEA1K6XGS4upu7bfVI4HAs&#43;2iESU7HaPXnap5wPS/9zI59NVc3duGeMAkHogwyfLgoJ8IkfEXLPhphkhNRulysfnxYKbx&#43;33ergM9jziTsXenKqPzM3ZMomXRl9MYDAvuynO0sTHIq&#43;qu/8wtlp&#43;A06ZmEpcvsb9256wzXPDvxhRS&#43;nH6SVLOpOBWzVXXJ86OeIQlsJExCkmSvRTZun4XJeW5z5cIMX1A/akxyQuqifM8gUzdQ4FQJk7B39bbMH5ZQn2ZSDRaCL6mYMcnJqfNM9t0GYH/MmYRDMEmyyFW&#43;1TNREr6s5Vqu&#43;mjgL0XVSThKeibh05Quww2DgSZZ5NbAVvjiljOvDXOFJ0qX6wzKN1c5OD56JuFTlF65zq9cPyyi/kRd1ImLLHx5/SRzs8fgsdLPXYbpcrfvlgC7J0zChyujcpdfGaVLMiz7WzUW&#43;FiDRIEEeKz0crcaAN4v1/tuDbBrwiR8oNIr4/Ir16tC5knSrS0DAnx5ZfmFWZiER&#43;r80ZJUo2Opn1zGx/JJ4L2ESfggpV&#43;u8ysXeb7ogDAJR6SMy11ZDl8fJJnvtcwQHKIfjxalui6DdxzpcFy4lsOSMAkfpcvf9y1nOa9n&#43;24YsCtlnIsMMk6ynDF5te8WwaGpi/zIn1UBbqzrCsdEmIQPUqfPqs1N8r1&#43;r&#43;pxwTF5KAZSugwz9184/K3OcvnwoMuNtQPgeAiTkGQ5VG3nB73/WjnPZf6lnhv&#43;BkdnnkVu8yPJRRb5se/mwGGqk0e99v1VXz5wBIRJWOpn9/M4bpdfM&#43;u3eqXwBxyly8yzyLBcZ5QzN4xgk3r5qALrqJhxCEdCmIR3KoNys36587qo/1J/VGs7wtGqi/o90ySzfBMl4UV/FuK5cmWEY/HPvhsAX1fpMspouVprudT3CKep3ioHAq&#43;ri/Ijd0nORUk4HsIkvEnpZ/RktdaLR8sLAADP1Fk5Vz4HjothrtCsjMrP/HxW&#43;MP8DwB4Ub0VJeG46JmEJqWXn1m3qPms9Oq8&#43;XAAAPBF6ZmEJnWe53dVF7nKt/pDlAQOSxmWWm723Qo4QtPoYYUkeiah3e2jIiLT3CpSDhyoUZJhGVruBHarnu27BXAo9Exy8kqvjMtdBkn5Wcbl1WqTdZJFkkUm&#43;VbPREngYC3HS4zeeRQA2ECY5MSVcX7lYtXX2M9F7spN6ZKkdBuD5VXO862eG9gKHLSrJMmgiJMcsNIv4323AXgrw1w5aeV6zT37YXrlP8v/I6N05du6wFiv9t1ugNfVebnKRZLrEqMoOExllOukLFxZ4WvSM8kJK&#43;MNw7/6&#43;be5SBfDw4Cv7Wq1TMi49PfdFPhbuc51kmSLSSbAIRImOVmll4tXdxImgS&#43;sLnKWWZIudwa7cmhK71GN5pvS23d7gHbCJKdruMU&#43;na9fwFdWFznPIkmXazPTOCx1nsuHB11WKxYAX4k5k5yu14fUzDKJJfXhwJTRVreC&#43;OP/l/9L/oMkF6UfS4dxQOrk0SihfsY533eLgDbC5EEr/ay/j3xZ1xTLLeOsmxMzq5dr9m078t3afddWWNz0NW99TaamI&#43;/68702g&#43;i/rv/3T/18DUf&#43;8n8zVOfkPXpb3ApivUF&#43;lu/iJIejXj4a7DoqcwvxwNciTB62bsNXpvUDQfoNX7Dajrx&#43;39naZ9u&#43;5rUcedef77XhNP/HT/58LUf&#43;6n8z1u8BfLzu1X/74HOdp/dwy3Nc5tWIIPhCSt13Cw7ew69our7via&#43;q3L0csWrZdwuBdcp4i8WzWG&#43;Rc1/VP86jv5tndbrv1nwdpZ&#43;7h5sci5zVg7/hWAZZHH4r4TNYgIfTNXvHq8De1MtabNtv&#43;ZeHf89u802U5PDU2ZebK3kXy1lBEmGSU3b7jlcBvorr1RDCSf1RF/tuDKxTb7OcKznLNz1&#43;8JUIk5ysOsvmRWAsAQAchXK9WtzkvH61vh9OSr3MbSb1uxse8LVYgIdTdpn&#43;2nVOF/mx76YBvF&#43;5yLJW7pUVlDl01ZUXviA9k5ywushZ/l4iYf4VJv8DvKZ0q&#43;VgJusKAQHAewmTnLS6qGf58Wh&#43;5CyX1XwN4DhcpEsyN8AVgI9hmCsnr97mNin/bf5vioEAR2U5jF&#43;vJAAfRM8kLP0v&#43;24AwI7Nksyj3iEAH0SYBICjVC/zvX6zOiZfWentuwXAS4RJADhSZoDzlZWu3ORn6b//SMBHESYBADgwpZ&#43;7DNPlunT7bguwiQV4oEkZZZAuXRaZZVLnSVIuMkiXRab1at/tA4Cvr/Ryl2WI7Of64Ko/n8XwcUiiZxIalH75mev0Mss0vVzkVxmXrvzMeLXExbj83HcbAeDrq4&#43;XjhqW8b7b86x1U0PIYUnPJGyp9HOX5KxOk6RM8ivJRUbpclanpctNkn650DsJAO92nl7u50telFm9fdfRgA&#43;hZxK2UrrcJfleV3dKlwNck3SZ1GmS6wxWjwGAd6qLnD8aTHptIR44RMIkJEnqWS0v7jBOl/OHCJlHywFMkiTD1aN5AIB3q7OcPzywEA8cJGEStjPK/MkQm8Hqz/lq3sRycOu0TvbdUAA4DvU2lw8P&#43;rned3uA54RJ2M7lo/ujSR7mcdwPe73MWb7Xs303EwCOR73Kn5u0wzLad3uApyzAA1v5a1md&#43;57Jh/Xc6nT7owEAW7lMf3UD98roHzg0eibhDUr3vGcSANi9usiPLLLIj3r5/qMBu6VnEt7iz4xJC&#43;4AwAeq83KWqOwIh0iYhLfQLwkAn0SQhENlmCtspQzLz/LrYer/XzMmk6TclLrvdgIAH6vclfG&#43;2wCHQc8kbKH0cpMkGWfyZMbk7Mk&#43;Q1UmAeDoDd5/CDgOeiZhG/c9koskyfD&#43;6ScDb8bJs/IhAABwtIRJaHGZlC4Xf79QrjPMlfIgAACcCmESkiTl7sX5jpMsklzW29LPXXo5Xw5wLdelK10ZlZ8Z5cqi5QDwOUq/XO&#43;7DYAwCVuo85xlnnGp&#43;ZkuZ3WSs0yyyCi/8zvXWeRMlASAz1FG&#43;ZmRZXBg3yzAA1ups3wr/XRZLOdJ1kXOc16WU/BndbHv9gHAqSjXq7UMLsq8TvbdGjhlwiRs7e86V&#43;ZIAsDnKr0/C&#43;FlXGaqUML&#43;GOYKAMCXUef58fCgy03p9t0iOF3CJAAAX0id5s86BfeVoIE9ECYBAPhS6lX&#43;zJUcWIgH9kWYBADgq7nMn7mSF2X0qeeexjxNSGIBHgAAvpy6KD/yM/fzJT91IZ56tu9PD4dCzyQAAF/Ok4V4gL0QJgEA&#43;ILqNOdJklm&#43;KRAC&#43;2CYKyzdmv8AAF9LnZR&#43;Us/33Q44VcIkJEnq5P3HAAA&#43;lyAJ&#43;2SYKwAAAM2ESQAAAJoJkwAAADQTJgEAAGgmTAIAcFRKf98tgNMgTAIAcDRKV27y8yPjZBkIq7AkTAIAcCRKP3cZJrkr3Yed5C7jfX9OOAzCJAAAR6F0ucuy17DL3b5bA8dPmAQA4CjURW4fHvTL9b7bA8dOmIQkSRkVQ1YA4Iur55k9PBiV0b7bA8dNmISlYS723QQA4N3Osnj4&#43;dpSOfCRhEkAAI5GXeTs0cOPXIgHTp4wCQDAEamznD88sBAPfCBhEgCAo1InmTw86Js5CR9FmAQA4Mg8Wojnqk7edShgo3/23QAAANi5s/xKcl5v330kYANhEgCAo1MX5Syps/cfCdhEmAQA4Ah9VJCsZd&#43;fDA6FOZMAAAA0EyYBAABoZpgrLJlTAQAADYRJSJLUy323AAAAvhLDXAEAOBGlX25Kt&#43;9WwLHQMwkAwEkoo1wnWeR83y2B46BnEgCAE1Cuc50kGZWLfbcFjoMwCQDA0StdBg8PxmXwjkMBK8IkAABHry7yI4uHhzelt&#43;8WwdcnTAIAcALqLH/Wbu9iIR54N2ESAICTUCe5enjQz/htRym13O37k8BhECYBADgR9TLThwcW4oF3EiYBADgdPzJ/&#43;NlCPPAuwiQkSUrf5QQAjt&#43;ThXgWj5bkAZoJk7A0jvkPAHACHhbimeVbne27NfCV/bPvBgAAwGeqk9JLl8uqXxLeRZgEAODE1Mv3HwMwzBUAAIBmwiQAAADNhEkAAACaCZMAAAA0EyYBACBJ6W&#43;121Vu991SOAzCJAAAJ6905To/y/D1Petlney7tXAYhEkAAE5c6eUuoyTXW/ZOAhEmAQA4caXLzyxDZJfr0u27PfBVCJOwdJmzfTcBANiHusifgav9XO&#43;7PfBVCJOQJKmzOt13GwCA/aiXjxbVGZbxvtsDX4MwCQAA55k9/HyxzUI8gDAJAMDJq4ucZ/Hw0EI8sAVhEgAAUmc5f3hgIR7YgjAJAABJ6m2uHh70M9p3e&#43;DQCZMAAJDkyUI8V/XqXYeCEyBMAgDAvfPMssh5vdy0QxkXfZaQJPln3w0AAIBDURflPKmzF3a5yPRRXUo4YcIkAAA8eDFIAo8Y5goAAEAzYRKSJGVc7vbdBgAA&#43;DqESVjqZ7DvJgAAwNchTAIAANBMmAQAgBeVfrkp3b5bAYfGaq4AAPCCMso4XZIf&#43;24JHBZhEgAANirjXCRJhuW/yn&#43;TfpL/uFxkqoQICJMAALDZnyX6/ov8F0mS/1PGSZnmUqDktJkzCQAAm/3IYu3zg9yV0b4bB/skTAIAwEZ1vnGuZJdx6e&#43;7fbA/wiQAALxNl&#43;t9NwH2R5gEAICXjF94rV&#43;G&#43;24e7IswCUuzTPfdBADg8JQuLw9lHWx5IDg6VnOFJEm93HcLAODtymB9pFl/fSvre9qmdc2N1TJKb82&#43;8zpZs28v6xekmdT5O4/8cZ/v9SO/NivyPym9d3&#43;&#43;tt/cbj/fW4/8KX8zfEM7cNX2yvbww92&#43;W2Kz2Ww2m&#43;1wt4wffhzs9exPtg17r396vHbfu7X7rv1elMGGIw/efeSP&#43;3yvHnnjp9rl52v7ze308x3234zXfvW2/W56JgEAvr5J03SNs7XPztc&#43;e5luzbPri2XMNhx5fTXGliN/3OdrO/I6/2YHn6/tN/dxn&#43;&#43;Q/2ZwgErddwsO3sOvaFrP3nUgAOCIlXEuVj&#43;eVfPwj8orX5ivDMXkVFmABwAAXnL7jlfhiAmTAADwkqsXXpvW2dbHgSMjTAIAwAvqbGOcXOTHvlsH&#43;yNMAgDAi&#43;rl2jg5z1ldNB8MjoYwCQAAr6iXOXuyLuoiV/luiCunTWkQAAB4VZ1mWnrp5yb/ff5zK/aCMAkrpZ/OZQEAeEmdZ16S/9F3BkgMc4V749ztuwkAAPB1CJMAAAA0EyYBAABoJkwCAADQTJgEAICDULpyVwZvfvd1Ge37E3BarOYKAACfovTTZbGpOmXpcpfJO1aKvcxdSZ3s&#43;1NyOoRJAAD4cKWfm8wzS78kP&#43;rir9e73GX2nihYF&#43;VHfoqTfB7DXAEAYHtnuWx/U&#43;nlLvN6lqvM08&#43;64ajXST1/X9PqPD9yXfr7/hVxKvRMAgDA1t44DPU6XaZJxhkl6T1/uVxkmLNdtK7c5qZ8/7vnE3ZPzyQAAHyo0s8gyTRJlyS5ffZ6l4t3zZZ87DK9XOz7E3MahEkAAPhYwySpsySXucrZX7HxIl2udnOqOs8kF6X3/iPBa4RJSJLUs1r23QYA4Ej1s&#43;yXTJ3Xy&#43;dRsnQZZVrnOzvbJNE3yWcQJgEA4GP1k8w2vjpK93zg63vUWeYZlm7fH5rjJ0wCAMAHKr10STb3PA6TXYbJJLfplkNr4SMJkwAA8JGWpTo2hMnSSz&#43;zHa&#43;&#43;Ok0y2PfH5vgpDQIAAB&#43;pn7xQUmSY1XzKTcoog3Tpssgsk&#43;XcynKRQbosMq3rFu6ZRZjkE&#43;iZBACAD1AGpZZa6nIxnOXPpf61Wz8vDIEt/fIz1&#43;lllml6ucivMi5d&#43;Zlx5su6leXn3&#43;&#43;qi8zTlf6&#43;fwMcO2ESAAA&#43;QJ0u82PmSW5XWfLv1eNfCJOln7v0cla/18t6mbMkyUV&#43;pZ&#43;zer4qJtIv61Zuned&#43;eC18GGESAAC2Vu7KuPEtvby0/E4vG1Z6LV3ukny/HyD7UDyky6ROk1yvhrKuW7d1tjoyfCBzJgEAYHuNcxHLcv8NsyJLL0k2LL8zTpcff&#43;pPPir2MUmSh/VaNwVVYZIPpmcSAAA&#43;znKw6aYqky8FvlHm9XHJkPsYO6/Loy2HuU7rZMP7VZrkg&#43;mZBACAj9NLMn9T6Y/LZxH0fg7k/bDXyzLNoq6PqfPAhxMmIUlS7jJYMyUeAOB9Xlyt9SV/Ff2475l8iI91c0kRYZJPYJgrAAB8nH42D3JtULrnPZMvMsSVTyBMAgDABykvz5hs8WfG5Da9jsqC8AmESQAA&#43;Civhcnt51K29EvCpxAmAQDgo/SSLDb3JdYX&#43;izLsPwsv8po9fCvGZNJUm5K3XiAXfSHwguESQAA&#43;Civz5hcPNSifKL0cpN&#43;ehknT2ZMzp7sM9yw1E4vLb2e8CbCJAAAfJRBXguTs6xfLue&#43;R3IZCYf3Tz/pyxwnOV971O7V88K7CZMAALC96fYhrfSSvFamY5aXl8u5TEqXizVHv84wVxvKgwxeLBwCOyFMAgDA1upZvdx6523Wcp1mfZicZJHkst6Wfu7Sy/nyOOW6dKUro/Izo1ytb0vpx0I9fAJhEgAAPkY/yaK&#43;GCbrNIusmTNZ5znLPONS8zNdzuokZ5lkkVF&#43;53eus8jmWDuIMMkn&#43;GffDQAAgCO1XQ/hbUZlWG&#43;fP11n&#43;Vb66e7jaF3kPOerxXpm9aXldYZJbgMfTJiEpVuT1AGAHetlmzA5ySiD9eHv717N12dCll76ua3z1/aD9zLMFZIkddIw/wEAYKPSlS5JSi&#43;9bNFDWGeZZli6Vw&#43;8rVGSyb5/C5wCYRIAAHamjPI7v8sgy5mLk7pNtcfLrF2v9U3n7zLK1EqufAZhEgAAdmecZDnAtZ/kapu31FmuMtpR3&#43;RFNtWehB0TJgEAYHe6JLPcll5Gudp65uJVFrl&#43;/8lLLxcNZ4V3ESYBAGB3rjLPZfq5ScOKDHWRHxmU0bvPfpNJ3ao3FN7Paq4AALAz9bJMM0iXy7Z5i3VWfuSmzOo71pcv10k1xJVPI0wCAMDWyuC&#43;7uMmdbpFOZC17ytnuSlnbx2kWsZJzvb9&#43;&#43;GUCJMAALC9u0w/KrLVWTnLNqu/rnf7nl5NaCdMAgDAgXjP0jmiJJ/NAjwAAAA0EyYBAABoJkwCAADQTJgEAACgmTAJAABAM2ESAACAZsIkAAAAzYRJAAAAmgmTAAAANPtn3w0AAIAv5CyLfTcBDoMwCQAAW6vTfbcADoVhrgAAADQTJgEAAGgmTAIAANBMmAQAAKCZMAkAAEAzYRIAAIBmwiQAAADNhEkAAACaCZMAAAA0EyYBAGBrpZa7fbcBDoMwCQAAQDNhEgAAgGbCJAAAAM2ESQAAAJoJkwAAADQTJgEAAGgmTAIAANBMmAQAAKCZMAlwBMqgXJfRvlsBAJySf/bdAADeq3S5S5KyqLf7bgsAcCr0TAJ8ff3Vn/omAT7eVdy4gyR6JgGOwXz156AM6nTfjQE4bvVy3y2AQ6FnEuDLq/OHu&#43;Q3pbfv1gAAp0GYBDgGl1kkSbrclG7fjQEAToEwCXAE6jxXqx/7uRMnAYCPJ0wCHIV6lcnqR3ESANig9Er//UdZEiYBjkQ9fxQnf&#43;3uQgEAHIvSz8/8LDe7OdobVnMtvRNdfP5fl/G&#43;mwDwov81/y7/YZKky125qlfvPB4AcFxG6ZIMd7P&#43;&#43;1tKg/Ryse/fwV78Ryf6uYGvqcu4DHNWF/tuCABwMO6/F4yygzBpmCvA8eqf6EgSAGC9&#43;wg5LDv4jiBMAgAAnIQ6fahNPX7/&#43;grCJMCxWsSsSYCdK&#43;Nd9OjA3vypTX333jj5ljmTs5zt&#43;zfwqe5Wf/4bcyaBA/d/zlX&#43;1ernWc7rbN8NAjhCF5k&#43;rJ4NX06dl8tcJ0m63JQf7/m28IYwWRe7mKz5dZT7H37vYsUjgI9Sulw/RMlJLi29AwD8rU5KVnGyl7vy4&#43;0pxzBXgKNQutylt3pwVc9FSQBgvTrJ/USYLnflzeMvS933Jzl4D7&#43;iaT2t4b3Al1JuMlz9eFUv990aWCpjU0QAvoBpLt8y3FXPJMARKIOHKDkRJQGAJoOHdWKaCJMAx&#43;B69ee0nu&#43;7KQDAl9OVrv1NwiTAl1f6D7MlRUkAoN3kLastvKU0CACH5f5e4lWd77sp8MT8pFaA/9f5j1Y//Zv83ndj&#43;ECD/M/5t/tuBLzTv8r/Nf&#43;H1c&#43;LnNfbtxzEAjyvsgAPcPjKr/SSfFdZEvbn0XJDZ8qJHbNSfSvkqytd7tJfPZjl7K1rwOuZBDgG39PPXL8kAPCaJ1Fy8p7VFoRJgCNQFyc1mBAAeLvr3URJYRIAABrUsu8WwHuU0aNyYu9cuM9qrgAAACehdBmvfpy9v5yYMAkAAHAaRqs14BfZwTJSwiQAAMBpuK9MffXWFVwfEyYBAABOw3Ll90XeVFfyOQvwAAAAnIZJuvRyu5tyYsIkAADASaiLXO7uaIa5AgAA0EyYBAAAoJkwCQAAQDNhEgAAgGbCJAAAbK3UcrfvNsBhECYBAABoJkwCAADQTJgEAACgmTAJAABAM2ESAACAZsIkAAAAzYRJAAAAmgmTAAAANBMmAQAAaCZMAgAA0OyffTcAAAC&#43;kKvM990EOAzCJAAAbK1e7rsFcCgMcwUAAKCZMAkAAEAzYRIAAIBmwiQAAADNhEkAAACaCZMAAAA0EyYBAABoJkwCAADQTJgEAACgmTAJAABbK3dlvO82wGH4Z98NAACAL2Sw7wbAodAzCQAAQDNhEgAAgGbCJAAAAM2ESQAAAJoJkwAAADQTJgEAAGgmTAIAANBMmAQAAKCZMAkAAEAzYRIAALY3zWzfTYDD8M&#43;&#43;GwAAAF9HPdt3C&#43;BQ6JkEAACgmTAJAABAM2ESAACAZsIkAAAAzYRJAAAAmgmTAAAANBMmAQAAaCZMAgAA0EyYBAAAoJkwCQAAQDNhEgAAgGbCJAAAAM2ESQAAAJoJkwAAADQTJgEAAGgmTAIAANBMmAQAAKCZMAkAAEAzYRIAAIBmwiQAAADNhEkAAACaCZMAAAA0EyYBAABoJkwCAADQTJgEAACgmTAJAABAM2ESAACAZsIkAAAAzYRJAAAAmgmTAAAANBMmAQAAaCZMAgAA0EyYBAAAoJkwCQAAQDNhEgAAgGbCJAAAAM2ESQAAAJoJkwAAADQTJgEAAGgmTAIAANBMmAQAAKDZP/tuwBcwXf0523dDAAAADoUw&#43;ap6tu8WAAAAHBrDXAEAAGgmTAIAANBMmAQAAKCZMAkAAEAzYRIAAIBmwiQAAADNSt13CwAAjkDppbf6cVYX&#43;24NwMcTJgEAAGhmmCsAAADNhEkAAACaCZMAAAA0EyYBAABoJkwCAADQTJgEAACgmTAJAABAM2ESAACAZsIkAAAAzYRJAAAAmgmTAAAANBMmAQAAaCZMAgAA0EyYBAAAoJkwCQAAQDNhEgAAgGbCJAAAAM2ESQAAAJoJkwAAADQTJgEAAGgmTAIAANBMmAQAAKCZMAkAAEAzYRIAAIBm/zsQwuSZDzcPXQAAAABJRU5ErkJggg&#61;&#61; " alt="" /></div>
<p>There are several things to notice. First, I&#39;ve drawn the dashed axes to represent the domain and codomain of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Df(\bm{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span>. Now, since we&#39;re doing reverse mode, we need to go the other direction: take incremental changes in output and turn them into incremental changes to input. Luckily, we can take the transpose of a linear map: </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><msup><mo stretchy="false">)</mo><mo lspace="0em" rspace="0em">⊺</mo></msup><mo>:</mo><msup><mi>W</mi><mo>∗</mo></msup><mo>→</mo><msup><mi>V</mi><mo>∗</mo></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><msup><mo stretchy="false">)</mo><mo lspace="0em" rspace="0em">⊺</mo></msup><mo stretchy="false">(</mo><mi mathvariant="bold-italic">g</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="bold-italic">g</mi><mo>∘</mo><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
Df(\bm{x})^{\intercal}:W^*\to V^*\\
Df(\bm{x})^{\intercal}(\bm{g})=\bm{g}\circ Df(\bm{x})
\end{align*}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>Where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">g</mi><mo>∈</mo><msup><mi>W</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}\in W^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>. We&#39;re now dealing with the dual space. Elements are often referred to as covectors. They are a linear map from their &quot;normal&quot; space to the underlying field. Thus, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">g</mi><mo>:</mo><mi>W</mi><mo>→</mo><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">\bm{g}:W\to \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">R</span></span></span></span>. This means the types the expression make sense: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">g</mi><mo>∘</mo><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>:</mo><mi>V</mi><mo>→</mo><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">\bm{g}\circ Df(\bm{x}):V\to \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">R</span></span></span></span>, or <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">g</mi><mo>∘</mo><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>:</mo><msup><mi>V</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}\circ Df(\bm{x}):V^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> . Often people think of the dual space as linear functions that are &quot;taking the inner product with a vector&quot;. So </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="bold-italic">g</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">⟨</mo><mi mathvariant="bold-italic">g</mi><mo separator="true">,</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">⟩</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
\bm{g}(\bm{x}) = \langle \bm{g},\bm{x} \rangle.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⟨</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">⟩</span><span class="mord">.</span></span></span></span></span>
<p>This is especially useful because we can then represent <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">g</mi></mrow><annotation encoding="application/x-tex">\bm{g}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span></span></span></span> as a row vector, which, when combined with a column vector from the nondual space, gives the inner product. This is the reason I&#39;ve been so careful with keeping the <code>gt</code> of shape <code>&#40;1,n&#41;</code> because these <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">g</mi></mrow><annotation encoding="application/x-tex">\bm{g}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span></span></span></span>s are members of the dual space and are actually row vectors. From now on, I&#39;ll use <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span></span></span></span> as a reminder that it&#39;s a row vector. </p>
<p>Just to check that using the covectors as row vectors will work, let&#39;s examine our vector-Jacobian product </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="bold-italic">g</mi><mo>∘</mo><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">v</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi mathvariant="bold-italic">v</mi><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mi mathvariant="bold-italic">v</mi></mrow><annotation encoding="application/x-tex">
(\bm{g}\circ Df(\bm{x}))(\bm{v})=(\bm{g}^{\intercal} Df(\bm{x}))\bm{v}=\bm{g}^{\intercal} Df(\bm{x})\bm{v}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span></span></span></span></span>
<p>Thus, with our newfound correspondence, let&#39;s evaluate the vector-Jacobian product &#40;and employ chain rule&#41;. Let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>=</mo><mi>C</mi><mo>∘</mo><mi>B</mi><mo>∘</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">f = C \circ B \circ A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>, then </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><msup><mo stretchy="false">)</mo><mo lspace="0em" rspace="0em">⊺</mo></msup><mo stretchy="false">(</mo><mi mathvariant="bold-italic">g</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mtext> </mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>D</mi><mi>C</mi><mo>∘</mo><mi>B</mi><mo>∘</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mtext> </mtext><mtext> </mtext><mo stretchy="false">(</mo><mi>D</mi><mi>B</mi><mo>∘</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mtext> </mtext><mi>D</mi><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mtext> </mtext><mi>D</mi><mi>C</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>B</mi><mo>∘</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext> </mtext><mi>D</mi><mi>B</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext> </mtext><mi>D</mi><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
Df(\bm{x})^{\intercal}(\bm{g})&amp;=\bm{g}^{\intercal} Df(\bm{x})\\
&amp;=\bm{g}^{\intercal} \,((DC \circ B \circ A)(\bm{x})\,\,(DB \circ A)(\bm{x})\,  DA(\bm{x}))\\
&amp;=\bm{g}^{\intercal}\, DC((B \circ A)(\bm{x}))\,DB (A(\bm{x})) \, DA(\bm{x})\\
\end{align*}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="mclose">)</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>Recall our definition from earlier: </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext mathvariant="monospace">Jt_f</mtext><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mo stretchy="false">)</mo><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
\texttt{Jt\_f}(\bm{x}, \bm{g}^{\intercal}) = \bm{g}^{\intercal}Df(\bm{x}).
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord texttt">Jt_f</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
<p>Then </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mi>D</mi><mi>C</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>B</mi><mo>∘</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext> </mtext><mtext> </mtext><mi>D</mi><mi>B</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext> </mtext><mi>D</mi><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext mathvariant="monospace">Jt_C</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>B</mi><mo>∘</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mo stretchy="false">)</mo><mtext> </mtext><mi>D</mi><mi>B</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext> </mtext><mi>D</mi><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
&amp;=\bm{g}^{\intercal} DC((B \circ A)(\bm{x}))\,\,DB (A(\bm{x}))\,  DA(\bm{x})\\
&amp;=\texttt{Jt\_C}((B\circ A)(\bm{x}), \bm{g}^{\intercal})\,DB (A(\bm{x}))\,  DA(\bm{x})\\
\end{align*}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord texttt">Jt_C</span></span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>What we should notice here is that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">Jt_C</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>B</mi><mo>∘</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mo stretchy="false">)</mo><mo>=</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mi>D</mi><mi>C</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>B</mi><mo>∘</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\texttt{Jt\_C}((B\circ A)(\bm{x}), \bm{g}^{\intercal}) = \bm{g}^{\intercal}DC((B\circ A)(\bm{x}))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord texttt">Jt_C</span></span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span></span></span></span> is an element of the dual space of the output of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>. Thus, we can apply this strategy again, where we incorporate an element into a call to a <code>Jt</code> function: </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext mathvariant="monospace">Jt_C</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>B</mi><mo>∘</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mo stretchy="false">)</mo><mtext> </mtext><mi>D</mi><mi>B</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext> </mtext><mi>D</mi><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext mathvariant="monospace">Jt_B</mtext><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext> </mtext><mtext> </mtext><mtext mathvariant="monospace">Jt_C</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>B</mi><mo>∘</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext> </mtext><mtext> </mtext><mi>D</mi><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext mathvariant="monospace">Jt_A</mtext><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo separator="true">,</mo><mtext> </mtext><mtext> </mtext><mtext mathvariant="monospace">Jt_B</mtext><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext mathvariant="monospace">Jt_C</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>B</mi><mo>∘</mo><mi>A</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
&amp;=\texttt{Jt\_C}((B\circ A)(\bm{x}), \bm{g}^{\intercal})\,DB (A(\bm{x}))\,  DA(\bm{x})\\
&amp;= \texttt{Jt\_B}(A(\bm{x}),\,\, \texttt{Jt\_C}((B\circ A)(\bm{x}), \bm{g}^{\intercal})) \,\,  DA(\bm{x})\\
&amp;= \texttt{Jt\_A}(\bm{x},\,\, \texttt{Jt\_B}(A(\bm{x}), \texttt{Jt\_C}((B\circ A)(\bm{x}), \bm{g}^{\intercal})))\\
\end{align*}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.5em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-3em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-1.5em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord texttt">Jt_C</span></span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord texttt">Jt_B</span></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord texttt">Jt_C</span></span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord texttt">Jt_A</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord texttt">Jt_B</span></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord texttt">Jt_C</span></span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mclose">)))</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>This is very busy notation, so to look at it better, let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">a</mi><mo>=</mo><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="bold-italic">b</mi><mo>=</mo><mi>B</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\bm{a}=A(\bm{x}), \bm{b}=B(A(\bm{x}))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">a</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">))</span></span></span></span> then the final expression becomes </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext mathvariant="monospace">Jt_A</mtext><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo separator="true">,</mo><mtext> </mtext><mtext mathvariant="monospace">Jt_B</mtext><mo stretchy="false">(</mo><mi mathvariant="bold-italic">a</mi><mo separator="true">,</mo><mtext> </mtext><mtext mathvariant="monospace">Jt_C</mtext><mo stretchy="false">(</mo><mi mathvariant="bold-italic">b</mi><mo separator="true">,</mo><mtext> </mtext><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
\texttt{Jt\_A}(\bm{x},\, \texttt{Jt\_B}(\bm{a},\, \texttt{Jt\_C}(\bm{b},\, \bm{g}^{\intercal}))).
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord texttt">Jt_A</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord texttt">Jt_B</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">a</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord texttt">Jt_C</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">b</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mclose">)))</span><span class="mord">.</span></span></span></span></span>
<p>This should hopefully justify the program I provided at the beginning of the post. Just by knowing the <code>Jt</code> functions of the primitives, we end up with the ability to convert <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span></span></span></span> into a covector of the input space of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>. Now let&#39;s reflect on what this means. If we choose <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\bm{g}^{\intercal}=\begin{bmatrix} 1 &amp; 0&amp; \dots&amp;0 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">…</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span>. Then we get back a row of the derivative: </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi mathvariant="bold-italic">g</mi><mo lspace="0em" rspace="0em">⊺</mo></msup><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mtext> </mtext><mi>D</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="normal">∂</mi><mn>1</mn></msub><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="normal">∂</mi><mn>2</mn></msub><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="normal">∂</mi><mi>n</mi></msub><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">
\bm{g}^{\intercal}Df(\bm{x})=\begin{bmatrix} 1 &amp; 0&amp; \dots&amp;0 \end{bmatrix}\, Df(\bm{x})=\begin{bmatrix} \partial_{1}f(\bm{x}) &amp; \partial_{2}f(\bm{x})&amp; \dots&amp;\partial_{n}f(\bm{x}) \end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">g</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord amsrm mtight">⊺</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">…</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner">…</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span>
<p>&#40;borrowing notation from <a href="https://mitpress.mit.edu/9780262019347/functional-differential-geometry/">Sussman</a>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">∂</mi><mn>1</mn></msub><mi>f</mi></mrow><annotation encoding="application/x-tex">\partial_{1}f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> is the partial derivative with respect to the first argument&#41;.</p>
<p>This is great because almost all loss functions in ML are scalar, so the Jacobian just has one row, and thus, we can efficiently compute the gradient for our descent.</p>
<p>You may be thinking, hold on a minute, the gradient is actually a linear form &#40;in the case of a scalar loss function&#41;: we can&#39;t add that to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">x</mi></mrow><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span>, and you&#39;re right. We should think of the gradient as something that can turn small changes of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">x</mi></mrow><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span> into small changes in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(\bm{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span>. When we&#39;re doing gradient descent, we want a small change in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">x</mi></mrow><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span> that will maximally decrease <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(\bm{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span><span class="mclose">)</span></span></span></span> for a given step size. The small change in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">x</mi></mrow><annotation encoding="application/x-tex">\bm{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">x</span></span></span></span></span></span> that will cause the most increase is in fact the transpose of the gradient &#40;this makes sense since the dot product is maximal when the vectors are parallel&#41;. So, it is okay to use the gradient for gradient descent after all.</p>
<p>It is important to note that the components of the Jacobian really depend on the basis of the vector spaces of the domain and codomain.</p>
<h1 id="wrapping_up"><a href="#wrapping_up" class="header-anchor">Wrapping up</a></h1>
    <script src="https://utteranc.es/client.js"
        repo="jasoneveleth/blog"
        issue-term="pathname"
        label="Comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
    </script>

<div class="page-foot">
    © Jason Eveleth 2023 · Powered by Franklin.jl · Last modified: January 08, 2024
</div>
</div><!-- CONTENT ENDS HERE -->
  </main> <!-- end of id=main -->

  <!-- if we're in an iframe -->
  <script>
    if (window.self != window.top) {
      console.log("we're in an iframe!!!");
      document.querySelectorAll(".blog-nav").forEach(i => i.style.display = "none");
    }
  </script>

  <!-- <script src="/blog/libs/vela/metisMenu.min.js"></script> -->
  <!-- <script src="/blog/libs/vela/slideout.min.js"></script> -->
  
    



  
  
    <script src="/blog/libs/highlight/highlight.min.js"></script>
<script>hljs.highlightAll();hljs.configure({tabReplace: '    '});</script>

  
  
</body>
</html>
